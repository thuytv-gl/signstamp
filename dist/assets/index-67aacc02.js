var Bo=Object.defineProperty;var jo=(m,u,v)=>u in m?Bo(m,u,{enumerable:!0,configurable:!0,writable:!0,value:v}):m[u]=v;var mt=(m,u,v)=>(jo(m,typeof u!="symbol"?u+"":u,v),v);(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const I of document.querySelectorAll('link[rel="modulepreload"]'))k(I);new MutationObserver(I=>{for(const t of I)if(t.type==="childList")for(const W of t.addedNodes)W.tagName==="LINK"&&W.rel==="modulepreload"&&k(W)}).observe(document,{childList:!0,subtree:!0});function v(I){const t={};return I.integrity&&(t.integrity=I.integrity),I.referrerPolicy&&(t.referrerPolicy=I.referrerPolicy),I.crossOrigin==="use-credentials"?t.credentials="include":I.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function k(I){if(I.ep)return;I.ep=!0;const t=v(I);fetch(I.href,t)}})();const Wo=(m,u)=>m===u,xn={equals:Wo};let zo=mr;const Be=1,Tn=2,cr={owned:null,cleanups:null,context:null,owner:null};var Zt=null;let ii=null,qt=null,Jt=null,Fe=null,Fn=0;function Ho(m,u){const v=qt,k=Zt,I=m.length===0,t=u===void 0?k:u,W=I?cr:{owned:null,cleanups:null,context:t?t.context:null,owner:t},g=I?m:()=>m(()=>Ge(()=>Ln(W)));Zt=W,qt=null;try{return an(g,!0)}finally{qt=v,Zt=k}}function ar(m,u){u=u?Object.assign({},xn,u):xn;const v={value:m,observers:null,observerSlots:null,comparator:u.equals||void 0},k=I=>(typeof I=="function"&&(I=I(v.value)),fr(v,I));return[hr.bind(v),k]}function In(m,u,v){const k=gr(m,u,!1,Be);Rn(k)}function Pn(m,u,v){v=v?Object.assign({},xn,v):xn;const k=gr(m,u,!0,0);return k.observers=null,k.observerSlots=null,k.comparator=v.equals||void 0,Rn(k),hr.bind(k)}function Ge(m){if(qt===null)return m();const u=qt;qt=null;try{return m()}finally{qt=u}}function hr(){if(this.sources&&this.state)if(this.state===Be)Rn(this);else{const m=Jt;Jt=null,an(()=>En(this),!1),Jt=m}if(qt){const m=this.observers?this.observers.length:0;qt.sources?(qt.sources.push(this),qt.sourceSlots.push(m)):(qt.sources=[this],qt.sourceSlots=[m]),this.observers?(this.observers.push(qt),this.observerSlots.push(qt.sources.length-1)):(this.observers=[qt],this.observerSlots=[qt.sources.length-1])}return this.value}function fr(m,u,v){let k=m.value;return(!m.comparator||!m.comparator(k,u))&&(m.value=u,m.observers&&m.observers.length&&an(()=>{for(let I=0;I<m.observers.length;I+=1){const t=m.observers[I],W=ii&&ii.running;W&&ii.disposed.has(t),(W?!t.tState:!t.state)&&(t.pure?Jt.push(t):Fe.push(t),t.observers&&dr(t)),W||(t.state=Be)}if(Jt.length>1e6)throw Jt=[],new Error},!1)),u}function Rn(m){if(!m.fn)return;Ln(m);const u=Zt,v=qt,k=Fn;qt=Zt=m,No(m,m.value,k),qt=v,Zt=u}function No(m,u,v){let k;try{k=m.fn(u)}catch(I){return m.pure&&(m.state=Be,m.owned&&m.owned.forEach(Ln),m.owned=null),m.updatedAt=v+1,pr(I)}(!m.updatedAt||m.updatedAt<=v)&&(m.updatedAt!=null&&"observers"in m?fr(m,k):m.value=k,m.updatedAt=v)}function gr(m,u,v,k=Be,I){const t={fn:m,state:k,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:u,owner:Zt,context:Zt?Zt.context:null,pure:v};return Zt===null||Zt!==cr&&(Zt.owned?Zt.owned.push(t):Zt.owned=[t]),t}function _r(m){if(m.state===0)return;if(m.state===Tn)return En(m);if(m.suspense&&Ge(m.suspense.inFallback))return m.suspense.effects.push(m);const u=[m];for(;(m=m.owner)&&(!m.updatedAt||m.updatedAt<Fn);)m.state&&u.push(m);for(let v=u.length-1;v>=0;v--)if(m=u[v],m.state===Be)Rn(m);else if(m.state===Tn){const k=Jt;Jt=null,an(()=>En(m,u[0]),!1),Jt=k}}function an(m,u){if(Jt)return m();let v=!1;u||(Jt=[]),Fe?v=!0:Fe=[],Fn++;try{const k=m();return Yo(v),k}catch(k){v||(Fe=null),Jt=null,pr(k)}}function Yo(m){if(Jt&&(mr(Jt),Jt=null),m)return;const u=Fe;Fe=null,u.length&&an(()=>zo(u),!1)}function mr(m){for(let u=0;u<m.length;u++)_r(m[u])}function En(m,u){m.state=0;for(let v=0;v<m.sources.length;v+=1){const k=m.sources[v];if(k.sources){const I=k.state;I===Be?k!==u&&(!k.updatedAt||k.updatedAt<Fn)&&_r(k):I===Tn&&En(k,u)}}}function dr(m){for(let u=0;u<m.observers.length;u+=1){const v=m.observers[u];v.state||(v.state=Tn,v.pure?Jt.push(v):Fe.push(v),v.observers&&dr(v))}}function Ln(m){let u;if(m.sources)for(;m.sources.length;){const v=m.sources.pop(),k=m.sourceSlots.pop(),I=v.observers;if(I&&I.length){const t=I.pop(),W=v.observerSlots.pop();k<I.length&&(t.sourceSlots[W]=k,I[k]=t,v.observerSlots[k]=W)}}if(m.owned){for(u=m.owned.length-1;u>=0;u--)Ln(m.owned[u]);m.owned=null}if(m.cleanups){for(u=m.cleanups.length-1;u>=0;u--)m.cleanups[u]();m.cleanups=null}m.state=0}function Xo(m){return m instanceof Error?m:new Error(typeof m=="string"?m:"Unknown error",{cause:m})}function pr(m,u=Zt){throw Xo(m)}function ai(m,u){return Ge(()=>m(u||{}))}const Uo=m=>`Stale read from <${m}>.`;function sr(m){const u=m.keyed,v=Pn(()=>m.when,void 0,{equals:(k,I)=>u?k===I:!k==!I});return Pn(()=>{const k=v();if(k){const I=m.children;return typeof I=="function"&&I.length>0?Ge(()=>I(u?k:()=>{if(!Ge(v))throw Uo("Show");return m.when})):I}return m.fallback},void 0,void 0)}function Vo(m,u,v){let k=v.length,I=u.length,t=k,W=0,g=0,s=u[I-1].nextSibling,h=null;for(;W<I||g<t;){if(u[W]===v[g]){W++,g++;continue}for(;u[I-1]===v[t-1];)I--,t--;if(I===W){const c=t<k?g?v[g-1].nextSibling:v[t-g]:s;for(;g<t;)m.insertBefore(v[g++],c)}else if(t===g)for(;W<I;)(!h||!h.has(u[W]))&&u[W].remove(),W++;else if(u[W]===v[t-1]&&v[g]===u[I-1]){const c=u[--I].nextSibling;m.insertBefore(v[g++],u[W++].nextSibling),m.insertBefore(v[--t],c),u[I]=v[t]}else{if(!h){h=new Map;let n=g;for(;n<t;)h.set(v[n],n++)}const c=h.get(u[W]);if(c!=null)if(g<c&&c<t){let n=W,a=1,e;for(;++n<I&&n<t&&!((e=h.get(u[n]))==null||e!==c+a);)a++;if(a>c-g){const o=u[W];for(;g<c;)m.insertBefore(v[g++],o)}else m.replaceChild(v[g++],u[W++])}else W++;else u[W++].remove()}}}const or="_$DX_DELEGATE";function $o(m,u,v,k={}){let I;return Ho(t=>{I=t,u===document?m():vr(u,m(),u.firstChild?null:void 0,v)},k.owner),()=>{I(),u.textContent=""}}function ui(m,u,v){let k;const I=()=>{const W=document.createElement("template");return W.innerHTML=m,v?W.content.firstChild.firstChild:W.content.firstChild},t=u?()=>Ge(()=>document.importNode(k||(k=I()),!0)):()=>(k||(k=I())).cloneNode(!0);return t.cloneNode=t,t}function qo(m,u=window.document){const v=u[or]||(u[or]=new Set);for(let k=0,I=m.length;k<I;k++){const t=m[k];v.has(t)||(v.add(t),u.addEventListener(t,Qo))}}function Ko(m,u,v){return Ge(()=>m(u,v))}function vr(m,u,v,k){if(v!==void 0&&!k&&(k=[]),typeof u!="function")return Dn(m,u,k,v);In(I=>Dn(m,u(),I,v),k)}function Qo(m){const u=`$$${m.type}`;let v=m.composedPath&&m.composedPath()[0]||m.target;for(m.target!==v&&Object.defineProperty(m,"target",{configurable:!0,value:v}),Object.defineProperty(m,"currentTarget",{configurable:!0,get(){return v||document}});v;){const k=v[u];if(k&&!v.disabled){const I=v[`${u}Data`];if(I!==void 0?k.call(v,I,m):k.call(v,m),m.cancelBubble)return}v=v._$host||v.parentNode||v.host}}function Dn(m,u,v,k,I){for(;typeof v=="function";)v=v();if(u===v)return v;const t=typeof u,W=k!==void 0;if(m=W&&v[0]&&v[0].parentNode||m,t==="string"||t==="number")if(t==="number"&&(u=u.toString()),W){let g=v[0];g&&g.nodeType===3?g.data=u:g=document.createTextNode(u),v=Ne(m,v,k,g)}else v!==""&&typeof v=="string"?v=m.firstChild.data=u:v=m.textContent=u;else if(u==null||t==="boolean")v=Ne(m,v,k);else{if(t==="function")return In(()=>{let g=u();for(;typeof g=="function";)g=g();v=Dn(m,g,v,k)}),()=>v;if(Array.isArray(u)){const g=[],s=v&&Array.isArray(v);if(si(g,u,v,I))return In(()=>v=Dn(m,g,v,k,!0)),()=>v;if(g.length===0){if(v=Ne(m,v,k),W)return v}else s?v.length===0?lr(m,g,k):Vo(m,v,g):(v&&Ne(m),lr(m,g));v=g}else if(u.nodeType){if(Array.isArray(v)){if(W)return v=Ne(m,v,k,u);Ne(m,v,null,u)}else v==null||v===""||!m.firstChild?m.appendChild(u):m.replaceChild(u,m.firstChild);v=u}else console.warn("Unrecognized value. Skipped inserting",u)}return v}function si(m,u,v,k){let I=!1;for(let t=0,W=u.length;t<W;t++){let g=u[t],s=v&&v[t],h;if(!(g==null||g===!0||g===!1))if((h=typeof g)=="object"&&g.nodeType)m.push(g);else if(Array.isArray(g))I=si(m,g,s)||I;else if(h==="function")if(k){for(;typeof g=="function";)g=g();I=si(m,Array.isArray(g)?g:[g],Array.isArray(s)?s:[s])||I}else m.push(g),I=!0;else{const c=String(g);s&&s.nodeType===3&&s.data===c?m.push(s):m.push(document.createTextNode(c))}}return I}function lr(m,u,v=null){for(let k=0,I=u.length;k<I;k++)m.insertBefore(u[k],v)}function Ne(m,u,v,k){if(v===void 0)return m.textContent="";const I=k||document.createTextNode("");if(u.length){let t=!1;for(let W=u.length-1;W>=0;W--){const g=u[W];if(I!==g){const s=g.parentNode===m;!t&&!W?s?m.replaceChild(I,g):m.insertBefore(I,v):s&&g.remove()}else t=!0}}else m.insertBefore(I,v);return[I]}var yr=(m=>(m[m.Undefined=0]="Undefined",m[m.Activate=1]="Activate",m[m.Associate=2]="Associate",m[m.Background=3]="Background",m[m.Copy=4]="Copy",m[m.Deactivate=5]="Deactivate",m[m.Discrete=6]="Discrete",m[m.Disassociate=7]="Disassociate",m[m.Extract=8]="Extract",m[m.Off=9]="Off",m[m.On=10]="On",m[m.Opaque=11]="Opaque",m[m.Remove=12]="Remove",m[m.Set=13]="Set",m[m.Shape=14]="Shape",m[m.Transparent=15]="Transparent",m))(yr||{});function Jo(m){return m&&m.__esModule&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m}var Sr={exports:{}};(function(m,u){var v=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(k=k||__filename),function(I={}){var t=typeof I<"u"?I:{},W,g;t.ready=new Promise(function(i,l){W=i,g=l});var s=Object.assign({},t),h="./this.program",c=(i,l)=>{throw l},n=typeof window=="object",a=typeof importScripts=="function",e=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",o="";function f(i){return t.locateFile?t.locateFile(i,o):o+i}var r,_,p;if(e){var S=require("fs"),C=require("path");a?o=C.dirname(o)+"/":o=__dirname+"/",r=(i,l)=>(i=bt(i)?new URL(i):C.normalize(i),S.readFileSync(i,l?void 0:"utf8")),p=i=>{var l=r(i,!0);return l.buffer||(l=new Uint8Array(l)),l},_=(i,l,d)=>{i=bt(i)?new URL(i):C.normalize(i),S.readFile(i,function(y,w){y?d(y):l(w.buffer)})},!t.thisProgram&&process.argv.length>1&&(h=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),c=(i,l)=>{throw process.exitCode=i,l},t.inspect=function(){return"[Emscripten Module object]"}}else(n||a)&&(a?o=self.location.href:typeof document<"u"&&document.currentScript&&(o=document.currentScript.src),k&&(o=k),o.indexOf("blob:")!==0?o=o.substr(0,o.replace(/[?#].*/,"").lastIndexOf("/")+1):o="",r=i=>{var l=new XMLHttpRequest;return l.open("GET",i,!1),l.send(null),l.responseText},a&&(p=i=>{var l=new XMLHttpRequest;return l.open("GET",i,!1),l.responseType="arraybuffer",l.send(null),new Uint8Array(l.response)}),_=(i,l,d)=>{var y=new XMLHttpRequest;y.open("GET",i,!0),y.responseType="arraybuffer",y.onload=()=>{if(y.status==200||y.status==0&&y.response){l(y.response);return}d()},y.onerror=d,y.send(null)});var x=t.print||console.log.bind(console),P=t.printErr||console.warn.bind(console);Object.assign(t,s),s=null,t.arguments&&t.arguments,t.thisProgram&&(h=t.thisProgram),t.quit&&(c=t.quit);var F;t.wasmBinary&&(F=t.wasmBinary);var z=t.noExitRuntime||!0;typeof WebAssembly!="object"&&it("no native wasm support detected");var K,at=!1,_t;function dt(i,l){i||it(l)}var ct,ut,ht,kt,Y,rt,D,G;function j(){var i=K.buffer;t.HEAP8=ct=new Int8Array(i),t.HEAP16=ht=new Int16Array(i),t.HEAP32=Y=new Int32Array(i),t.HEAPU8=ut=new Uint8Array(i),t.HEAPU16=kt=new Uint16Array(i),t.HEAPU32=rt=new Uint32Array(i),t.HEAPF32=D=new Float32Array(i),t.HEAPF64=G=new Float64Array(i)}var B,V=[],R=[],O=[],N=0;function U(){return z||N>0}function Z(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)gt(t.preRun.shift());me(V)}function $(){!t.noFSInit&&!b.init.initialized&&b.init(),b.ignorePermissions=!1,Vt.root=b.mount(Vt,{},null),me(R)}function st(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Q(t.postRun.shift());me(O)}function gt(i){V.unshift(i)}function vt(i){R.unshift(i)}function Q(i){O.unshift(i)}var X=0,tt=null;function nt(i){X++,t.monitorRunDependencies&&t.monitorRunDependencies(X)}function q(i){if(X--,t.monitorRunDependencies&&t.monitorRunDependencies(X),X==0&&tt){var l=tt;tt=null,l()}}function it(i){t.onAbort&&t.onAbort(i),i="Aborted("+i+")",P(i),at=!0,_t=1,i+=". Build with -sASSERTIONS for more info.";var l=new WebAssembly.RuntimeError(i);throw g(l),l}var St="data:application/octet-stream;base64,";function It(i){return i.startsWith(St)}function bt(i){return i.startsWith("file://")}var J;J="magick.wasm",It(J)||(J=f(J));function Mt(i){try{if(i==J&&F)return new Uint8Array(F);if(p)return p(i);throw"both async and sync fetching of the wasm failed"}catch(l){it(l)}}function Pt(i){if(!F&&(n||a)){if(typeof fetch=="function"&&!bt(i))return fetch(i,{credentials:"same-origin"}).then(function(l){if(!l.ok)throw"failed to load wasm binary file at '"+i+"'";return l.arrayBuffer()}).catch(function(){return Mt(i)});if(_)return new Promise(function(l,d){_(i,function(y){l(new Uint8Array(y))},d)})}return Promise.resolve().then(function(){return Mt(i)})}function Ot(i,l,d){return Pt(i).then(function(y){return WebAssembly.instantiate(y,l)}).then(function(y){return y}).then(d,function(y){P("failed to asynchronously prepare wasm: "+y),it(y)})}function Ut(i,l,d,y){return!i&&typeof WebAssembly.instantiateStreaming=="function"&&!It(l)&&!bt(l)&&!e&&typeof fetch=="function"?fetch(l,{credentials:"same-origin"}).then(function(w){var M=WebAssembly.instantiateStreaming(w,d);return M.then(y,function(T){return P("wasm streaming compile failed: "+T),P("falling back to ArrayBuffer instantiation"),Ot(l,d,y)})}):Ot(l,d,y)}function Lt(){var i={a:oo};function l(y,w){var M=y.exports;return t.asm=M,K=t.asm.gb,j(),B=t.asm.Ab,vt(t.asm.hb),q(),M}nt();function d(y){l(y.instance)}if(t.instantiateWasm)try{return t.instantiateWasm(i,l)}catch(y){P("Module.instantiateWasm callback failed with error: "+y),g(y)}return Ut(F,J,i,d).catch(g),{}}var yt,xt;function le(i){this.name="ExitStatus",this.message="Program terminated with exit("+i+")",this.status=i}function me(i){for(;i.length>0;)i.shift()(t)}function ne(i,l="i8"){switch(l.endsWith("*")&&(l="*"),l){case"i1":return ct[i>>0];case"i8":return ct[i>>0];case"i16":return ht[i>>1];case"i32":return Y[i>>2];case"i64":return Y[i>>2];case"float":return D[i>>2];case"double":return G[i>>3];case"*":return rt[i>>2];default:it("invalid type for getValue: "+l)}}function Bn(i,l,d="i8"){switch(d.endsWith("*")&&(d="*"),d){case"i1":ct[i>>0]=l;break;case"i8":ct[i>>0]=l;break;case"i16":ht[i>>1]=l;break;case"i32":Y[i>>2]=l;break;case"i64":xt=[l>>>0,(yt=l,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[i>>2]=xt[0],Y[i+4>>2]=xt[1];break;case"float":D[i>>2]=l;break;case"double":G[i>>3]=l;break;case"*":rt[i>>2]=l;break;default:it("invalid type for setValue: "+d)}}var Te=[];function Ht(i){var l=Te[i];return l||(i>=Te.length&&(Te.length=i+1),Te[i]=l=B.get(i)),l}function jn(i,l){Ht(i)(l)}var je=0;function gi(i){this.excPtr=i,this.ptr=i-24,this.set_type=function(l){rt[this.ptr+4>>2]=l},this.get_type=function(){return rt[this.ptr+4>>2]},this.set_destructor=function(l){rt[this.ptr+8>>2]=l},this.get_destructor=function(){return rt[this.ptr+8>>2]},this.set_caught=function(l){l=l?1:0,ct[this.ptr+12>>0]=l},this.get_caught=function(){return ct[this.ptr+12>>0]!=0},this.set_rethrown=function(l){l=l?1:0,ct[this.ptr+13>>0]=l},this.get_rethrown=function(){return ct[this.ptr+13>>0]!=0},this.init=function(l,d){this.set_adjusted_ptr(0),this.set_type(l),this.set_destructor(d)},this.set_adjusted_ptr=function(l){rt[this.ptr+16>>2]=l},this.get_adjusted_ptr=function(){return rt[this.ptr+16>>2]},this.get_exception_ptr=function(){var l=Qi(this.get_type());if(l)return rt[this.excPtr>>2];var d=this.get_adjusted_ptr();return d!==0?d:this.excPtr}}function Mr(i){throw je||(je=i),je}function xr(){var i=je;if(!i)return nn(0),0;var l=new gi(i);l.set_adjusted_ptr(i);var d=l.get_type();if(!d)return nn(0),i;for(var y=0;y<arguments.length;y++){var w=arguments[y];if(w===0||w===d)break;var M=l.ptr+16;if(Ki(w,d,M))return nn(w),i}return nn(d),i}var Tr=xr;function Ir(i,l,d){var y=new gi(i);throw y.init(l,d),je=i,je}var Gt={isAbs:i=>i.charAt(0)==="/",splitPath:i=>{var l=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return l.exec(i).slice(1)},normalizeArray:(i,l)=>{for(var d=0,y=i.length-1;y>=0;y--){var w=i[y];w==="."?i.splice(y,1):w===".."?(i.splice(y,1),d++):d&&(i.splice(y,1),d--)}if(l)for(;d;d--)i.unshift("..");return i},normalize:i=>{var l=Gt.isAbs(i),d=i.substr(-1)==="/";return i=Gt.normalizeArray(i.split("/").filter(y=>!!y),!l).join("/"),!i&&!l&&(i="."),i&&d&&(i+="/"),(l?"/":"")+i},dirname:i=>{var l=Gt.splitPath(i),d=l[0],y=l[1];return!d&&!y?".":(y&&(y=y.substr(0,y.length-1)),d+y)},basename:i=>{if(i==="/")return"/";i=Gt.normalize(i),i=i.replace(/\/$/,"");var l=i.lastIndexOf("/");return l===-1?i:i.substr(l+1)},join:function(){var i=Array.prototype.slice.call(arguments);return Gt.normalize(i.join("/"))},join2:(i,l)=>Gt.normalize(i+"/"+l)};function Pr(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return y=>crypto.getRandomValues(y);if(e)try{var i=require("crypto"),l=i.randomFillSync;if(l)return y=>i.randomFillSync(y);var d=i.randomBytes;return y=>(y.set(d(y.byteLength)),y)}catch{}it("initRandomDevice")}function Wn(i){return(Wn=Pr())(i)}var de={resolve:function(){for(var i="",l=!1,d=arguments.length-1;d>=-1&&!l;d--){var y=d>=0?arguments[d]:b.cwd();if(typeof y!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!y)return"";i=y+"/"+i,l=Gt.isAbs(y)}return i=Gt.normalizeArray(i.split("/").filter(w=>!!w),!l).join("/"),(l?"/":"")+i||"."},relative:(i,l)=>{i=de.resolve(i).substr(1),l=de.resolve(l).substr(1);function d(H){for(var et=0;et<H.length&&H[et]==="";et++);for(var pt=H.length-1;pt>=0&&H[pt]==="";pt--);return et>pt?[]:H.slice(et,pt-et+1)}for(var y=d(i.split("/")),w=d(l.split("/")),M=Math.min(y.length,w.length),T=M,E=0;E<M;E++)if(y[E]!==w[E]){T=E;break}for(var L=[],E=T;E<y.length;E++)L.push("..");return L=L.concat(w.slice(T)),L.join("/")}};function Ie(i){for(var l=0,d=0;d<i.length;++d){var y=i.charCodeAt(d);y<=127?l++:y<=2047?l+=2:y>=55296&&y<=57343?(l+=4,++d):l+=3}return l}function zn(i,l,d,y){if(!(y>0))return 0;for(var w=d,M=d+y-1,T=0;T<i.length;++T){var E=i.charCodeAt(T);if(E>=55296&&E<=57343){var L=i.charCodeAt(++T);E=65536+((E&1023)<<10)|L&1023}if(E<=127){if(d>=M)break;l[d++]=E}else if(E<=2047){if(d+1>=M)break;l[d++]=192|E>>6,l[d++]=128|E&63}else if(E<=65535){if(d+2>=M)break;l[d++]=224|E>>12,l[d++]=128|E>>6&63,l[d++]=128|E&63}else{if(d+3>=M)break;l[d++]=240|E>>18,l[d++]=128|E>>12&63,l[d++]=128|E>>6&63,l[d++]=128|E&63}}return l[d]=0,d-w}function on(i,l,d){var y=d>0?d:Ie(i)+1,w=new Array(y),M=zn(i,w,0,w.length);return l&&(w.length=M),w}var Pe={ttys:[],init:function(){},shutdown:function(){},register:function(i,l){Pe.ttys[i]={input:[],output:[],ops:l},b.registerDevice(i,Pe.stream_ops)},stream_ops:{open:function(i){var l=Pe.ttys[i.node.rdev];if(!l)throw new b.ErrnoError(43);i.tty=l,i.seekable=!1},close:function(i){i.tty.ops.fsync(i.tty)},fsync:function(i){i.tty.ops.fsync(i.tty)},read:function(i,l,d,y,w){if(!i.tty||!i.tty.ops.get_char)throw new b.ErrnoError(60);for(var M=0,T=0;T<y;T++){var E;try{E=i.tty.ops.get_char(i.tty)}catch{throw new b.ErrnoError(29)}if(E===void 0&&M===0)throw new b.ErrnoError(6);if(E==null)break;M++,l[d+T]=E}return M&&(i.node.timestamp=Date.now()),M},write:function(i,l,d,y,w){if(!i.tty||!i.tty.ops.put_char)throw new b.ErrnoError(60);try{for(var M=0;M<y;M++)i.tty.ops.put_char(i.tty,l[d+M])}catch{throw new b.ErrnoError(29)}return y&&(i.node.timestamp=Date.now()),M}},default_tty_ops:{get_char:function(i){if(!i.input.length){var l=null;if(e){var d=256,y=Buffer.alloc(d),w=0;try{w=S.readSync(process.stdin.fd,y,0,d,-1)}catch(M){if(M.toString().includes("EOF"))w=0;else throw M}w>0?l=y.slice(0,w).toString("utf-8"):l=null}else typeof window<"u"&&typeof window.prompt=="function"?(l=window.prompt("Input: "),l!==null&&(l+=`
`)):typeof readline=="function"&&(l=readline(),l!==null&&(l+=`
`));if(!l)return null;i.input=on(l,!0)}return i.input.shift()},put_char:function(i,l){l===null||l===10?(x(We(i.output,0)),i.output=[]):l!=0&&i.output.push(l)},fsync:function(i){i.output&&i.output.length>0&&(x(We(i.output,0)),i.output=[])}},default_tty1_ops:{put_char:function(i,l){l===null||l===10?(P(We(i.output,0)),i.output=[]):l!=0&&i.output.push(l)},fsync:function(i){i.output&&i.output.length>0&&(P(We(i.output,0)),i.output=[])}}};function Hn(i,l){return ut.fill(0,i,i+l),i}function Er(i,l){return Math.ceil(i/l)*l}function _i(i){i=Er(i,65536);var l=$i(65536,i);return l?Hn(l,i):0}var Et={ops_table:null,mount:function(i){return Et.createNode(null,"/",16895,0)},createNode:function(i,l,d,y){if(b.isBlkdev(d)||b.isFIFO(d))throw new b.ErrnoError(63);Et.ops_table||(Et.ops_table={dir:{node:{getattr:Et.node_ops.getattr,setattr:Et.node_ops.setattr,lookup:Et.node_ops.lookup,mknod:Et.node_ops.mknod,rename:Et.node_ops.rename,unlink:Et.node_ops.unlink,rmdir:Et.node_ops.rmdir,readdir:Et.node_ops.readdir,symlink:Et.node_ops.symlink},stream:{llseek:Et.stream_ops.llseek}},file:{node:{getattr:Et.node_ops.getattr,setattr:Et.node_ops.setattr},stream:{llseek:Et.stream_ops.llseek,read:Et.stream_ops.read,write:Et.stream_ops.write,allocate:Et.stream_ops.allocate,mmap:Et.stream_ops.mmap,msync:Et.stream_ops.msync}},link:{node:{getattr:Et.node_ops.getattr,setattr:Et.node_ops.setattr,readlink:Et.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Et.node_ops.getattr,setattr:Et.node_ops.setattr},stream:b.chrdev_stream_ops}});var w=b.createNode(i,l,d,y);return b.isDir(w.mode)?(w.node_ops=Et.ops_table.dir.node,w.stream_ops=Et.ops_table.dir.stream,w.contents={}):b.isFile(w.mode)?(w.node_ops=Et.ops_table.file.node,w.stream_ops=Et.ops_table.file.stream,w.usedBytes=0,w.contents=null):b.isLink(w.mode)?(w.node_ops=Et.ops_table.link.node,w.stream_ops=Et.ops_table.link.stream):b.isChrdev(w.mode)&&(w.node_ops=Et.ops_table.chrdev.node,w.stream_ops=Et.ops_table.chrdev.stream),w.timestamp=Date.now(),i&&(i.contents[l]=w,i.timestamp=w.timestamp),w},getFileDataAsTypedArray:function(i){return i.contents?i.contents.subarray?i.contents.subarray(0,i.usedBytes):new Uint8Array(i.contents):new Uint8Array(0)},expandFileStorage:function(i,l){var d=i.contents?i.contents.length:0;if(!(d>=l)){var y=1048576;l=Math.max(l,d*(d<y?2:1.125)>>>0),d!=0&&(l=Math.max(l,256));var w=i.contents;i.contents=new Uint8Array(l),i.usedBytes>0&&i.contents.set(w.subarray(0,i.usedBytes),0)}},resizeFileStorage:function(i,l){if(i.usedBytes!=l)if(l==0)i.contents=null,i.usedBytes=0;else{var d=i.contents;i.contents=new Uint8Array(l),d&&i.contents.set(d.subarray(0,Math.min(l,i.usedBytes))),i.usedBytes=l}},node_ops:{getattr:function(i){var l={};return l.dev=b.isChrdev(i.mode)?i.id:1,l.ino=i.id,l.mode=i.mode,l.nlink=1,l.uid=0,l.gid=0,l.rdev=i.rdev,b.isDir(i.mode)?l.size=4096:b.isFile(i.mode)?l.size=i.usedBytes:b.isLink(i.mode)?l.size=i.link.length:l.size=0,l.atime=new Date(i.timestamp),l.mtime=new Date(i.timestamp),l.ctime=new Date(i.timestamp),l.blksize=4096,l.blocks=Math.ceil(l.size/l.blksize),l},setattr:function(i,l){l.mode!==void 0&&(i.mode=l.mode),l.timestamp!==void 0&&(i.timestamp=l.timestamp),l.size!==void 0&&Et.resizeFileStorage(i,l.size)},lookup:function(i,l){throw b.genericErrors[44]},mknod:function(i,l,d,y){return Et.createNode(i,l,d,y)},rename:function(i,l,d){if(b.isDir(i.mode)){var y;try{y=b.lookupNode(l,d)}catch{}if(y)for(var w in y.contents)throw new b.ErrnoError(55)}delete i.parent.contents[i.name],i.parent.timestamp=Date.now(),i.name=d,l.contents[d]=i,l.timestamp=i.parent.timestamp,i.parent=l},unlink:function(i,l){delete i.contents[l],i.timestamp=Date.now()},rmdir:function(i,l){var d=b.lookupNode(i,l);for(var y in d.contents)throw new b.ErrnoError(55);delete i.contents[l],i.timestamp=Date.now()},readdir:function(i){var l=[".",".."];for(var d in i.contents)i.contents.hasOwnProperty(d)&&l.push(d);return l},symlink:function(i,l,d){var y=Et.createNode(i,l,41471,0);return y.link=d,y},readlink:function(i){if(!b.isLink(i.mode))throw new b.ErrnoError(28);return i.link}},stream_ops:{read:function(i,l,d,y,w){var M=i.node.contents;if(w>=i.node.usedBytes)return 0;var T=Math.min(i.node.usedBytes-w,y);if(T>8&&M.subarray)l.set(M.subarray(w,w+T),d);else for(var E=0;E<T;E++)l[d+E]=M[w+E];return T},write:function(i,l,d,y,w,M){if(l.buffer===ct.buffer&&(M=!1),!y)return 0;var T=i.node;if(T.timestamp=Date.now(),l.subarray&&(!T.contents||T.contents.subarray)){if(M)return T.contents=l.subarray(d,d+y),T.usedBytes=y,y;if(T.usedBytes===0&&w===0)return T.contents=l.slice(d,d+y),T.usedBytes=y,y;if(w+y<=T.usedBytes)return T.contents.set(l.subarray(d,d+y),w),y}if(Et.expandFileStorage(T,w+y),T.contents.subarray&&l.subarray)T.contents.set(l.subarray(d,d+y),w);else for(var E=0;E<y;E++)T.contents[w+E]=l[d+E];return T.usedBytes=Math.max(T.usedBytes,w+y),y},llseek:function(i,l,d){var y=l;if(d===1?y+=i.position:d===2&&b.isFile(i.node.mode)&&(y+=i.node.usedBytes),y<0)throw new b.ErrnoError(28);return y},allocate:function(i,l,d){Et.expandFileStorage(i.node,l+d),i.node.usedBytes=Math.max(i.node.usedBytes,l+d)},mmap:function(i,l,d,y,w){if(!b.isFile(i.node.mode))throw new b.ErrnoError(43);var M,T,E=i.node.contents;if(!(w&2)&&E.buffer===ct.buffer)T=!1,M=E.byteOffset;else{if((d>0||d+l<E.length)&&(E.subarray?E=E.subarray(d,d+l):E=Array.prototype.slice.call(E,d,d+l)),T=!0,M=_i(l),!M)throw new b.ErrnoError(48);ct.set(E,M)}return{ptr:M,allocated:T}},msync:function(i,l,d,y,w){return Et.stream_ops.write(i,l,0,y,d,!1),0}}};function Dr(i,l,d,y){var w=y?"":"al "+i;_(i,M=>{dt(M,'Loading data file "'+i+'" failed (no arrayBuffer).'),l(new Uint8Array(M)),w&&q()},M=>{if(d)d();else throw'Loading data file "'+i+'" failed.'}),w&&nt()}var b={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(i,l={})=>{if(i=de.resolve(i),!i)return{path:"",node:null};var d={follow_mount:!0,recurse_count:0};if(l=Object.assign(d,l),l.recurse_count>8)throw new b.ErrnoError(32);for(var y=i.split("/").filter(pt=>!!pt),w=b.root,M="/",T=0;T<y.length;T++){var E=T===y.length-1;if(E&&l.parent)break;if(w=b.lookupNode(w,y[T]),M=Gt.join2(M,y[T]),b.isMountpoint(w)&&(!E||E&&l.follow_mount)&&(w=w.mounted.root),!E||l.follow)for(var L=0;b.isLink(w.mode);){var H=b.readlink(M);M=de.resolve(Gt.dirname(M),H);var et=b.lookupPath(M,{recurse_count:l.recurse_count+1});if(w=et.node,L++>40)throw new b.ErrnoError(32)}}return{path:M,node:w}},getPath:i=>{for(var l;;){if(b.isRoot(i)){var d=i.mount.mountpoint;return l?d[d.length-1]!=="/"?d+"/"+l:d+l:d}l=l?i.name+"/"+l:i.name,i=i.parent}},hashName:(i,l)=>{for(var d=0,y=0;y<l.length;y++)d=(d<<5)-d+l.charCodeAt(y)|0;return(i+d>>>0)%b.nameTable.length},hashAddNode:i=>{var l=b.hashName(i.parent.id,i.name);i.name_next=b.nameTable[l],b.nameTable[l]=i},hashRemoveNode:i=>{var l=b.hashName(i.parent.id,i.name);if(b.nameTable[l]===i)b.nameTable[l]=i.name_next;else for(var d=b.nameTable[l];d;){if(d.name_next===i){d.name_next=i.name_next;break}d=d.name_next}},lookupNode:(i,l)=>{var d=b.mayLookup(i);if(d)throw new b.ErrnoError(d,i);for(var y=b.hashName(i.id,l),w=b.nameTable[y];w;w=w.name_next){var M=w.name;if(w.parent.id===i.id&&M===l)return w}return b.lookup(i,l)},createNode:(i,l,d,y)=>{var w=new b.FSNode(i,l,d,y);return b.hashAddNode(w),w},destroyNode:i=>{b.hashRemoveNode(i)},isRoot:i=>i===i.parent,isMountpoint:i=>!!i.mounted,isFile:i=>(i&61440)===32768,isDir:i=>(i&61440)===16384,isLink:i=>(i&61440)===40960,isChrdev:i=>(i&61440)===8192,isBlkdev:i=>(i&61440)===24576,isFIFO:i=>(i&61440)===4096,isSocket:i=>(i&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:i=>{var l=b.flagModes[i];if(typeof l>"u")throw new Error("Unknown file open mode: "+i);return l},flagsToPermissionString:i=>{var l=["r","w","rw"][i&3];return i&512&&(l+="w"),l},nodePermissions:(i,l)=>b.ignorePermissions?0:l.includes("r")&&!(i.mode&292)||l.includes("w")&&!(i.mode&146)||l.includes("x")&&!(i.mode&73)?2:0,mayLookup:i=>{var l=b.nodePermissions(i,"x");return l||(i.node_ops.lookup?0:2)},mayCreate:(i,l)=>{try{var d=b.lookupNode(i,l);return 20}catch{}return b.nodePermissions(i,"wx")},mayDelete:(i,l,d)=>{var y;try{y=b.lookupNode(i,l)}catch(M){return M.errno}var w=b.nodePermissions(i,"wx");if(w)return w;if(d){if(!b.isDir(y.mode))return 54;if(b.isRoot(y)||b.getPath(y)===b.cwd())return 10}else if(b.isDir(y.mode))return 31;return 0},mayOpen:(i,l)=>i?b.isLink(i.mode)?32:b.isDir(i.mode)&&(b.flagsToPermissionString(l)!=="r"||l&512)?31:b.nodePermissions(i,b.flagsToPermissionString(l)):44,MAX_OPEN_FDS:4096,nextfd:(i=0,l=b.MAX_OPEN_FDS)=>{for(var d=i;d<=l;d++)if(!b.streams[d])return d;throw new b.ErrnoError(33)},getStream:i=>b.streams[i],createStream:(i,l,d)=>{b.FSStream||(b.FSStream=function(){this.shared={}},b.FSStream.prototype={},Object.defineProperties(b.FSStream.prototype,{object:{get:function(){return this.node},set:function(w){this.node=w}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(w){this.shared.flags=w}},position:{get:function(){return this.shared.position},set:function(w){this.shared.position=w}}})),i=Object.assign(new b.FSStream,i);var y=b.nextfd(l,d);return i.fd=y,b.streams[y]=i,i},closeStream:i=>{b.streams[i]=null},chrdev_stream_ops:{open:i=>{var l=b.getDevice(i.node.rdev);i.stream_ops=l.stream_ops,i.stream_ops.open&&i.stream_ops.open(i)},llseek:()=>{throw new b.ErrnoError(70)}},major:i=>i>>8,minor:i=>i&255,makedev:(i,l)=>i<<8|l,registerDevice:(i,l)=>{b.devices[i]={stream_ops:l}},getDevice:i=>b.devices[i],getMounts:i=>{for(var l=[],d=[i];d.length;){var y=d.pop();l.push(y),d.push.apply(d,y.mounts)}return l},syncfs:(i,l)=>{typeof i=="function"&&(l=i,i=!1),b.syncFSRequests++,b.syncFSRequests>1&&P("warning: "+b.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var d=b.getMounts(b.root.mount),y=0;function w(T){return b.syncFSRequests--,l(T)}function M(T){if(T)return M.errored?void 0:(M.errored=!0,w(T));++y>=d.length&&w(null)}d.forEach(T=>{if(!T.type.syncfs)return M(null);T.type.syncfs(T,i,M)})},mount:(i,l,d)=>{var y=d==="/",w=!d,M;if(y&&b.root)throw new b.ErrnoError(10);if(!y&&!w){var T=b.lookupPath(d,{follow_mount:!1});if(d=T.path,M=T.node,b.isMountpoint(M))throw new b.ErrnoError(10);if(!b.isDir(M.mode))throw new b.ErrnoError(54)}var E={type:i,opts:l,mountpoint:d,mounts:[]},L=i.mount(E);return L.mount=E,E.root=L,y?b.root=L:M&&(M.mounted=E,M.mount&&M.mount.mounts.push(E)),L},unmount:i=>{var l=b.lookupPath(i,{follow_mount:!1});if(!b.isMountpoint(l.node))throw new b.ErrnoError(28);var d=l.node,y=d.mounted,w=b.getMounts(y);Object.keys(b.nameTable).forEach(T=>{for(var E=b.nameTable[T];E;){var L=E.name_next;w.includes(E.mount)&&b.destroyNode(E),E=L}}),d.mounted=null;var M=d.mount.mounts.indexOf(y);d.mount.mounts.splice(M,1)},lookup:(i,l)=>i.node_ops.lookup(i,l),mknod:(i,l,d)=>{var y=b.lookupPath(i,{parent:!0}),w=y.node,M=Gt.basename(i);if(!M||M==="."||M==="..")throw new b.ErrnoError(28);var T=b.mayCreate(w,M);if(T)throw new b.ErrnoError(T);if(!w.node_ops.mknod)throw new b.ErrnoError(63);return w.node_ops.mknod(w,M,l,d)},create:(i,l)=>(l=l!==void 0?l:438,l&=4095,l|=32768,b.mknod(i,l,0)),mkdir:(i,l)=>(l=l!==void 0?l:511,l&=1023,l|=16384,b.mknod(i,l,0)),mkdirTree:(i,l)=>{for(var d=i.split("/"),y="",w=0;w<d.length;++w)if(d[w]){y+="/"+d[w];try{b.mkdir(y,l)}catch(M){if(M.errno!=20)throw M}}},mkdev:(i,l,d)=>(typeof d>"u"&&(d=l,l=438),l|=8192,b.mknod(i,l,d)),symlink:(i,l)=>{if(!de.resolve(i))throw new b.ErrnoError(44);var d=b.lookupPath(l,{parent:!0}),y=d.node;if(!y)throw new b.ErrnoError(44);var w=Gt.basename(l),M=b.mayCreate(y,w);if(M)throw new b.ErrnoError(M);if(!y.node_ops.symlink)throw new b.ErrnoError(63);return y.node_ops.symlink(y,w,i)},rename:(i,l)=>{var d=Gt.dirname(i),y=Gt.dirname(l),w=Gt.basename(i),M=Gt.basename(l),T,E,L;if(T=b.lookupPath(i,{parent:!0}),E=T.node,T=b.lookupPath(l,{parent:!0}),L=T.node,!E||!L)throw new b.ErrnoError(44);if(E.mount!==L.mount)throw new b.ErrnoError(75);var H=b.lookupNode(E,w),et=de.relative(i,y);if(et.charAt(0)!==".")throw new b.ErrnoError(28);if(et=de.relative(l,d),et.charAt(0)!==".")throw new b.ErrnoError(55);var pt;try{pt=b.lookupNode(L,M)}catch{}if(H!==pt){var ot=b.isDir(H.mode),Ct=b.mayDelete(E,w,ot);if(Ct)throw new b.ErrnoError(Ct);if(Ct=pt?b.mayDelete(L,M,ot):b.mayCreate(L,M),Ct)throw new b.ErrnoError(Ct);if(!E.node_ops.rename)throw new b.ErrnoError(63);if(b.isMountpoint(H)||pt&&b.isMountpoint(pt))throw new b.ErrnoError(10);if(L!==E&&(Ct=b.nodePermissions(E,"w"),Ct))throw new b.ErrnoError(Ct);b.hashRemoveNode(H);try{E.node_ops.rename(H,L,M)}catch(Dt){throw Dt}finally{b.hashAddNode(H)}}},rmdir:i=>{var l=b.lookupPath(i,{parent:!0}),d=l.node,y=Gt.basename(i),w=b.lookupNode(d,y),M=b.mayDelete(d,y,!0);if(M)throw new b.ErrnoError(M);if(!d.node_ops.rmdir)throw new b.ErrnoError(63);if(b.isMountpoint(w))throw new b.ErrnoError(10);d.node_ops.rmdir(d,y),b.destroyNode(w)},readdir:i=>{var l=b.lookupPath(i,{follow:!0}),d=l.node;if(!d.node_ops.readdir)throw new b.ErrnoError(54);return d.node_ops.readdir(d)},unlink:i=>{var l=b.lookupPath(i,{parent:!0}),d=l.node;if(!d)throw new b.ErrnoError(44);var y=Gt.basename(i),w=b.lookupNode(d,y),M=b.mayDelete(d,y,!1);if(M)throw new b.ErrnoError(M);if(!d.node_ops.unlink)throw new b.ErrnoError(63);if(b.isMountpoint(w))throw new b.ErrnoError(10);d.node_ops.unlink(d,y),b.destroyNode(w)},readlink:i=>{var l=b.lookupPath(i),d=l.node;if(!d)throw new b.ErrnoError(44);if(!d.node_ops.readlink)throw new b.ErrnoError(28);return de.resolve(b.getPath(d.parent),d.node_ops.readlink(d))},stat:(i,l)=>{var d=b.lookupPath(i,{follow:!l}),y=d.node;if(!y)throw new b.ErrnoError(44);if(!y.node_ops.getattr)throw new b.ErrnoError(63);return y.node_ops.getattr(y)},lstat:i=>b.stat(i,!0),chmod:(i,l,d)=>{var y;if(typeof i=="string"){var w=b.lookupPath(i,{follow:!d});y=w.node}else y=i;if(!y.node_ops.setattr)throw new b.ErrnoError(63);y.node_ops.setattr(y,{mode:l&4095|y.mode&-4096,timestamp:Date.now()})},lchmod:(i,l)=>{b.chmod(i,l,!0)},fchmod:(i,l)=>{var d=b.getStream(i);if(!d)throw new b.ErrnoError(8);b.chmod(d.node,l)},chown:(i,l,d,y)=>{var w;if(typeof i=="string"){var M=b.lookupPath(i,{follow:!y});w=M.node}else w=i;if(!w.node_ops.setattr)throw new b.ErrnoError(63);w.node_ops.setattr(w,{timestamp:Date.now()})},lchown:(i,l,d)=>{b.chown(i,l,d,!0)},fchown:(i,l,d)=>{var y=b.getStream(i);if(!y)throw new b.ErrnoError(8);b.chown(y.node,l,d)},truncate:(i,l)=>{if(l<0)throw new b.ErrnoError(28);var d;if(typeof i=="string"){var y=b.lookupPath(i,{follow:!0});d=y.node}else d=i;if(!d.node_ops.setattr)throw new b.ErrnoError(63);if(b.isDir(d.mode))throw new b.ErrnoError(31);if(!b.isFile(d.mode))throw new b.ErrnoError(28);var w=b.nodePermissions(d,"w");if(w)throw new b.ErrnoError(w);d.node_ops.setattr(d,{size:l,timestamp:Date.now()})},ftruncate:(i,l)=>{var d=b.getStream(i);if(!d)throw new b.ErrnoError(8);if(!(d.flags&2097155))throw new b.ErrnoError(28);b.truncate(d.node,l)},utime:(i,l,d)=>{var y=b.lookupPath(i,{follow:!0}),w=y.node;w.node_ops.setattr(w,{timestamp:Math.max(l,d)})},open:(i,l,d)=>{if(i==="")throw new b.ErrnoError(44);l=typeof l=="string"?b.modeStringToFlags(l):l,d=typeof d>"u"?438:d,l&64?d=d&4095|32768:d=0;var y;if(typeof i=="object")y=i;else{i=Gt.normalize(i);try{var w=b.lookupPath(i,{follow:!(l&131072)});y=w.node}catch{}}var M=!1;if(l&64)if(y){if(l&128)throw new b.ErrnoError(20)}else y=b.mknod(i,d,0),M=!0;if(!y)throw new b.ErrnoError(44);if(b.isChrdev(y.mode)&&(l&=-513),l&65536&&!b.isDir(y.mode))throw new b.ErrnoError(54);if(!M){var T=b.mayOpen(y,l);if(T)throw new b.ErrnoError(T)}l&512&&!M&&b.truncate(y,0),l&=-131713;var E=b.createStream({node:y,path:b.getPath(y),flags:l,seekable:!0,position:0,stream_ops:y.stream_ops,ungotten:[],error:!1});return E.stream_ops.open&&E.stream_ops.open(E),t.logReadFiles&&!(l&1)&&(b.readFiles||(b.readFiles={}),i in b.readFiles||(b.readFiles[i]=1)),E},close:i=>{if(b.isClosed(i))throw new b.ErrnoError(8);i.getdents&&(i.getdents=null);try{i.stream_ops.close&&i.stream_ops.close(i)}catch(l){throw l}finally{b.closeStream(i.fd)}i.fd=null},isClosed:i=>i.fd===null,llseek:(i,l,d)=>{if(b.isClosed(i))throw new b.ErrnoError(8);if(!i.seekable||!i.stream_ops.llseek)throw new b.ErrnoError(70);if(d!=0&&d!=1&&d!=2)throw new b.ErrnoError(28);return i.position=i.stream_ops.llseek(i,l,d),i.ungotten=[],i.position},read:(i,l,d,y,w)=>{if(y<0||w<0)throw new b.ErrnoError(28);if(b.isClosed(i))throw new b.ErrnoError(8);if((i.flags&2097155)===1)throw new b.ErrnoError(8);if(b.isDir(i.node.mode))throw new b.ErrnoError(31);if(!i.stream_ops.read)throw new b.ErrnoError(28);var M=typeof w<"u";if(!M)w=i.position;else if(!i.seekable)throw new b.ErrnoError(70);var T=i.stream_ops.read(i,l,d,y,w);return M||(i.position+=T),T},write:(i,l,d,y,w,M)=>{if(y<0||w<0)throw new b.ErrnoError(28);if(b.isClosed(i))throw new b.ErrnoError(8);if(!(i.flags&2097155))throw new b.ErrnoError(8);if(b.isDir(i.node.mode))throw new b.ErrnoError(31);if(!i.stream_ops.write)throw new b.ErrnoError(28);i.seekable&&i.flags&1024&&b.llseek(i,0,2);var T=typeof w<"u";if(!T)w=i.position;else if(!i.seekable)throw new b.ErrnoError(70);var E=i.stream_ops.write(i,l,d,y,w,M);return T||(i.position+=E),E},allocate:(i,l,d)=>{if(b.isClosed(i))throw new b.ErrnoError(8);if(l<0||d<=0)throw new b.ErrnoError(28);if(!(i.flags&2097155))throw new b.ErrnoError(8);if(!b.isFile(i.node.mode)&&!b.isDir(i.node.mode))throw new b.ErrnoError(43);if(!i.stream_ops.allocate)throw new b.ErrnoError(138);i.stream_ops.allocate(i,l,d)},mmap:(i,l,d,y,w)=>{if(y&2&&!(w&2)&&(i.flags&2097155)!==2)throw new b.ErrnoError(2);if((i.flags&2097155)===1)throw new b.ErrnoError(2);if(!i.stream_ops.mmap)throw new b.ErrnoError(43);return i.stream_ops.mmap(i,l,d,y,w)},msync:(i,l,d,y,w)=>i.stream_ops.msync?i.stream_ops.msync(i,l,d,y,w):0,munmap:i=>0,ioctl:(i,l,d)=>{if(!i.stream_ops.ioctl)throw new b.ErrnoError(59);return i.stream_ops.ioctl(i,l,d)},readFile:(i,l={})=>{if(l.flags=l.flags||0,l.encoding=l.encoding||"binary",l.encoding!=="utf8"&&l.encoding!=="binary")throw new Error('Invalid encoding type "'+l.encoding+'"');var d,y=b.open(i,l.flags),w=b.stat(i),M=w.size,T=new Uint8Array(M);return b.read(y,T,0,M,0),l.encoding==="utf8"?d=We(T,0):l.encoding==="binary"&&(d=T),b.close(y),d},writeFile:(i,l,d={})=>{d.flags=d.flags||577;var y=b.open(i,d.flags,d.mode);if(typeof l=="string"){var w=new Uint8Array(Ie(l)+1),M=zn(l,w,0,w.length);b.write(y,w,0,M,void 0,d.canOwn)}else if(ArrayBuffer.isView(l))b.write(y,l,0,l.byteLength,void 0,d.canOwn);else throw new Error("Unsupported data type");b.close(y)},cwd:()=>b.currentPath,chdir:i=>{var l=b.lookupPath(i,{follow:!0});if(l.node===null)throw new b.ErrnoError(44);if(!b.isDir(l.node.mode))throw new b.ErrnoError(54);var d=b.nodePermissions(l.node,"x");if(d)throw new b.ErrnoError(d);b.currentPath=l.path},createDefaultDirectories:()=>{b.mkdir("/tmp"),b.mkdir("/home"),b.mkdir("/home/web_user")},createDefaultDevices:()=>{b.mkdir("/dev"),b.registerDevice(b.makedev(1,3),{read:()=>0,write:(y,w,M,T,E)=>T}),b.mkdev("/dev/null",b.makedev(1,3)),Pe.register(b.makedev(5,0),Pe.default_tty_ops),Pe.register(b.makedev(6,0),Pe.default_tty1_ops),b.mkdev("/dev/tty",b.makedev(5,0)),b.mkdev("/dev/tty1",b.makedev(6,0));var i=new Uint8Array(1024),l=0,d=()=>(l===0&&(l=Wn(i).byteLength),i[--l]);b.createDevice("/dev","random",d),b.createDevice("/dev","urandom",d),b.mkdir("/dev/shm"),b.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{b.mkdir("/proc");var i=b.mkdir("/proc/self");b.mkdir("/proc/self/fd"),b.mount({mount:()=>{var l=b.createNode(i,"fd",16895,73);return l.node_ops={lookup:(d,y)=>{var w=+y,M=b.getStream(w);if(!M)throw new b.ErrnoError(8);var T={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>M.path}};return T.parent=T,T}},l}},{},"/proc/self/fd")},createStandardStreams:()=>{t.stdin?b.createDevice("/dev","stdin",t.stdin):b.symlink("/dev/tty","/dev/stdin"),t.stdout?b.createDevice("/dev","stdout",null,t.stdout):b.symlink("/dev/tty","/dev/stdout"),t.stderr?b.createDevice("/dev","stderr",null,t.stderr):b.symlink("/dev/tty1","/dev/stderr"),b.open("/dev/stdin",0),b.open("/dev/stdout",1),b.open("/dev/stderr",1)},ensureErrnoError:()=>{b.ErrnoError||(b.ErrnoError=function(i,l){this.name="ErrnoError",this.node=l,this.setErrno=function(d){this.errno=d},this.setErrno(i),this.message="FS error"},b.ErrnoError.prototype=new Error,b.ErrnoError.prototype.constructor=b.ErrnoError,[44].forEach(i=>{b.genericErrors[i]=new b.ErrnoError(i),b.genericErrors[i].stack="<generic error, no stack>"}))},staticInit:()=>{b.ensureErrnoError(),b.nameTable=new Array(4096),b.mount(Et,{},"/"),b.createDefaultDirectories(),b.createDefaultDevices(),b.createSpecialDirectories(),b.filesystems={MEMFS:Et}},init:(i,l,d)=>{b.init.initialized=!0,b.ensureErrnoError(),t.stdin=i||t.stdin,t.stdout=l||t.stdout,t.stderr=d||t.stderr,b.createStandardStreams()},quit:()=>{b.init.initialized=!1;for(var i=0;i<b.streams.length;i++){var l=b.streams[i];l&&b.close(l)}},getMode:(i,l)=>{var d=0;return i&&(d|=365),l&&(d|=146),d},findObject:(i,l)=>{var d=b.analyzePath(i,l);return d.exists?d.object:null},analyzePath:(i,l)=>{try{var d=b.lookupPath(i,{follow:!l});i=d.path}catch{}var y={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var d=b.lookupPath(i,{parent:!0});y.parentExists=!0,y.parentPath=d.path,y.parentObject=d.node,y.name=Gt.basename(i),d=b.lookupPath(i,{follow:!l}),y.exists=!0,y.path=d.path,y.object=d.node,y.name=d.node.name,y.isRoot=d.path==="/"}catch(w){y.error=w.errno}return y},createPath:(i,l,d,y)=>{i=typeof i=="string"?i:b.getPath(i);for(var w=l.split("/").reverse();w.length;){var M=w.pop();if(M){var T=Gt.join2(i,M);try{b.mkdir(T)}catch{}i=T}}return T},createFile:(i,l,d,y,w)=>{var M=Gt.join2(typeof i=="string"?i:b.getPath(i),l),T=b.getMode(y,w);return b.create(M,T)},createDataFile:(i,l,d,y,w,M)=>{var T=l;i&&(i=typeof i=="string"?i:b.getPath(i),T=l?Gt.join2(i,l):i);var E=b.getMode(y,w),L=b.create(T,E);if(d){if(typeof d=="string"){for(var H=new Array(d.length),et=0,pt=d.length;et<pt;++et)H[et]=d.charCodeAt(et);d=H}b.chmod(L,E|146);var ot=b.open(L,577);b.write(ot,d,0,d.length,0,M),b.close(ot),b.chmod(L,E)}return L},createDevice:(i,l,d,y)=>{var w=Gt.join2(typeof i=="string"?i:b.getPath(i),l),M=b.getMode(!!d,!!y);b.createDevice.major||(b.createDevice.major=64);var T=b.makedev(b.createDevice.major++,0);return b.registerDevice(T,{open:E=>{E.seekable=!1},close:E=>{y&&y.buffer&&y.buffer.length&&y(10)},read:(E,L,H,et,pt)=>{for(var ot=0,Ct=0;Ct<et;Ct++){var Dt;try{Dt=d()}catch{throw new b.ErrnoError(29)}if(Dt===void 0&&ot===0)throw new b.ErrnoError(6);if(Dt==null)break;ot++,L[H+Ct]=Dt}return ot&&(E.node.timestamp=Date.now()),ot},write:(E,L,H,et,pt)=>{for(var ot=0;ot<et;ot++)try{y(L[H+ot])}catch{throw new b.ErrnoError(29)}return et&&(E.node.timestamp=Date.now()),ot}}),b.mkdev(w,M,T)},forceLoadFile:i=>{if(i.isDevice||i.isFolder||i.link||i.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(r)try{i.contents=on(r(i.url),!0),i.usedBytes=i.contents.length}catch{throw new b.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(i,l,d,y,w)=>{function M(){this.lengthKnown=!1,this.chunks=[]}if(M.prototype.get=function(ot){if(!(ot>this.length-1||ot<0)){var Ct=ot%this.chunkSize,Dt=ot/this.chunkSize|0;return this.getter(Dt)[Ct]}},M.prototype.setDataGetter=function(ot){this.getter=ot},M.prototype.cacheLength=function(){var ot=new XMLHttpRequest;if(ot.open("HEAD",d,!1),ot.send(null),!(ot.status>=200&&ot.status<300||ot.status===304))throw new Error("Couldn't load "+d+". Status: "+ot.status);var Ct=Number(ot.getResponseHeader("Content-length")),Dt,Yt=(Dt=ot.getResponseHeader("Accept-Ranges"))&&Dt==="bytes",zt=(Dt=ot.getResponseHeader("Content-Encoding"))&&Dt==="gzip",At=1024*1024;Yt||(At=Ct);var ft=(Ft,Xt)=>{if(Ft>Xt)throw new Error("invalid range ("+Ft+", "+Xt+") or no bytes requested!");if(Xt>Ct-1)throw new Error("only "+Ct+" bytes available! programmer error!");var $t=new XMLHttpRequest;if($t.open("GET",d,!1),Ct!==At&&$t.setRequestHeader("Range","bytes="+Ft+"-"+Xt),$t.responseType="arraybuffer",$t.overrideMimeType&&$t.overrideMimeType("text/plain; charset=x-user-defined"),$t.send(null),!($t.status>=200&&$t.status<300||$t.status===304))throw new Error("Couldn't load "+d+". Status: "+$t.status);return $t.response!==void 0?new Uint8Array($t.response||[]):on($t.responseText||"",!0)},wt=this;wt.setDataGetter(Ft=>{var Xt=Ft*At,$t=(Ft+1)*At-1;if($t=Math.min($t,Ct-1),typeof wt.chunks[Ft]>"u"&&(wt.chunks[Ft]=ft(Xt,$t)),typeof wt.chunks[Ft]>"u")throw new Error("doXHR failed!");return wt.chunks[Ft]}),(zt||!Ct)&&(At=Ct=1,Ct=this.getter(0).length,At=Ct,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=Ct,this._chunkSize=At,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!a)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var T=new M;Object.defineProperties(T,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var E={isDevice:!1,contents:T}}else var E={isDevice:!1,url:d};var L=b.createFile(i,l,E,y,w);E.contents?L.contents=E.contents:E.url&&(L.contents=null,L.url=E.url),Object.defineProperties(L,{usedBytes:{get:function(){return this.contents.length}}});var H={},et=Object.keys(L.stream_ops);et.forEach(ot=>{var Ct=L.stream_ops[ot];H[ot]=function(){return b.forceLoadFile(L),Ct.apply(null,arguments)}});function pt(ot,Ct,Dt,Yt,zt){var At=ot.node.contents;if(zt>=At.length)return 0;var ft=Math.min(At.length-zt,Yt);if(At.slice)for(var wt=0;wt<ft;wt++)Ct[Dt+wt]=At[zt+wt];else for(var wt=0;wt<ft;wt++)Ct[Dt+wt]=At.get(zt+wt);return ft}return H.read=(ot,Ct,Dt,Yt,zt)=>(b.forceLoadFile(L),pt(ot,Ct,Dt,Yt,zt)),H.mmap=(ot,Ct,Dt,Yt,zt)=>{b.forceLoadFile(L);var At=_i(Ct);if(!At)throw new b.ErrnoError(48);return pt(ot,ct,At,Ct,Dt),{ptr:At,allocated:!0}},L.stream_ops=H,L},createPreloadedFile:(i,l,d,y,w,M,T,E,L,H)=>{var et=l?de.resolve(Gt.join2(i,l)):i;function pt(ot){function Ct(Dt){H&&H(),E||b.createDataFile(i,l,Dt,y,w,L),M&&M(),q()}Browser.handledByPreloadPlugin(ot,et,Ct,()=>{T&&T(),q()})||Ct(ot)}nt(),typeof d=="string"?Dr(d,ot=>pt(ot),T):pt(d)}},mi=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function We(i,l,d){for(var y=l+d,w=l;i[w]&&!(w>=y);)++w;if(w-l>16&&i.buffer&&mi)return mi.decode(i.subarray(l,w));for(var M="";l<w;){var T=i[l++];if(!(T&128)){M+=String.fromCharCode(T);continue}var E=i[l++]&63;if((T&224)==192){M+=String.fromCharCode((T&31)<<6|E);continue}var L=i[l++]&63;if((T&240)==224?T=(T&15)<<12|E<<6|L:T=(T&7)<<18|E<<12|L<<6|i[l++]&63,T<65536)M+=String.fromCharCode(T);else{var H=T-65536;M+=String.fromCharCode(55296|H>>10,56320|H&1023)}}return M}function ue(i,l){return i?We(ut,i,l):""}var Tt={DEFAULT_POLLMASK:5,calculateAt:function(i,l,d){if(Gt.isAbs(l))return l;var y;if(i===-100)y=b.cwd();else{var w=Tt.getStreamFromFD(i);y=w.path}if(l.length==0){if(!d)throw new b.ErrnoError(44);return y}return Gt.join2(y,l)},doStat:function(i,l,d){try{var y=i(l)}catch(E){if(E&&E.node&&Gt.normalize(l)!==Gt.normalize(b.getPath(E.node)))return-54;throw E}Y[d>>2]=y.dev,Y[d+8>>2]=y.ino,Y[d+12>>2]=y.mode,rt[d+16>>2]=y.nlink,Y[d+20>>2]=y.uid,Y[d+24>>2]=y.gid,Y[d+28>>2]=y.rdev,xt=[y.size>>>0,(yt=y.size,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[d+40>>2]=xt[0],Y[d+44>>2]=xt[1],Y[d+48>>2]=4096,Y[d+52>>2]=y.blocks;var w=y.atime.getTime(),M=y.mtime.getTime(),T=y.ctime.getTime();return xt=[Math.floor(w/1e3)>>>0,(yt=Math.floor(w/1e3),+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[d+56>>2]=xt[0],Y[d+60>>2]=xt[1],rt[d+64>>2]=w%1e3*1e3,xt=[Math.floor(M/1e3)>>>0,(yt=Math.floor(M/1e3),+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[d+72>>2]=xt[0],Y[d+76>>2]=xt[1],rt[d+80>>2]=M%1e3*1e3,xt=[Math.floor(T/1e3)>>>0,(yt=Math.floor(T/1e3),+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[d+88>>2]=xt[0],Y[d+92>>2]=xt[1],rt[d+96>>2]=T%1e3*1e3,xt=[y.ino>>>0,(yt=y.ino,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[d+104>>2]=xt[0],Y[d+108>>2]=xt[1],0},doMsync:function(i,l,d,y,w){if(!b.isFile(l.node.mode))throw new b.ErrnoError(43);if(y&2)return 0;var M=ut.slice(i,i+d);b.msync(l,M,w,d,y)},varargs:void 0,get:function(){Tt.varargs+=4;var i=Y[Tt.varargs-4>>2];return i},getStr:function(i){var l=ue(i);return l},getStreamFromFD:function(i){var l=b.getStream(i);if(!l)throw new b.ErrnoError(8);return l}};function Or(i,l){try{return i=Tt.getStr(i),b.chmod(i,l),0}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}var Vt={mount:function(i){return t.websocket=t.websocket&&typeof t.websocket=="object"?t.websocket:{},t.websocket._callbacks={},t.websocket.on=function(l,d){return typeof d=="function"&&(this._callbacks[l]=d),this},t.websocket.emit=function(l,d){typeof this._callbacks[l]=="function"&&this._callbacks[l].call(this,d)},b.createNode(null,"/",16895,0)},createSocket:function(i,l,d){l&=-526337;var y=l==1;if(y&&d&&d!=6)throw new b.ErrnoError(66);var w={family:i,type:l,protocol:d,server:null,error:null,peers:{},pending:[],recv_queue:[],sock_ops:Vt.websocket_sock_ops},M=Vt.nextname(),T=b.createNode(Vt.root,M,49152,0);T.sock=w;var E=b.createStream({path:M,node:T,flags:2,seekable:!1,stream_ops:Vt.stream_ops});return w.stream=E,w},getSocket:function(i){var l=b.getStream(i);return!l||!b.isSocket(l.node.mode)?null:l.node.sock},stream_ops:{poll:function(i){var l=i.node.sock;return l.sock_ops.poll(l)},ioctl:function(i,l,d){var y=i.node.sock;return y.sock_ops.ioctl(y,l,d)},read:function(i,l,d,y,w){var M=i.node.sock,T=M.sock_ops.recvmsg(M,y);return T?(l.set(T.buffer,d),T.buffer.length):0},write:function(i,l,d,y,w){var M=i.node.sock;return M.sock_ops.sendmsg(M,l,d,y)},close:function(i){var l=i.node.sock;l.sock_ops.close(l)}},nextname:function(){return Vt.nextname.current||(Vt.nextname.current=0),"socket["+Vt.nextname.current+++"]"},websocket_sock_ops:{createPeer:function(i,l,d){var y;if(typeof l=="object"&&(y=l,l=null,d=null),y)if(y._socket)l=y._socket.remoteAddress,d=y._socket.remotePort;else{var w=/ws[s]?:\/\/([^:]+):(\d+)/.exec(y.url);if(!w)throw new Error("WebSocket URL must be in the format ws(s)://address:port");l=w[1],d=parseInt(w[2],10)}else try{var M=t.websocket&&typeof t.websocket=="object",T="ws:#".replace("#","//");if(M&&typeof t.websocket.url=="string"&&(T=t.websocket.url),T==="ws://"||T==="wss://"){var E=l.split("/");T=T+E[0]+":"+d+"/"+E.slice(1).join("/")}var L="binary";M&&typeof t.websocket.subprotocol=="string"&&(L=t.websocket.subprotocol);var H=void 0;L!=="null"&&(L=L.replace(/^ +| +$/g,"").split(/ *, */),H=L),M&&t.websocket.subprotocol===null&&(L="null",H=void 0);var et;e?et=require("ws"):et=WebSocket,y=new et(T,H),y.binaryType="arraybuffer"}catch{throw new b.ErrnoError(23)}var pt={addr:l,port:d,socket:y,dgram_send_queue:[]};return Vt.websocket_sock_ops.addPeer(i,pt),Vt.websocket_sock_ops.handlePeerEvents(i,pt),i.type===2&&typeof i.sport<"u"&&pt.dgram_send_queue.push(new Uint8Array([255,255,255,255,"p".charCodeAt(0),"o".charCodeAt(0),"r".charCodeAt(0),"t".charCodeAt(0),(i.sport&65280)>>8,i.sport&255])),pt},getPeer:function(i,l,d){return i.peers[l+":"+d]},addPeer:function(i,l){i.peers[l.addr+":"+l.port]=l},removePeer:function(i,l){delete i.peers[l.addr+":"+l.port]},handlePeerEvents:function(i,l){var d=!0,y=function(){t.websocket.emit("open",i.stream.fd);try{for(var M=l.dgram_send_queue.shift();M;)l.socket.send(M),M=l.dgram_send_queue.shift()}catch{l.socket.close()}};function w(M){if(typeof M=="string"){var T=new TextEncoder;M=T.encode(M)}else{if(dt(M.byteLength!==void 0),M.byteLength==0)return;M=new Uint8Array(M)}var E=d;if(d=!1,E&&M.length===10&&M[0]===255&&M[1]===255&&M[2]===255&&M[3]===255&&M[4]==="p".charCodeAt(0)&&M[5]==="o".charCodeAt(0)&&M[6]==="r".charCodeAt(0)&&M[7]==="t".charCodeAt(0)){var L=M[8]<<8|M[9];Vt.websocket_sock_ops.removePeer(i,l),l.port=L,Vt.websocket_sock_ops.addPeer(i,l);return}i.recv_queue.push({addr:l.addr,port:l.port,data:M}),t.websocket.emit("message",i.stream.fd)}e?(l.socket.on("open",y),l.socket.on("message",function(M,T){T&&w(new Uint8Array(M).buffer)}),l.socket.on("close",function(){t.websocket.emit("close",i.stream.fd)}),l.socket.on("error",function(M){i.error=14,t.websocket.emit("error",[i.stream.fd,i.error,"ECONNREFUSED: Connection refused"])})):(l.socket.onopen=y,l.socket.onclose=function(){t.websocket.emit("close",i.stream.fd)},l.socket.onmessage=function(M){w(M.data)},l.socket.onerror=function(M){i.error=14,t.websocket.emit("error",[i.stream.fd,i.error,"ECONNREFUSED: Connection refused"])})},poll:function(i){if(i.type===1&&i.server)return i.pending.length?65:0;var l=0,d=i.type===1?Vt.websocket_sock_ops.getPeer(i,i.daddr,i.dport):null;return(i.recv_queue.length||!d||d&&d.socket.readyState===d.socket.CLOSING||d&&d.socket.readyState===d.socket.CLOSED)&&(l|=65),(!d||d&&d.socket.readyState===d.socket.OPEN)&&(l|=4),(d&&d.socket.readyState===d.socket.CLOSING||d&&d.socket.readyState===d.socket.CLOSED)&&(l|=16),l},ioctl:function(i,l,d){switch(l){case 21531:var y=0;return i.recv_queue.length&&(y=i.recv_queue[0].data.length),Y[d>>2]=y,0;default:return 28}},close:function(i){if(i.server){try{i.server.close()}catch{}i.server=null}for(var l=Object.keys(i.peers),d=0;d<l.length;d++){var y=i.peers[l[d]];try{y.socket.close()}catch{}Vt.websocket_sock_ops.removePeer(i,y)}return 0},bind:function(i,l,d){if(typeof i.saddr<"u"||typeof i.sport<"u")throw new b.ErrnoError(28);if(i.saddr=l,i.sport=d,i.type===2){i.server&&(i.server.close(),i.server=null);try{i.sock_ops.listen(i,0)}catch(y){if(y.name!=="ErrnoError"||y.errno!==138)throw y}}},connect:function(i,l,d){if(i.server)throw new b.ErrnoError(138);if(typeof i.daddr<"u"&&typeof i.dport<"u"){var y=Vt.websocket_sock_ops.getPeer(i,i.daddr,i.dport);if(y)throw y.socket.readyState===y.socket.CONNECTING?new b.ErrnoError(7):new b.ErrnoError(30)}var w=Vt.websocket_sock_ops.createPeer(i,l,d);throw i.daddr=w.addr,i.dport=w.port,new b.ErrnoError(26)},listen:function(i,l){if(!e)throw new b.ErrnoError(138);if(i.server)throw new b.ErrnoError(28);var d=require("ws").Server,y=i.saddr;i.server=new d({host:y,port:i.sport}),t.websocket.emit("listen",i.stream.fd),i.server.on("connection",function(w){if(i.type===1){var M=Vt.createSocket(i.family,i.type,i.protocol),T=Vt.websocket_sock_ops.createPeer(M,w);M.daddr=T.addr,M.dport=T.port,i.pending.push(M),t.websocket.emit("connection",M.stream.fd)}else Vt.websocket_sock_ops.createPeer(i,w),t.websocket.emit("connection",i.stream.fd)}),i.server.on("close",function(){t.websocket.emit("close",i.stream.fd),i.server=null}),i.server.on("error",function(w){i.error=23,t.websocket.emit("error",[i.stream.fd,i.error,"EHOSTUNREACH: Host is unreachable"])})},accept:function(i){if(!i.server||!i.pending.length)throw new b.ErrnoError(28);var l=i.pending.shift();return l.stream.flags=i.stream.flags,l},getname:function(i,l){var d,y;if(l){if(i.daddr===void 0||i.dport===void 0)throw new b.ErrnoError(53);d=i.daddr,y=i.dport}else d=i.saddr||0,y=i.sport||0;return{addr:d,port:y}},sendmsg:function(i,l,d,y,w,M){if(i.type===2){if((w===void 0||M===void 0)&&(w=i.daddr,M=i.dport),w===void 0||M===void 0)throw new b.ErrnoError(17)}else w=i.daddr,M=i.dport;var T=Vt.websocket_sock_ops.getPeer(i,w,M);if(i.type===1){if(!T||T.socket.readyState===T.socket.CLOSING||T.socket.readyState===T.socket.CLOSED)throw new b.ErrnoError(53);if(T.socket.readyState===T.socket.CONNECTING)throw new b.ErrnoError(6)}ArrayBuffer.isView(l)&&(d+=l.byteOffset,l=l.buffer);var E;if(E=l.slice(d,d+y),i.type===2&&(!T||T.socket.readyState!==T.socket.OPEN))return(!T||T.socket.readyState===T.socket.CLOSING||T.socket.readyState===T.socket.CLOSED)&&(T=Vt.websocket_sock_ops.createPeer(i,w,M)),T.dgram_send_queue.push(E),y;try{return T.socket.send(E),y}catch{throw new b.ErrnoError(28)}},recvmsg:function(i,l){if(i.type===1&&i.server)throw new b.ErrnoError(53);var d=i.recv_queue.shift();if(!d){if(i.type===1){var y=Vt.websocket_sock_ops.getPeer(i,i.daddr,i.dport);if(!y)throw new b.ErrnoError(53);if(y.socket.readyState===y.socket.CLOSING||y.socket.readyState===y.socket.CLOSED)return null;throw new b.ErrnoError(6)}throw new b.ErrnoError(6)}var w=d.data.byteLength||d.data.length,M=d.data.byteOffset||0,T=d.data.buffer||d.data,E=Math.min(l,w),L={buffer:new Uint8Array(T,M,E),addr:d.addr,port:d.port};if(i.type===1&&E<w){var H=w-E;d.data=new Uint8Array(T,M+E,H),i.recv_queue.unshift(d)}return L}}};function ln(i){var l=Vt.getSocket(i);if(!l)throw new b.ErrnoError(8);return l}function di(i){return Y[Ui()>>2]=i,i}function Nn(i){return(i&255)+"."+(i>>8&255)+"."+(i>>16&255)+"."+(i>>24&255)}function pi(i){var l="",d=0,y=0,w=0,M=0,T=0,E=0,L=[i[0]&65535,i[0]>>16,i[1]&65535,i[1]>>16,i[2]&65535,i[2]>>16,i[3]&65535,i[3]>>16],H=!0,et="";for(E=0;E<5;E++)if(L[E]!==0){H=!1;break}if(H){if(et=Nn(L[6]|L[7]<<16),L[5]===-1)return l="::ffff:",l+=et,l;if(L[5]===0)return l="::",et==="0.0.0.0"&&(et=""),et==="0.0.0.1"&&(et="1"),l+=et,l}for(d=0;d<8;d++)L[d]===0&&(d-w>1&&(T=0),w=d,T++),T>y&&(y=T,M=d-y+1);for(d=0;d<8;d++){if(y>1&&L[d]===0&&d>=M&&d<M+y){d===M&&(l+=":",M===0&&(l+=":"));continue}l+=Number(ni(L[d]&65535)).toString(16),l+=d<7?":":""}return l}function Ar(i,l){var d=ht[i>>1],y=ni(kt[i+2>>1]),w;switch(d){case 2:if(l!==16)return{errno:28};w=Y[i+4>>2],w=Nn(w);break;case 10:if(l!==28)return{errno:28};w=[Y[i+8>>2],Y[i+12>>2],Y[i+16>>2],Y[i+20>>2]],w=pi(w);break;default:return{errno:5}}return{family:d,addr:w,port:y}}function Xe(i){for(var l=i.split("."),d=0;d<4;d++){var y=Number(l[d]);if(isNaN(y))return null;l[d]=y}return(l[0]|l[1]<<8|l[2]<<16|l[3]<<24)>>>0}function un(i){return parseInt(i)}function Yn(i){var l,d,y,w,M=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,T=[];if(!M.test(i))return null;if(i==="::")return[0,0,0,0,0,0,0,0];for(i.startsWith("::")?i=i.replace("::","Z:"):i=i.replace("::",":Z:"),i.indexOf(".")>0?(i=i.replace(new RegExp("[.]","g"),":"),l=i.split(":"),l[l.length-4]=un(l[l.length-4])+un(l[l.length-3])*256,l[l.length-3]=un(l[l.length-2])+un(l[l.length-1])*256,l=l.slice(0,l.length-2)):l=i.split(":"),y=0,w=0,d=0;d<l.length;d++)if(typeof l[d]=="string")if(l[d]==="Z"){for(w=0;w<8-l.length+1;w++)T[d+w]=0;y=w-1}else T[d+y]=yn(parseInt(l[d],16));else T[d+y]=l[d];return[T[1]<<16|T[0],T[3]<<16|T[2],T[5]<<16|T[4],T[7]<<16|T[6]]}var ae={address_map:{id:1,addrs:{},names:{}},lookup_name:function(i){var l=Xe(i);if(l!==null||(l=Yn(i),l!==null))return i;var d;if(ae.address_map.addrs[i])d=ae.address_map.addrs[i];else{var y=ae.address_map.id++;dt(y<65535,"exceeded max address mappings of 65535"),d="172.29."+(y&255)+"."+(y&65280),ae.address_map.names[d]=i,ae.address_map.addrs[i]=d}return d},lookup_addr:function(i){return ae.address_map.names[i]?ae.address_map.names[i]:null}};function vi(i,l,d){if(d&&i===0)return null;var y=Ar(i,l);if(y.errno)throw new b.ErrnoError(y.errno);return y.addr=ae.lookup_addr(y.addr)||y.addr,y}function Fr(i,l,d,y,w,M){try{var T=ln(i),E=vi(l,d);return T.sock_ops.connect(T,E.addr,E.port),0}catch(L){if(typeof b>"u"||L.name!=="ErrnoError")throw L;return-L.errno}}function Rr(i){try{var l=Tt.getStreamFromFD(i);return b.createStream(l,0).fd}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function Lr(i,l,d,y){try{if(l=Tt.getStr(l),l=Tt.calculateAt(i,l),d&-8)return-28;var w=b.lookupPath(l,{follow:!0}),M=w.node;if(!M)return-44;var T="";return d&4&&(T+="r"),d&2&&(T+="w"),d&1&&(T+="x"),T&&b.nodePermissions(M,T)?-2:0}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}function Ue(i,l){return l+2097152>>>0<4194305-!!i?(i>>>0)+l*4294967296:NaN}function Gr(i,l,d,y,w,M){try{var T=Ue(d,y);if(isNaN(T))return-61;var E=Ue(w,M);if(isNaN(E))return-61;var L=Tt.getStreamFromFD(i);return b.allocate(L,T,E),0}catch(H){if(typeof b>"u"||H.name!=="ErrnoError")throw H;return-H.errno}}function Br(i,l){try{return b.fchmod(i,l),0}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function jr(i,l,d){Tt.varargs=d;try{var y=Tt.getStreamFromFD(i);switch(l){case 0:{var w=Tt.get();if(w<0)return-28;var M;return M=b.createStream(y,w),M.fd}case 1:case 2:return 0;case 3:return y.flags;case 4:{var w=Tt.get();return y.flags|=w,0}case 5:{var w=Tt.get(),T=0;return ht[w+T>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return di(28),-1;default:return-28}}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}function Wr(i,l){try{var d=Tt.getStreamFromFD(i);return Tt.doStat(b.stat,d.path,l)}catch(y){if(typeof b>"u"||y.name!=="ErrnoError")throw y;return-y.errno}}function ze(i,l,d){return zn(i,ut,l,d)}function zr(i,l){try{if(l===0)return-28;var d=b.cwd(),y=Ie(d)+1;return l<y?-68:(ze(d,i,l),y)}catch(w){if(typeof b>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function Hr(i,l,d){try{var y=Tt.getStreamFromFD(i);y.getdents||(y.getdents=b.readdir(y.path));for(var w=280,M=0,T=b.llseek(y,0,1),E=Math.floor(T/w);E<y.getdents.length&&M+w<=d;){var L,H,et=y.getdents[E];if(et===".")L=y.node.id,H=4;else if(et===".."){var pt=b.lookupPath(y.path,{parent:!0});L=pt.node.id,H=4}else{var ot=b.lookupNode(y.node,et);L=ot.id,H=b.isChrdev(ot.mode)?2:b.isDir(ot.mode)?4:b.isLink(ot.mode)?10:8}xt=[L>>>0,(yt=L,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[l+M>>2]=xt[0],Y[l+M+4>>2]=xt[1],xt=[(E+1)*w>>>0,(yt=(E+1)*w,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[l+M+8>>2]=xt[0],Y[l+M+12>>2]=xt[1],ht[l+M+16>>1]=280,ct[l+M+18>>0]=H,ze(et,l+M+19,256),M+=w,E+=1}return b.llseek(y,E*w,0),M}catch(Ct){if(typeof b>"u"||Ct.name!=="ErrnoError")throw Ct;return-Ct.errno}}function Nr(i,l,d,y,w,M){try{var T=ln(i);return l===1&&d===4?(Y[y>>2]=T.error,Y[w>>2]=4,T.error=null,0):-50}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}function Yr(i,l,d){Tt.varargs=d;try{var y=Tt.getStreamFromFD(i);switch(l){case 21509:case 21505:return y.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return y.tty?0:-59;case 21519:{if(!y.tty)return-59;var w=Tt.get();return Y[w>>2]=0,0}case 21520:return y.tty?-28:-59;case 21531:{var w=Tt.get();return b.ioctl(y,l,w)}case 21523:return y.tty?0:-59;case 21524:return y.tty?0:-59;default:return-28}}catch(M){if(typeof b>"u"||M.name!=="ErrnoError")throw M;return-M.errno}}function Xr(i,l){try{return i=Tt.getStr(i),Tt.doStat(b.lstat,i,l)}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function Ur(i,l,d,y){try{l=Tt.getStr(l);var w=y&256,M=y&4096;return y=y&-6401,l=Tt.calculateAt(i,l,M),Tt.doStat(w?b.lstat:b.stat,l,d)}catch(T){if(typeof b>"u"||T.name!=="ErrnoError")throw T;return-T.errno}}function Vr(i,l,d,y){Tt.varargs=y;try{l=Tt.getStr(l),l=Tt.calculateAt(i,l);var w=y?Tt.get():0;return b.open(l,d,w).fd}catch(M){if(typeof b>"u"||M.name!=="ErrnoError")throw M;return-M.errno}}function $r(i,l,d){try{for(var y=0,w=0;w<l;w++){var M=i+8*w,T=Y[M>>2],E=ht[M+4>>1],L=32,H=b.getStream(T);H&&(L=Tt.DEFAULT_POLLMASK,H.stream_ops.poll&&(L=H.stream_ops.poll(H))),L&=E|8|16,L&&y++,ht[M+6>>1]=L}return y}catch(et){if(typeof b>"u"||et.name!=="ErrnoError")throw et;return-et.errno}}function qr(i,l,d,y){try{if(l=Tt.getStr(l),l=Tt.calculateAt(i,l),y<=0)return-28;var w=b.readlink(l),M=Math.min(y,Ie(w)),T=ct[d+M];return ze(w,d,y+1),ct[d+M]=T,M}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}function yi(i,l,d,y,w){switch(l){case 2:d=Xe(d),Hn(i,16),w&&(Y[w>>2]=16),ht[i>>1]=l,Y[i+4>>2]=d,ht[i+2>>1]=yn(y);break;case 10:d=Yn(d),Hn(i,28),w&&(Y[w>>2]=28),Y[i>>2]=l,Y[i+8>>2]=d[0],Y[i+12>>2]=d[1],Y[i+16>>2]=d[2],Y[i+20>>2]=d[3],ht[i+2>>1]=yn(y);break;default:return 5}return 0}function Kr(i,l,d,y,w,M){try{var T=ln(i),E=T.sock_ops.recvmsg(T,d);if(!E)return 0;if(w)var L=yi(w,T.family,ae.lookup_name(E.addr),E.port,M);return ut.set(E.buffer,l),E.buffer.byteLength}catch(H){if(typeof b>"u"||H.name!=="ErrnoError")throw H;return-H.errno}}function Qr(i){try{return i=Tt.getStr(i),b.rmdir(i),0}catch(l){if(typeof b>"u"||l.name!=="ErrnoError")throw l;return-l.errno}}function Jr(i,l,d,y,w,M){try{var T=ln(i),E=vi(w,M,!0);return E?T.sock_ops.sendmsg(T,ct,l,d,E.addr,E.port):b.write(T.stream,ct,l,d)}catch(L){if(typeof b>"u"||L.name!=="ErrnoError")throw L;return-L.errno}}function Zr(i,l,d){try{var y=Vt.createSocket(i,l,d);return y.stream.fd}catch(w){if(typeof b>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function ta(i,l){try{return i=Tt.getStr(i),Tt.doStat(b.stat,i,l)}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function ea(i,l){try{return i=Tt.getStr(i),l=Tt.getStr(l),b.symlink(i,l),0}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return-d.errno}}function na(i,l,d){try{return l=Tt.getStr(l),l=Tt.calculateAt(i,l),d===0?b.unlink(l):d===512?b.rmdir(l):it("Invalid flags passed to unlinkat"),0}catch(y){if(typeof b>"u"||y.name!=="ErrnoError")throw y;return-y.errno}}var cn={};function Si(i){for(;i.length;){var l=i.pop(),d=i.pop();d(l)}}function Ve(i){return this.fromWireType(Y[i>>2])}var He={},Ee={},hn={},ia=48,ra=57;function Xn(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var l=i.charCodeAt(0);return l>=ia&&l<=ra?"_"+i:i}function fn(i,l){return i=Xn(i),{[i]:function(){return l.apply(this,arguments)}}[i]}function Un(i,l){var d=fn(l,function(y){this.name=l,this.message=y;var w=new Error(y).stack;w!==void 0&&(this.stack=this.toString()+`
`+w.replace(/^Error(:[^\n]*)?\n/,""))});return d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},d}var Ci=void 0;function gn(i){throw new Ci(i)}function Vn(i,l,d){i.forEach(function(E){hn[E]=l});function y(E){var L=d(E);L.length!==i.length&&gn("Mismatched type converter count");for(var H=0;H<i.length;++H)ce(i[H],L[H])}var w=new Array(l.length),M=[],T=0;l.forEach((E,L)=>{Ee.hasOwnProperty(E)?w[L]=Ee[E]:(M.push(E),He.hasOwnProperty(E)||(He[E]=[]),He[E].push(()=>{w[L]=Ee[E],++T,T===M.length&&y(w)}))}),M.length===0&&y(w)}function aa(i){var l=cn[i];delete cn[i];var d=l.rawConstructor,y=l.rawDestructor,w=l.fields,M=w.map(T=>T.getterReturnType).concat(w.map(T=>T.setterArgumentType));Vn([i],M,T=>{var E={};return w.forEach((L,H)=>{var et=L.fieldName,pt=T[H],ot=L.getter,Ct=L.getterContext,Dt=T[H+w.length],Yt=L.setter,zt=L.setterContext;E[et]={read:At=>pt.fromWireType(ot(Ct,At)),write:(At,ft)=>{var wt=[];Yt(zt,At,Dt.toWireType(wt,ft)),Si(wt)}}}),[{name:l.name,fromWireType:function(L){var H={};for(var et in E)H[et]=E[et].read(L);return y(L),H},toWireType:function(L,H){for(var et in E)if(!(et in H))throw new TypeError('Missing field:  "'+et+'"');var pt=d();for(et in E)E[et].write(pt,H[et]);return L!==null&&L.push(y,pt),pt},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:y}]})}function sa(i,l,d,y,w){}function _n(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+i)}}function oa(){for(var i=new Array(256),l=0;l<256;++l)i[l]=String.fromCharCode(l);wi=i}var wi=void 0;function Kt(i){for(var l="",d=i;ut[d];)l+=wi[ut[d++]];return l}var $e=void 0;function Rt(i){throw new $e(i)}function ce(i,l,d={}){if(!("argPackAdvance"in l))throw new TypeError("registerType registeredInstance requires argPackAdvance");var y=l.name;if(i||Rt('type "'+y+'" must have a positive integer typeid pointer'),Ee.hasOwnProperty(i)){if(d.ignoreDuplicateRegistrations)return;Rt("Cannot register type '"+y+"' twice")}if(Ee[i]=l,delete hn[i],He.hasOwnProperty(i)){var w=He[i];delete He[i],w.forEach(M=>M())}}function la(i,l,d,y,w){var M=_n(d);l=Kt(l),ce(i,{name:l,fromWireType:function(T){return!!T},toWireType:function(T,E){return E?y:w},argPackAdvance:8,readValueFromPointer:function(T){var E;if(d===1)E=ct;else if(d===2)E=ht;else if(d===4)E=Y;else throw new TypeError("Unknown boolean type size: "+l);return this.fromWireType(E[T>>M])},destructorFunction:null})}function ua(i){if(!(this instanceof ke)||!(i instanceof ke))return!1;for(var l=this.$$.ptrType.registeredClass,d=this.$$.ptr,y=i.$$.ptrType.registeredClass,w=i.$$.ptr;l.baseClass;)d=l.upcast(d),l=l.baseClass;for(;y.baseClass;)w=y.upcast(w),y=y.baseClass;return l===y&&d===w}function ca(i){return{count:i.count,deleteScheduled:i.deleteScheduled,preservePointerOnDelete:i.preservePointerOnDelete,ptr:i.ptr,ptrType:i.ptrType,smartPtr:i.smartPtr,smartPtrType:i.smartPtrType}}function $n(i){function l(d){return d.$$.ptrType.registeredClass.name}Rt(l(i)+" instance already deleted")}var qn=!1;function ki(i){}function ha(i){i.smartPtr?i.smartPtrType.rawDestructor(i.smartPtr):i.ptrType.registeredClass.rawDestructor(i.ptr)}function bi(i){i.count.value-=1;var l=i.count.value===0;l&&ha(i)}function Mi(i,l,d){if(l===d)return i;if(d.baseClass===void 0)return null;var y=Mi(i,l,d.baseClass);return y===null?null:d.downcast(y)}var xi={};function fa(){return Object.keys(Qe).length}function ga(){var i=[];for(var l in Qe)Qe.hasOwnProperty(l)&&i.push(Qe[l]);return i}var qe=[];function Kn(){for(;qe.length;){var i=qe.pop();i.$$.deleteScheduled=!1,i.delete()}}var Ke=void 0;function _a(i){Ke=i,qe.length&&Ke&&Ke(Kn)}function ma(){t.getInheritedInstanceCount=fa,t.getLiveInheritedInstances=ga,t.flushPendingDeletes=Kn,t.setDelayFunction=_a}var Qe={};function da(i,l){for(l===void 0&&Rt("ptr should not be undefined");i.baseClass;)l=i.upcast(l),i=i.baseClass;return l}function pa(i,l){return l=da(i,l),Qe[l]}function mn(i,l){(!l.ptrType||!l.ptr)&&gn("makeClassHandle requires ptr and ptrType");var d=!!l.smartPtrType,y=!!l.smartPtr;return d!==y&&gn("Both smartPtrType and smartPtr must be specified"),l.count={value:1},Je(Object.create(i,{$$:{value:l}}))}function va(i){var l=this.getPointee(i);if(!l)return this.destructor(i),null;var d=pa(this.registeredClass,l);if(d!==void 0){if(d.$$.count.value===0)return d.$$.ptr=l,d.$$.smartPtr=i,d.clone();var y=d.clone();return this.destructor(i),y}function w(){return this.isSmartPointer?mn(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:l,smartPtrType:this,smartPtr:i}):mn(this.registeredClass.instancePrototype,{ptrType:this,ptr:i})}var M=this.registeredClass.getActualType(l),T=xi[M];if(!T)return w.call(this);var E;this.isConst?E=T.constPointerType:E=T.pointerType;var L=Mi(l,this.registeredClass,E.registeredClass);return L===null?w.call(this):this.isSmartPointer?mn(E.registeredClass.instancePrototype,{ptrType:E,ptr:L,smartPtrType:this,smartPtr:i}):mn(E.registeredClass.instancePrototype,{ptrType:E,ptr:L})}function Je(i){return typeof FinalizationRegistry>"u"?(Je=l=>l,i):(qn=new FinalizationRegistry(l=>{bi(l.$$)}),Je=l=>{var d=l.$$,y=!!d.smartPtr;if(y){var w={$$:d};qn.register(l,w,l)}return l},ki=l=>qn.unregister(l),Je(i))}function ya(){if(this.$$.ptr||$n(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var i=Je(Object.create(Object.getPrototypeOf(this),{$$:{value:ca(this.$$)}}));return i.$$.count.value+=1,i.$$.deleteScheduled=!1,i}function Sa(){this.$$.ptr||$n(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Rt("Object already scheduled for deletion"),ki(this),bi(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ca(){return!this.$$.ptr}function wa(){return this.$$.ptr||$n(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Rt("Object already scheduled for deletion"),qe.push(this),qe.length===1&&Ke&&Ke(Kn),this.$$.deleteScheduled=!0,this}function ka(){ke.prototype.isAliasOf=ua,ke.prototype.clone=ya,ke.prototype.delete=Sa,ke.prototype.isDeleted=Ca,ke.prototype.deleteLater=wa}function ke(){}function ba(i,l,d){if(i[l].overloadTable===void 0){var y=i[l];i[l]=function(){return i[l].overloadTable.hasOwnProperty(arguments.length)||Rt("Function '"+d+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+i[l].overloadTable+")!"),i[l].overloadTable[arguments.length].apply(this,arguments)},i[l].overloadTable=[],i[l].overloadTable[y.argCount]=y}}function Qn(i,l,d){t.hasOwnProperty(i)?((d===void 0||t[i].overloadTable!==void 0&&t[i].overloadTable[d]!==void 0)&&Rt("Cannot register public name '"+i+"' twice"),ba(t,i,i),t.hasOwnProperty(d)&&Rt("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),t[i].overloadTable[d]=l):(t[i]=l,d!==void 0&&(t[i].numArguments=d))}function Ma(i,l,d,y,w,M,T,E){this.name=i,this.constructor=l,this.instancePrototype=d,this.rawDestructor=y,this.baseClass=w,this.getActualType=M,this.upcast=T,this.downcast=E,this.pureVirtualFunctions=[]}function Jn(i,l,d){for(;l!==d;)l.upcast||Rt("Expected null or instance of "+d.name+", got an instance of "+l.name),i=l.upcast(i),l=l.baseClass;return i}function xa(i,l){if(l===null)return this.isReference&&Rt("null is not a valid "+this.name),0;l.$$||Rt('Cannot pass "'+Zn(l)+'" as a '+this.name),l.$$.ptr||Rt("Cannot pass deleted object as a pointer of type "+this.name);var d=l.$$.ptrType.registeredClass,y=Jn(l.$$.ptr,d,this.registeredClass);return y}function Ta(i,l){var d;if(l===null)return this.isReference&&Rt("null is not a valid "+this.name),this.isSmartPointer?(d=this.rawConstructor(),i!==null&&i.push(this.rawDestructor,d),d):0;l.$$||Rt('Cannot pass "'+Zn(l)+'" as a '+this.name),l.$$.ptr||Rt("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&l.$$.ptrType.isConst&&Rt("Cannot convert argument of type "+(l.$$.smartPtrType?l.$$.smartPtrType.name:l.$$.ptrType.name)+" to parameter type "+this.name);var y=l.$$.ptrType.registeredClass;if(d=Jn(l.$$.ptr,y,this.registeredClass),this.isSmartPointer)switch(l.$$.smartPtr===void 0&&Rt("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:l.$$.smartPtrType===this?d=l.$$.smartPtr:Rt("Cannot convert argument of type "+(l.$$.smartPtrType?l.$$.smartPtrType.name:l.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:d=l.$$.smartPtr;break;case 2:if(l.$$.smartPtrType===this)d=l.$$.smartPtr;else{var w=l.clone();d=this.rawShare(d,he.toHandle(function(){w.delete()})),i!==null&&i.push(this.rawDestructor,d)}break;default:Rt("Unsupporting sharing policy")}return d}function Ia(i,l){if(l===null)return this.isReference&&Rt("null is not a valid "+this.name),0;l.$$||Rt('Cannot pass "'+Zn(l)+'" as a '+this.name),l.$$.ptr||Rt("Cannot pass deleted object as a pointer of type "+this.name),l.$$.ptrType.isConst&&Rt("Cannot convert argument of type "+l.$$.ptrType.name+" to parameter type "+this.name);var d=l.$$.ptrType.registeredClass,y=Jn(l.$$.ptr,d,this.registeredClass);return y}function Pa(i){return this.rawGetPointee&&(i=this.rawGetPointee(i)),i}function Ea(i){this.rawDestructor&&this.rawDestructor(i)}function Da(i){i!==null&&i.delete()}function Oa(){pe.prototype.getPointee=Pa,pe.prototype.destructor=Ea,pe.prototype.argPackAdvance=8,pe.prototype.readValueFromPointer=Ve,pe.prototype.deleteObject=Da,pe.prototype.fromWireType=va}function pe(i,l,d,y,w,M,T,E,L,H,et){this.name=i,this.registeredClass=l,this.isReference=d,this.isConst=y,this.isSmartPointer=w,this.pointeeType=M,this.sharingPolicy=T,this.rawGetPointee=E,this.rawConstructor=L,this.rawShare=H,this.rawDestructor=et,!w&&l.baseClass===void 0?y?(this.toWireType=xa,this.destructorFunction=null):(this.toWireType=Ia,this.destructorFunction=null):this.toWireType=Ta}function Ti(i,l,d){t.hasOwnProperty(i)||gn("Replacing nonexistant public symbol"),t[i].overloadTable!==void 0&&d!==void 0?t[i].overloadTable[d]=l:(t[i]=l,t[i].argCount=d)}function Aa(i,l,d){var y=t["dynCall_"+i];return d&&d.length?y.apply(null,[l].concat(d)):y.call(null,l)}function Fa(i,l,d){if(i.includes("j"))return Aa(i,l,d);var y=Ht(l).apply(null,d);return y}function Ra(i,l){var d=[];return function(){return d.length=0,Object.assign(d,arguments),Fa(i,l,d)}}function ve(i,l){i=Kt(i);function d(){return i.includes("j")?Ra(i,l):Ht(l)}var y=d();return typeof y!="function"&&Rt("unknown function pointer with signature "+i+": "+l),y}var Ii=void 0;function Pi(i){var l=Vi(i),d=Kt(l);return Se(l),d}function Ei(i,l){var d=[],y={};function w(M){if(!y[M]&&!Ee[M]){if(hn[M]){hn[M].forEach(w);return}d.push(M),y[M]=!0}}throw l.forEach(w),new Ii(i+": "+d.map(Pi).join([", "]))}function La(i,l,d,y,w,M,T,E,L,H,et,pt,ot){et=Kt(et),M=ve(w,M),E&&(E=ve(T,E)),H&&(H=ve(L,H)),ot=ve(pt,ot);var Ct=Xn(et);Qn(Ct,function(){Ei("Cannot construct "+et+" due to unbound types",[y])}),Vn([i,l,d],y?[y]:[],function(Dt){Dt=Dt[0];var Yt,zt;y?(Yt=Dt.registeredClass,zt=Yt.instancePrototype):zt=ke.prototype;var At=fn(Ct,function(){if(Object.getPrototypeOf(this)!==ft)throw new $e("Use 'new' to construct "+et);if(wt.constructor_body===void 0)throw new $e(et+" has no accessible constructor");var wn=wt.constructor_body[arguments.length];if(wn===void 0)throw new $e("Tried to invoke ctor of "+et+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(wt.constructor_body).toString()+") parameters instead!");return wn.apply(this,arguments)}),ft=Object.create(zt,{constructor:{value:At}});At.prototype=ft;var wt=new Ma(et,At,ft,ot,Yt,M,E,H),Ft=new pe(et,wt,!0,!1,!1),Xt=new pe(et+"*",wt,!1,!1,!1),$t=new pe(et+" const*",wt,!1,!0,!1);return xi[i]={pointerType:Xt,constPointerType:$t},Ti(Ct,At),[Ft,Xt,$t]})}function Ga(){this.allocated=[void 0],this.freelist=[],this.get=function(i){return this.allocated[i]},this.allocate=function(i){let l=this.freelist.pop()||this.allocated.length;return this.allocated[l]=i,l},this.free=function(i){this.allocated[i]=void 0,this.freelist.push(i)}}var ie=new Ga;function Di(i){i>=ie.reserved&&--ie.get(i).refcount===0&&ie.free(i)}function Ba(){for(var i=0,l=ie.reserved;l<ie.allocated.length;++l)ie.allocated[l]!==void 0&&++i;return i}function ja(){ie.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),ie.reserved=ie.allocated.length,t.count_emval_handles=Ba}var he={toValue:i=>(i||Rt("Cannot use deleted val. handle = "+i),ie.get(i).value),toHandle:i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ie.allocate({refcount:1,value:i})}}};function Wa(i,l){l=Kt(l),ce(i,{name:l,fromWireType:function(d){var y=he.toValue(d);return Di(d),y},toWireType:function(d,y){return he.toHandle(y)},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:null})}function za(i,l,d){switch(l){case 0:return function(y){var w=d?ct:ut;return this.fromWireType(w[y])};case 1:return function(y){var w=d?ht:kt;return this.fromWireType(w[y>>1])};case 2:return function(y){var w=d?Y:rt;return this.fromWireType(w[y>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Ha(i,l,d,y){var w=_n(d);l=Kt(l);function M(){}M.values={},ce(i,{name:l,constructor:M,fromWireType:function(T){return this.constructor.values[T]},toWireType:function(T,E){return E.value},argPackAdvance:8,readValueFromPointer:za(l,w,y),destructorFunction:null}),Qn(l,M)}function Oi(i,l){var d=Ee[i];return d===void 0&&Rt(l+" has unknown type "+Pi(i)),d}function Na(i,l,d){var y=Oi(i,"enum");l=Kt(l);var w=y.constructor,M=Object.create(y.constructor.prototype,{value:{value:d},constructor:{value:fn(y.name+"_"+l,function(){})}});w.values[d]=M,w[l]=M}function Zn(i){if(i===null)return"null";var l=typeof i;return l==="object"||l==="array"||l==="function"?i.toString():""+i}function Ya(i,l){switch(l){case 2:return function(d){return this.fromWireType(D[d>>2])};case 3:return function(d){return this.fromWireType(G[d>>3])};default:throw new TypeError("Unknown float type: "+i)}}function Xa(i,l,d){var y=_n(d);l=Kt(l),ce(i,{name:l,fromWireType:function(w){return w},toWireType:function(w,M){return M},argPackAdvance:8,readValueFromPointer:Ya(l,y),destructorFunction:null})}function Ua(i,l){if(!(i instanceof Function))throw new TypeError("new_ called with constructor type "+typeof i+" which is not a function");var d=fn(i.name||"unknownFunctionName",function(){});d.prototype=i.prototype;var y=new d,w=i.apply(y,l);return w instanceof Object?w:y}function Va(i,l,d,y,w,M){var T=l.length;T<2&&Rt("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var E=l[1]!==null&&d!==null,L=!1,H=1;H<l.length;++H)if(l[H]!==null&&l[H].destructorFunction===void 0){L=!0;break}for(var et=l[0].name!=="void",pt="",ot="",H=0;H<T-2;++H)pt+=(H!==0?", ":"")+"arg"+H,ot+=(H!==0?", ":"")+"arg"+H+"Wired";var Ct="return function "+Xn(i)+"("+pt+`) {
if (arguments.length !== `+(T-2)+`) {
throwBindingError('function `+i+" called with ' + arguments.length + ' arguments, expected "+(T-2)+` args!');
}
`;L&&(Ct+=`var destructors = [];
`);var Dt=L?"destructors":"null",Yt=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],zt=[Rt,y,w,Si,l[0],l[1]];E&&(Ct+="var thisWired = classParam.toWireType("+Dt+`, this);
`);for(var H=0;H<T-2;++H)Ct+="var arg"+H+"Wired = argType"+H+".toWireType("+Dt+", arg"+H+"); // "+l[H+2].name+`
`,Yt.push("argType"+H),zt.push(l[H+2]);if(E&&(ot="thisWired"+(ot.length>0?", ":"")+ot),Ct+=(et||M?"var rv = ":"")+"invoker(fn"+(ot.length>0?", ":"")+ot+`);
`,L)Ct+=`runDestructors(destructors);
`;else for(var H=E?1:2;H<l.length;++H){var At=H===1?"thisWired":"arg"+(H-2)+"Wired";l[H].destructorFunction!==null&&(Ct+=At+"_dtor("+At+"); // "+l[H].name+`
`,Yt.push(At+"_dtor"),zt.push(l[H].destructorFunction))}return et&&(Ct+=`var ret = retType.fromWireType(rv);
return ret;
`),Ct+=`}
`,Yt.push(Ct),Ua(Function,Yt).apply(null,zt)}function $a(i,l){for(var d=[],y=0;y<i;y++)d.push(rt[l+y*4>>2]);return d}function qa(i,l,d,y,w,M,T){var E=$a(l,d);i=Kt(i),w=ve(y,w),Qn(i,function(){Ei("Cannot call "+i+" due to unbound types",E)},l-1),Vn([],E,function(L){var H=[L[0],null].concat(L.slice(1));return Ti(i,Va(i,H,null,w,M,T),l-1),[]})}function Ka(i,l,d){switch(l){case 0:return d?function(y){return ct[y]}:function(y){return ut[y]};case 1:return d?function(y){return ht[y>>1]}:function(y){return kt[y>>1]};case 2:return d?function(y){return Y[y>>2]}:function(y){return rt[y>>2]};default:throw new TypeError("Unknown integer type: "+i)}}function Qa(i,l,d,y,w){l=Kt(l);var M=_n(d),T=pt=>pt;if(y===0){var E=32-8*d;T=pt=>pt<<E>>>E}var L=l.includes("unsigned"),H=(pt,ot)=>{},et;L?et=function(pt,ot){return H(ot,this.name),ot>>>0}:et=function(pt,ot){return H(ot,this.name),ot},ce(i,{name:l,fromWireType:T,toWireType:et,argPackAdvance:8,readValueFromPointer:Ka(l,M,y!==0),destructorFunction:null})}function Ja(i,l,d){var y=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],w=y[l];function M(T){T=T>>2;var E=rt,L=E[T],H=E[T+1];return new w(E.buffer,H,L)}d=Kt(d),ce(i,{name:d,fromWireType:M,argPackAdvance:8,readValueFromPointer:M},{ignoreDuplicateRegistrations:!0})}function Za(i,l){l=Kt(l);var d=l==="std::string";ce(i,{name:l,fromWireType:function(y){var w=rt[y>>2],M=y+4,T;if(d)for(var E=M,L=0;L<=w;++L){var H=M+L;if(L==w||ut[H]==0){var et=H-E,pt=ue(E,et);T===void 0?T=pt:(T+=String.fromCharCode(0),T+=pt),E=H+1}}else{for(var ot=new Array(w),L=0;L<w;++L)ot[L]=String.fromCharCode(ut[M+L]);T=ot.join("")}return Se(y),T},toWireType:function(y,w){w instanceof ArrayBuffer&&(w=new Uint8Array(w));var M,T=typeof w=="string";T||w instanceof Uint8Array||w instanceof Uint8ClampedArray||w instanceof Int8Array||Rt("Cannot pass non-string to std::string"),d&&T?M=Ie(w):M=w.length;var E=ye(4+M+1),L=E+4;if(rt[E>>2]=M,d&&T)ze(w,L,M+1);else if(T)for(var H=0;H<M;++H){var et=w.charCodeAt(H);et>255&&(Se(L),Rt("String has UTF-16 code units that do not fit in 8 bits")),ut[L+H]=et}else for(var H=0;H<M;++H)ut[L+H]=w[H];return y!==null&&y.push(Se,E),E},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(y){Se(y)}})}var Ai=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ts(i,l){for(var d=i,y=d>>1,w=y+l/2;!(y>=w)&&kt[y];)++y;if(d=y<<1,d-i>32&&Ai)return Ai.decode(ut.subarray(i,d));for(var M="",T=0;!(T>=l/2);++T){var E=ht[i+T*2>>1];if(E==0)break;M+=String.fromCharCode(E)}return M}function es(i,l,d){if(d===void 0&&(d=2147483647),d<2)return 0;d-=2;for(var y=l,w=d<i.length*2?d/2:i.length,M=0;M<w;++M){var T=i.charCodeAt(M);ht[l>>1]=T,l+=2}return ht[l>>1]=0,l-y}function ns(i){return i.length*2}function is(i,l){for(var d=0,y="";!(d>=l/4);){var w=Y[i+d*4>>2];if(w==0)break;if(++d,w>=65536){var M=w-65536;y+=String.fromCharCode(55296|M>>10,56320|M&1023)}else y+=String.fromCharCode(w)}return y}function rs(i,l,d){if(d===void 0&&(d=2147483647),d<4)return 0;for(var y=l,w=y+d-4,M=0;M<i.length;++M){var T=i.charCodeAt(M);if(T>=55296&&T<=57343){var E=i.charCodeAt(++M);T=65536+((T&1023)<<10)|E&1023}if(Y[l>>2]=T,l+=4,l+4>w)break}return Y[l>>2]=0,l-y}function as(i){for(var l=0,d=0;d<i.length;++d){var y=i.charCodeAt(d);y>=55296&&y<=57343&&++d,l+=4}return l}function ss(i,l,d){d=Kt(d);var y,w,M,T,E;l===2?(y=ts,w=es,T=ns,M=()=>kt,E=1):l===4&&(y=is,w=rs,T=as,M=()=>rt,E=2),ce(i,{name:d,fromWireType:function(L){for(var H=rt[L>>2],et=M(),pt,ot=L+4,Ct=0;Ct<=H;++Ct){var Dt=L+4+Ct*l;if(Ct==H||et[Dt>>E]==0){var Yt=Dt-ot,zt=y(ot,Yt);pt===void 0?pt=zt:(pt+=String.fromCharCode(0),pt+=zt),ot=Dt+l}}return Se(L),pt},toWireType:function(L,H){typeof H!="string"&&Rt("Cannot pass non-string to C++ string type "+d);var et=T(H),pt=ye(4+et+l);return rt[pt>>2]=et>>E,w(H,pt+4,et+l),L!==null&&L.push(Se,pt),pt},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(L){Se(L)}})}function os(i,l,d,y,w,M){cn[i]={name:Kt(l),rawConstructor:ve(d,y),rawDestructor:ve(w,M),fields:[]}}function ls(i,l,d,y,w,M,T,E,L,H){cn[i].fields.push({fieldName:Kt(l),getterReturnType:d,getter:ve(y,w),getterContext:M,setterArgumentType:T,setter:ve(E,L),setterContext:H})}function us(i,l){l=Kt(l),ce(i,{isVoid:!0,name:l,argPackAdvance:0,fromWireType:function(){},toWireType:function(d,y){}})}function cs(i){do{var l=rt[i>>2];i+=4;var d=rt[i>>2];i+=4;var y=rt[i>>2];i+=4;var w=ue(l);b.createPath("/",Gt.dirname(w),!0,!0),b.createDataFile(w,null,ct.subarray(y,y+d),!0,!0,!0)}while(rt[i>>2])}var hs=!0;function fs(){return hs}function gs(){throw 1/0}function _s(i){i>4&&(ie.get(i).refcount+=1)}function ms(){return he.toHandle([])}var ds={};function ps(i){var l=ds[i];return l===void 0?Kt(i):l}function vs(i){return he.toHandle(ps(i))}function ys(){return he.toHandle({})}function Ss(i,l,d){i=he.toValue(i),l=he.toValue(l),d=he.toValue(d),i[l]=d}function Cs(i,l){i=Oi(i,"_emval_take_value");var d=i.readValueFromPointer(l);return he.toHandle(d)}function Fi(i){return rt[i>>2]+Y[i+4>>2]*4294967296}function ws(i,l){var d=new Date(Fi(i)*1e3);Y[l>>2]=d.getUTCSeconds(),Y[l+4>>2]=d.getUTCMinutes(),Y[l+8>>2]=d.getUTCHours(),Y[l+12>>2]=d.getUTCDate(),Y[l+16>>2]=d.getUTCMonth(),Y[l+20>>2]=d.getUTCFullYear()-1900,Y[l+24>>2]=d.getUTCDay();var y=Date.UTC(d.getUTCFullYear(),0,1,0,0,0,0),w=(d.getTime()-y)/(1e3*60*60*24)|0;Y[l+28>>2]=w}function Ze(i){return i%4===0&&(i%100!==0||i%400===0)}var ks=[0,31,60,91,121,152,182,213,244,274,305,335],bs=[0,31,59,90,120,151,181,212,243,273,304,334];function Ri(i){var l=Ze(i.getFullYear()),d=l?ks:bs,y=d[i.getMonth()]+i.getDate()-1;return y}function Ms(i,l){var d=new Date(Fi(i)*1e3);Y[l>>2]=d.getSeconds(),Y[l+4>>2]=d.getMinutes(),Y[l+8>>2]=d.getHours(),Y[l+12>>2]=d.getDate(),Y[l+16>>2]=d.getMonth(),Y[l+20>>2]=d.getFullYear()-1900,Y[l+24>>2]=d.getDay();var y=Ri(d)|0;Y[l+28>>2]=y,Y[l+36>>2]=-(d.getTimezoneOffset()*60);var w=new Date(d.getFullYear(),0,1),M=new Date(d.getFullYear(),6,1).getTimezoneOffset(),T=w.getTimezoneOffset(),E=(M!=T&&d.getTimezoneOffset()==Math.min(T,M))|0;Y[l+32>>2]=E}function xs(i){var l=new Date(Y[i+20>>2]+1900,Y[i+16>>2],Y[i+12>>2],Y[i+8>>2],Y[i+4>>2],Y[i>>2],0),d=Y[i+32>>2],y=l.getTimezoneOffset(),w=new Date(l.getFullYear(),0,1),M=new Date(l.getFullYear(),6,1).getTimezoneOffset(),T=w.getTimezoneOffset(),E=Math.min(T,M);if(d<0)Y[i+32>>2]=+(M!=T&&E==y);else if(d>0!=(E==y)){var L=Math.max(T,M),H=d>0?E:L;l.setTime(l.getTime()+(H-y)*6e4)}Y[i+24>>2]=l.getDay();var et=Ri(l)|0;return Y[i+28>>2]=et,Y[i>>2]=l.getSeconds(),Y[i+4>>2]=l.getMinutes(),Y[i+8>>2]=l.getHours(),Y[i+12>>2]=l.getDate(),Y[i+16>>2]=l.getMonth(),Y[i+20>>2]=l.getYear(),l.getTime()/1e3|0}function Ts(i,l,d,y,w,M,T){try{var E=Tt.getStreamFromFD(y),L=b.mmap(E,i,w,l,d),H=L.ptr;return Y[M>>2]=L.allocated,rt[T>>2]=H,0}catch(et){if(typeof b>"u"||et.name!=="ErrnoError")throw et;return-et.errno}}function Is(i,l,d,y,w,M){try{var T=Tt.getStreamFromFD(w);d&2&&Tt.doMsync(i,T,l,y,M),b.munmap(T)}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}var tn={};function Li(i){if(i instanceof le||i=="unwind")return _t;c(1,i)}function Gi(i){_t=i,U()||(t.onExit&&t.onExit(i),at=!0),c(i,new le(i))}function Ps(i,l){_t=i,Gi(i)}var Bi=Ps;function Es(){if(!U())try{Bi(_t)}catch(i){Li(i)}}function Ds(i){if(!at)try{i(),Es()}catch(l){Li(l)}}var dn;e?dn=()=>{var i=process.hrtime();return i[0]*1e3+i[1]/1e6}:dn=()=>performance.now();function Os(i,l){if(tn[i]&&(clearTimeout(tn[i].id),delete tn[i]),!l)return 0;var d=setTimeout(()=>{delete tn[i],Ds(()=>qi(i,dn()))},l);return tn[i]={id:d,timeout_ms:l},0}function ti(i){var l=Ie(i)+1,d=ye(l);return d&&ze(i,d,l),d}function As(i,l,d){var y=new Date().getFullYear(),w=new Date(y,0,1),M=new Date(y,6,1),T=w.getTimezoneOffset(),E=M.getTimezoneOffset(),L=Math.max(T,E);rt[i>>2]=L*60,Y[l>>2]=+(T!=E);function H(Dt){var Yt=Dt.toTimeString().match(/\(([A-Za-z ]+)\)$/);return Yt?Yt[1]:"GMT"}var et=H(w),pt=H(M),ot=ti(et),Ct=ti(pt);E<T?(rt[d>>2]=ot,rt[d+4>>2]=Ct):(rt[d>>2]=Ct,rt[d+4>>2]=ot)}function Fs(){it("")}function Rs(){return Date.now()}function ji(){return 2147483648}function Ls(){return ji()}function Gs(i,l,d){ut.copyWithin(i,l,l+d)}function Bs(i){var l=K.buffer;try{return K.grow(i-l.byteLength+65535>>>16),j(),1}catch{}}function js(i){var l=ut.length;i=i>>>0;var d=ji();if(i>d)return!1;let y=(L,H)=>L+(H-L%H)%H;for(var w=1;w<=4;w*=2){var M=l*(1+.2/w);M=Math.min(M,i+100663296);var T=Math.min(d,y(Math.max(i,M),65536)),E=Bs(T);if(E)return!0}return!1}var ei={};function Ws(){return h||"./this.program"}function en(){if(!en.strings){var i=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",l={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:i,_:Ws()};for(var d in ei)ei[d]===void 0?delete l[d]:l[d]=ei[d];var y=[];for(var d in l)y.push(d+"="+l[d]);en.strings=y}return en.strings}function zs(i,l){for(var d=0;d<i.length;++d)ct[l++>>0]=i.charCodeAt(d);ct[l>>0]=0}function Hs(i,l){var d=0;return en().forEach(function(y,w){var M=l+d;rt[i+w*4>>2]=M,zs(y,M),d+=y.length+1}),0}function Ns(i,l){var d=en();rt[i>>2]=d.length;var y=0;return d.forEach(function(w){y+=w.length+1}),rt[l>>2]=y,0}function Ys(i){try{var l=Tt.getStreamFromFD(i);return b.close(l),0}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return d.errno}}function Xs(i,l){try{var d=0,y=0,w=0,M=Tt.getStreamFromFD(i),T=M.tty?2:b.isDir(M.mode)?3:b.isLink(M.mode)?7:4;return ct[l>>0]=T,ht[l+2>>1]=w,xt=[d>>>0,(yt=d,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[l+8>>2]=xt[0],Y[l+12>>2]=xt[1],xt=[y>>>0,(yt=y,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[l+16>>2]=xt[0],Y[l+20>>2]=xt[1],0}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return E.errno}}function Wi(i,l,d,y){for(var w=0,M=0;M<d;M++){var T=rt[l>>2],E=rt[l+4>>2];l+=8;var L=b.read(i,ct,T,E,y);if(L<0)return-1;if(w+=L,L<E)break;typeof y<"u"&&(y+=L)}return w}function Us(i,l,d,y,w,M){try{var T=Ue(y,w);if(isNaN(T))return 61;var E=Tt.getStreamFromFD(i),L=Wi(E,l,d,T);return rt[M>>2]=L,0}catch(H){if(typeof b>"u"||H.name!=="ErrnoError")throw H;return H.errno}}function zi(i,l,d,y){for(var w=0,M=0;M<d;M++){var T=rt[l>>2],E=rt[l+4>>2];l+=8;var L=b.write(i,ct,T,E,y);if(L<0)return-1;w+=L,typeof y<"u"&&(y+=L)}return w}function Vs(i,l,d,y,w,M){try{var T=Ue(y,w);if(isNaN(T))return 61;var E=Tt.getStreamFromFD(i),L=zi(E,l,d,T);return rt[M>>2]=L,0}catch(H){if(typeof b>"u"||H.name!=="ErrnoError")throw H;return H.errno}}function $s(i,l,d,y){try{var w=Tt.getStreamFromFD(i),M=Wi(w,l,d);return rt[y>>2]=M,0}catch(T){if(typeof b>"u"||T.name!=="ErrnoError")throw T;return T.errno}}function qs(i,l,d,y,w){try{var M=Ue(l,d);if(isNaN(M))return 61;var T=Tt.getStreamFromFD(i);return b.llseek(T,M,y),xt=[T.position>>>0,(yt=T.position,+Math.abs(yt)>=1?yt>0?(Math.min(+Math.floor(yt/4294967296),4294967295)|0)>>>0:~~+Math.ceil((yt-+(~~yt>>>0))/4294967296)>>>0:0)],Y[w>>2]=xt[0],Y[w+4>>2]=xt[1],T.getdents&&M===0&&y===0&&(T.getdents=null),0}catch(E){if(typeof b>"u"||E.name!=="ErrnoError")throw E;return E.errno}}function Ks(i){try{var l=Tt.getStreamFromFD(i);return l.stream_ops&&l.stream_ops.fsync?l.stream_ops.fsync(l):0}catch(d){if(typeof b>"u"||d.name!=="ErrnoError")throw d;return d.errno}}function Qs(i,l,d,y){try{var w=Tt.getStreamFromFD(i),M=zi(w,l,d);return rt[y>>2]=M,0}catch(T){if(typeof b>"u"||T.name!=="ErrnoError")throw T;return T.errno}}function Js(i,l,d,y){var w=0,M=0,T=0,E=0,L=0,H=0,et;function pt(ot,Ct,Dt,Yt,zt,At){var ft,wt,Ft,Xt;return wt=ot===10?28:16,zt=ot===10?pi(zt):Nn(zt),ft=ye(wt),Xt=yi(ft,ot,zt,At),dt(!Xt),Ft=ye(32),Y[Ft+4>>2]=ot,Y[Ft+8>>2]=Ct,Y[Ft+12>>2]=Dt,Y[Ft+24>>2]=Yt,rt[Ft+20>>2]=ft,ot===10?Y[Ft+16>>2]=28:Y[Ft+16>>2]=16,Y[Ft+28>>2]=0,Ft}if(d&&(T=Y[d>>2],E=Y[d+4>>2],L=Y[d+8>>2],H=Y[d+12>>2]),L&&!H&&(H=L===2?17:6),!L&&H&&(L=H===17?2:1),H===0&&(H=6),L===0&&(L=1),!i&&!l)return-2;if(T&-1088||d!==0&&Y[d>>2]&2&&!i)return-1;if(T&32)return-2;if(L!==0&&L!==1&&L!==2)return-7;if(E!==0&&E!==2&&E!==10)return-6;if(l&&(l=ue(l),M=parseInt(l,10),isNaN(M)))return T&1024?-2:-8;if(!i)return E===0&&(E=2),T&1||(E===2?w=Sn(2130706433):w=[0,0,0,1]),et=pt(E,L,H,null,w,M),rt[y>>2]=et,0;if(i=ue(i),w=Xe(i),w!==null)if(E===0||E===2)E=2;else if(E===10&&T&8)w=[0,0,Sn(65535),w],E=10;else return-2;else if(w=Yn(i),w!==null)if(E===0||E===10)E=10;else return-2;return w!=null?(et=pt(E,L,H,i,w,M),rt[y>>2]=et,0):T&4?-2:(i=ae.lookup_name(i),w=Xe(i),E===0?E=2:E===10&&(w=[0,0,Sn(65535),w]),et=pt(E,L,H,null,w,M),rt[y>>2]=et,0)}function Zs(i,l){return Wn(ut.subarray(i,i+l)),0}function to(i){var l=ye(20),d=ti(i);rt[l>>2]=d;var y=ye(4);rt[y>>2]=0,rt[l+4>>2]=y;var w=2;Y[l+8>>2]=w,Y[l+12>>2]=4;var M=ye(12);return rt[M>>2]=M+8,rt[M+4>>2]=0,Y[M+8>>2]=Xe(ae.lookup_name(i)),rt[l+16>>2]=M,l}function eo(i){return to(ue(i))}function no(i,l){for(var d=0,y=0;y<=l;d+=i[y++]);return d}var Hi=[31,29,31,30,31,30,31,31,30,31,30,31],Ni=[31,28,31,30,31,30,31,31,30,31,30,31];function io(i,l){for(var d=new Date(i.getTime());l>0;){var y=Ze(d.getFullYear()),w=d.getMonth(),M=(y?Hi:Ni)[w];if(l>M-d.getDate())l-=M-d.getDate()+1,d.setDate(1),w<11?d.setMonth(w+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else return d.setDate(d.getDate()+l),d}return d}function ro(i,l){ct.set(i,l)}function Yi(i,l,d,y){var w=Y[y+40>>2],M={tm_sec:Y[y>>2],tm_min:Y[y+4>>2],tm_hour:Y[y+8>>2],tm_mday:Y[y+12>>2],tm_mon:Y[y+16>>2],tm_year:Y[y+20>>2],tm_wday:Y[y+24>>2],tm_yday:Y[y+28>>2],tm_isdst:Y[y+32>>2],tm_gmtoff:Y[y+36>>2],tm_zone:w?ue(w):""},T=ue(d),E={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var L in E)T=T.replace(new RegExp(L,"g"),E[L]);var H=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],et=["January","February","March","April","May","June","July","August","September","October","November","December"];function pt(ft,wt,Ft){for(var Xt=typeof ft=="number"?ft.toString():ft||"";Xt.length<wt;)Xt=Ft[0]+Xt;return Xt}function ot(ft,wt){return pt(ft,wt,"0")}function Ct(ft,wt){function Ft($t){return $t<0?-1:$t>0?1:0}var Xt;return(Xt=Ft(ft.getFullYear()-wt.getFullYear()))===0&&(Xt=Ft(ft.getMonth()-wt.getMonth()))===0&&(Xt=Ft(ft.getDate()-wt.getDate())),Xt}function Dt(ft){switch(ft.getDay()){case 0:return new Date(ft.getFullYear()-1,11,29);case 1:return ft;case 2:return new Date(ft.getFullYear(),0,3);case 3:return new Date(ft.getFullYear(),0,2);case 4:return new Date(ft.getFullYear(),0,1);case 5:return new Date(ft.getFullYear()-1,11,31);case 6:return new Date(ft.getFullYear()-1,11,30)}}function Yt(ft){var wt=io(new Date(ft.tm_year+1900,0,1),ft.tm_yday),Ft=new Date(wt.getFullYear(),0,4),Xt=new Date(wt.getFullYear()+1,0,4),$t=Dt(Ft),wn=Dt(Xt);return Ct($t,wt)<=0?Ct(wn,wt)<=0?wt.getFullYear()+1:wt.getFullYear():wt.getFullYear()-1}var zt={"%a":function(ft){return H[ft.tm_wday].substring(0,3)},"%A":function(ft){return H[ft.tm_wday]},"%b":function(ft){return et[ft.tm_mon].substring(0,3)},"%B":function(ft){return et[ft.tm_mon]},"%C":function(ft){var wt=ft.tm_year+1900;return ot(wt/100|0,2)},"%d":function(ft){return ot(ft.tm_mday,2)},"%e":function(ft){return pt(ft.tm_mday,2," ")},"%g":function(ft){return Yt(ft).toString().substring(2)},"%G":function(ft){return Yt(ft)},"%H":function(ft){return ot(ft.tm_hour,2)},"%I":function(ft){var wt=ft.tm_hour;return wt==0?wt=12:wt>12&&(wt-=12),ot(wt,2)},"%j":function(ft){return ot(ft.tm_mday+no(Ze(ft.tm_year+1900)?Hi:Ni,ft.tm_mon-1),3)},"%m":function(ft){return ot(ft.tm_mon+1,2)},"%M":function(ft){return ot(ft.tm_min,2)},"%n":function(){return`
`},"%p":function(ft){return ft.tm_hour>=0&&ft.tm_hour<12?"AM":"PM"},"%S":function(ft){return ot(ft.tm_sec,2)},"%t":function(){return"	"},"%u":function(ft){return ft.tm_wday||7},"%U":function(ft){var wt=ft.tm_yday+7-ft.tm_wday;return ot(Math.floor(wt/7),2)},"%V":function(ft){var wt=Math.floor((ft.tm_yday+7-(ft.tm_wday+6)%7)/7);if((ft.tm_wday+371-ft.tm_yday-2)%7<=2&&wt++,wt){if(wt==53){var Ft=(ft.tm_wday+371-ft.tm_yday)%7;Ft!=4&&(Ft!=3||!Ze(ft.tm_year))&&(wt=1)}}else{wt=52;var Xt=(ft.tm_wday+7-ft.tm_yday-1)%7;(Xt==4||Xt==5&&Ze(ft.tm_year%400-1))&&wt++}return ot(wt,2)},"%w":function(ft){return ft.tm_wday},"%W":function(ft){var wt=ft.tm_yday+7-(ft.tm_wday+6)%7;return ot(Math.floor(wt/7),2)},"%y":function(ft){return(ft.tm_year+1900).toString().substring(2)},"%Y":function(ft){return ft.tm_year+1900},"%z":function(ft){var wt=ft.tm_gmtoff,Ft=wt>=0;return wt=Math.abs(wt)/60,wt=wt/60*100+wt%60,(Ft?"+":"-")+("0000"+wt).slice(-4)},"%Z":function(ft){return ft.tm_zone},"%%":function(){return"%"}};T=T.replace(/%%/g,"\0\0");for(var L in zt)T.includes(L)&&(T=T.replace(new RegExp(L,"g"),zt[L](M)));T=T.replace(/\0\0/g,"%");var At=on(T,!1);return At.length>l?0:(ro(At,i),At.length-1)}function ao(i,l,d,y,w){return Yi(i,l,d,y)}function so(i){if(e){if(!i)return 1;var l=ue(i);if(!l.length)return 0;var d=require("child_process"),y=d.spawnSync(l,[],{shell:!0,stdio:"inherit"}),w=(T,E)=>T<<8|E;if(y.status===null){var M=T=>{switch(T){case"SIGHUP":return 1;case"SIGINT":return 2;case"SIGQUIT":return 3;case"SIGFPE":return 8;case"SIGKILL":return 9;case"SIGALRM":return 14;case"SIGTERM":return 15}return 2};return w(0,M(y.signal))}return w(y.status,0)}return i?(di(52),-1):0}var Xi=function(i,l,d,y){i||(i=this),this.parent=i,this.mount=i.mount,this.mounted=null,this.id=b.nextInode++,this.name=l,this.mode=d,this.node_ops={},this.stream_ops={},this.rdev=y},pn=365,vn=146;Object.defineProperties(Xi.prototype,{read:{get:function(){return(this.mode&pn)===pn},set:function(i){i?this.mode|=pn:this.mode&=~pn}},write:{get:function(){return(this.mode&vn)===vn},set:function(i){i?this.mode|=vn:this.mode&=~vn}},isFolder:{get:function(){return b.isDir(this.mode)}},isDevice:{get:function(){return b.isChrdev(this.mode)}}}),b.FSNode=Xi,b.staticInit(),t.FS_createPath=b.createPath,t.FS_createDataFile=b.createDataFile,t.FS_createPreloadedFile=b.createPreloadedFile,t.FS_unlink=b.unlink,t.FS_createLazyFile=b.createLazyFile,t.FS_createDevice=b.createDevice,Ci=t.InternalError=Un(Error,"InternalError"),oa(),$e=t.BindingError=Un(Error,"BindingError"),ka(),ma(),Oa(),Ii=t.UnboundTypeError=Un(Error,"UnboundTypeError"),ja();var oo={ja:jn,E:Tr,a:Ir,D:Mr,za:Or,$:Fr,ya:Rr,Aa:Lr,Va:Gr,va:Br,q:jr,O:Wr,qa:zr,ia:Hr,_:Nr,Ca:Yr,sa:Xr,ta:Ur,F:Vr,ka:$r,ha:qr,Z:Kr,ga:Qr,eb:Jr,db:Zr,ua:ta,fa:ea,M:na,Ma:aa,Xa:sa,Ga:la,J:La,Fa:Wa,x:Ha,f:Na,R:Xa,r:qa,s:Qa,o:Ja,Q:Za,H:ss,Na:os,T:ls,Ha:us,Ia:cs,wa:fs,ba:gs,n:Di,I:_s,La:ms,v:vs,S:ys,u:Ss,p:Cs,na:ws,oa:Ms,pa:xs,la:Ts,ma:Is,cb:Os,da:As,c:Fs,A:Rs,ea:Ls,z:dn,xa:Gs,ca:js,Da:Hs,Ea:Ns,y:Bi,w:Ys,N:Xs,Ua:Us,Ta:Vs,P:$s,Wa:qs,ra:Ks,G:Qs,Pa:Js,fb:Zs,Oa:eo,Sa:Co,B:mo,e:ho,d:co,h:uo,g:vo,Y:So,b:po,X:bo,m:yo,W:Mo,Ja:Do,Za:Lo,ab:Ao,$a:Fo,Ya:Go,bb:Oo,K:wo,l:fo,j:go,V:xo,U:To,i:lo,k:_o,t:ko,Qa:Po,Ka:Eo,Ra:Io,_a:Ro,Ba:Gi,L:Yi,aa:ao,C:so};Lt(),t._MagickColor_Create=function(){return(t._MagickColor_Create=t.asm.ib).apply(null,arguments)},t._MagickColor_Dispose=function(){return(t._MagickColor_Dispose=t.asm.jb).apply(null,arguments)},t._MagickColor_Count_Get=function(){return(t._MagickColor_Count_Get=t.asm.kb).apply(null,arguments)},t._MagickColor_Red_Get=function(){return(t._MagickColor_Red_Get=t.asm.lb).apply(null,arguments)},t._MagickColor_Red_Set=function(){return(t._MagickColor_Red_Set=t.asm.mb).apply(null,arguments)},t._MagickColor_Green_Get=function(){return(t._MagickColor_Green_Get=t.asm.nb).apply(null,arguments)},t._MagickColor_Green_Set=function(){return(t._MagickColor_Green_Set=t.asm.ob).apply(null,arguments)},t._MagickColor_Blue_Get=function(){return(t._MagickColor_Blue_Get=t.asm.pb).apply(null,arguments)},t._MagickColor_Blue_Set=function(){return(t._MagickColor_Blue_Set=t.asm.qb).apply(null,arguments)},t._MagickColor_Alpha_Get=function(){return(t._MagickColor_Alpha_Get=t.asm.rb).apply(null,arguments)},t._MagickColor_Alpha_Set=function(){return(t._MagickColor_Alpha_Set=t.asm.sb).apply(null,arguments)},t._MagickColor_Black_Get=function(){return(t._MagickColor_Black_Get=t.asm.tb).apply(null,arguments)},t._MagickColor_Black_Set=function(){return(t._MagickColor_Black_Set=t.asm.ub).apply(null,arguments)},t._MagickColor_IsCMYK_Get=function(){return(t._MagickColor_IsCMYK_Get=t.asm.vb).apply(null,arguments)},t._MagickColor_IsCMYK_Set=function(){return(t._MagickColor_IsCMYK_Set=t.asm.wb).apply(null,arguments)},t._MagickColor_Clone=function(){return(t._MagickColor_Clone=t.asm.xb).apply(null,arguments)},t._MagickColor_FuzzyEquals=function(){return(t._MagickColor_FuzzyEquals=t.asm.yb).apply(null,arguments)},t._MagickColor_Initialize=function(){return(t._MagickColor_Initialize=t.asm.zb).apply(null,arguments)},t._MagickColorCollection_DisposeList=function(){return(t._MagickColorCollection_DisposeList=t.asm.Bb).apply(null,arguments)},t._MagickColorCollection_GetInstance=function(){return(t._MagickColorCollection_GetInstance=t.asm.Cb).apply(null,arguments)},t._DrawingWand_Create=function(){return(t._DrawingWand_Create=t.asm.Db).apply(null,arguments)},t._DrawingWand_Dispose=function(){return(t._DrawingWand_Dispose=t.asm.Eb).apply(null,arguments)},t._DrawingWand_Affine=function(){return(t._DrawingWand_Affine=t.asm.Fb).apply(null,arguments)},t._DrawingWand_Alpha=function(){return(t._DrawingWand_Alpha=t.asm.Gb).apply(null,arguments)},t._DrawingWand_Arc=function(){return(t._DrawingWand_Arc=t.asm.Hb).apply(null,arguments)},t._DrawingWand_Bezier=function(){return(t._DrawingWand_Bezier=t.asm.Ib).apply(null,arguments)},t._DrawingWand_BorderColor=function(){return(t._DrawingWand_BorderColor=t.asm.Jb).apply(null,arguments)},t._DrawingWand_Circle=function(){return(t._DrawingWand_Circle=t.asm.Kb).apply(null,arguments)},t._DrawingWand_ClipPath=function(){return(t._DrawingWand_ClipPath=t.asm.Lb).apply(null,arguments)},t._DrawingWand_ClipRule=function(){return(t._DrawingWand_ClipRule=t.asm.Mb).apply(null,arguments)},t._DrawingWand_ClipUnits=function(){return(t._DrawingWand_ClipUnits=t.asm.Nb).apply(null,arguments)},t._DrawingWand_Color=function(){return(t._DrawingWand_Color=t.asm.Ob).apply(null,arguments)},t._DrawingWand_Composite=function(){return(t._DrawingWand_Composite=t.asm.Pb).apply(null,arguments)},t._DrawingWand_Density=function(){return(t._DrawingWand_Density=t.asm.Qb).apply(null,arguments)},t._DrawingWand_Ellipse=function(){return(t._DrawingWand_Ellipse=t.asm.Rb).apply(null,arguments)},t._DrawingWand_FillColor=function(){return(t._DrawingWand_FillColor=t.asm.Sb).apply(null,arguments)},t._DrawingWand_FillOpacity=function(){return(t._DrawingWand_FillOpacity=t.asm.Tb).apply(null,arguments)},t._DrawingWand_FillPatternUrl=function(){return(t._DrawingWand_FillPatternUrl=t.asm.Ub).apply(null,arguments)},t._DrawingWand_FillRule=function(){return(t._DrawingWand_FillRule=t.asm.Vb).apply(null,arguments)},t._DrawingWand_Font=function(){return(t._DrawingWand_Font=t.asm.Wb).apply(null,arguments)},t._DrawingWand_FontFamily=function(){return(t._DrawingWand_FontFamily=t.asm.Xb).apply(null,arguments)},t._DrawingWand_FontPointSize=function(){return(t._DrawingWand_FontPointSize=t.asm.Yb).apply(null,arguments)},t._DrawingWand_FontTypeMetrics=function(){return(t._DrawingWand_FontTypeMetrics=t.asm.Zb).apply(null,arguments)},t._TypeMetric_Create=function(){return(t._TypeMetric_Create=t.asm._b).apply(null,arguments)},t._DrawingWand_Gravity=function(){return(t._DrawingWand_Gravity=t.asm.$b).apply(null,arguments)},t._DrawingWand_Line=function(){return(t._DrawingWand_Line=t.asm.ac).apply(null,arguments)},t._DrawingWand_PathArcAbs=function(){return(t._DrawingWand_PathArcAbs=t.asm.bc).apply(null,arguments)},t._DrawingWand_PathArcRel=function(){return(t._DrawingWand_PathArcRel=t.asm.cc).apply(null,arguments)},t._DrawingWand_PathClose=function(){return(t._DrawingWand_PathClose=t.asm.dc).apply(null,arguments)},t._DrawingWand_PathCurveToAbs=function(){return(t._DrawingWand_PathCurveToAbs=t.asm.ec).apply(null,arguments)},t._DrawingWand_PathCurveToRel=function(){return(t._DrawingWand_PathCurveToRel=t.asm.fc).apply(null,arguments)},t._DrawingWand_PathFinish=function(){return(t._DrawingWand_PathFinish=t.asm.gc).apply(null,arguments)},t._DrawingWand_PathLineToAbs=function(){return(t._DrawingWand_PathLineToAbs=t.asm.hc).apply(null,arguments)},t._DrawingWand_PathLineToHorizontalAbs=function(){return(t._DrawingWand_PathLineToHorizontalAbs=t.asm.ic).apply(null,arguments)},t._DrawingWand_PathLineToHorizontalRel=function(){return(t._DrawingWand_PathLineToHorizontalRel=t.asm.jc).apply(null,arguments)},t._DrawingWand_PathLineToRel=function(){return(t._DrawingWand_PathLineToRel=t.asm.kc).apply(null,arguments)},t._DrawingWand_PathLineToVerticalAbs=function(){return(t._DrawingWand_PathLineToVerticalAbs=t.asm.lc).apply(null,arguments)},t._DrawingWand_PathLineToVerticalRel=function(){return(t._DrawingWand_PathLineToVerticalRel=t.asm.mc).apply(null,arguments)},t._DrawingWand_PathMoveToAbs=function(){return(t._DrawingWand_PathMoveToAbs=t.asm.nc).apply(null,arguments)},t._DrawingWand_PathMoveToRel=function(){return(t._DrawingWand_PathMoveToRel=t.asm.oc).apply(null,arguments)},t._DrawingWand_PathQuadraticCurveToAbs=function(){return(t._DrawingWand_PathQuadraticCurveToAbs=t.asm.pc).apply(null,arguments)},t._DrawingWand_PathQuadraticCurveToRel=function(){return(t._DrawingWand_PathQuadraticCurveToRel=t.asm.qc).apply(null,arguments)},t._DrawingWand_PathSmoothCurveToAbs=function(){return(t._DrawingWand_PathSmoothCurveToAbs=t.asm.rc).apply(null,arguments)},t._DrawingWand_PathSmoothCurveToRel=function(){return(t._DrawingWand_PathSmoothCurveToRel=t.asm.sc).apply(null,arguments)},t._DrawingWand_PathSmoothQuadraticCurveToAbs=function(){return(t._DrawingWand_PathSmoothQuadraticCurveToAbs=t.asm.tc).apply(null,arguments)},t._DrawingWand_PathSmoothQuadraticCurveToRel=function(){return(t._DrawingWand_PathSmoothQuadraticCurveToRel=t.asm.uc).apply(null,arguments)},t._DrawingWand_PathStart=function(){return(t._DrawingWand_PathStart=t.asm.vc).apply(null,arguments)},t._DrawingWand_Point=function(){return(t._DrawingWand_Point=t.asm.wc).apply(null,arguments)},t._DrawingWand_Polygon=function(){return(t._DrawingWand_Polygon=t.asm.xc).apply(null,arguments)},t._DrawingWand_Polyline=function(){return(t._DrawingWand_Polyline=t.asm.yc).apply(null,arguments)},t._DrawingWand_PopClipPath=function(){return(t._DrawingWand_PopClipPath=t.asm.zc).apply(null,arguments)},t._DrawingWand_PopGraphicContext=function(){return(t._DrawingWand_PopGraphicContext=t.asm.Ac).apply(null,arguments)},t._DrawingWand_PopPattern=function(){return(t._DrawingWand_PopPattern=t.asm.Bc).apply(null,arguments)},t._DrawingWand_PushClipPath=function(){return(t._DrawingWand_PushClipPath=t.asm.Cc).apply(null,arguments)},t._DrawingWand_PushGraphicContext=function(){return(t._DrawingWand_PushGraphicContext=t.asm.Dc).apply(null,arguments)},t._DrawingWand_PushPattern=function(){return(t._DrawingWand_PushPattern=t.asm.Ec).apply(null,arguments)},t._DrawingWand_Rectangle=function(){return(t._DrawingWand_Rectangle=t.asm.Fc).apply(null,arguments)},t._DrawingWand_Render=function(){return(t._DrawingWand_Render=t.asm.Gc).apply(null,arguments)},t._DrawingWand_Rotation=function(){return(t._DrawingWand_Rotation=t.asm.Hc).apply(null,arguments)},t._DrawingWand_RoundRectangle=function(){return(t._DrawingWand_RoundRectangle=t.asm.Ic).apply(null,arguments)},t._DrawingWand_Scaling=function(){return(t._DrawingWand_Scaling=t.asm.Jc).apply(null,arguments)},t._DrawingWand_SkewX=function(){return(t._DrawingWand_SkewX=t.asm.Kc).apply(null,arguments)},t._DrawingWand_SkewY=function(){return(t._DrawingWand_SkewY=t.asm.Lc).apply(null,arguments)},t._DrawingWand_StrokeAntialias=function(){return(t._DrawingWand_StrokeAntialias=t.asm.Mc).apply(null,arguments)},t._DrawingWand_StrokeColor=function(){return(t._DrawingWand_StrokeColor=t.asm.Nc).apply(null,arguments)},t._DrawingWand_StrokeDashArray=function(){return(t._DrawingWand_StrokeDashArray=t.asm.Oc).apply(null,arguments)},t._DrawingWand_StrokeDashOffset=function(){return(t._DrawingWand_StrokeDashOffset=t.asm.Pc).apply(null,arguments)},t._DrawingWand_StrokeLineCap=function(){return(t._DrawingWand_StrokeLineCap=t.asm.Qc).apply(null,arguments)},t._DrawingWand_StrokeLineJoin=function(){return(t._DrawingWand_StrokeLineJoin=t.asm.Rc).apply(null,arguments)},t._DrawingWand_StrokeMiterLimit=function(){return(t._DrawingWand_StrokeMiterLimit=t.asm.Sc).apply(null,arguments)},t._DrawingWand_StrokeOpacity=function(){return(t._DrawingWand_StrokeOpacity=t.asm.Tc).apply(null,arguments)},t._DrawingWand_StrokePatternUrl=function(){return(t._DrawingWand_StrokePatternUrl=t.asm.Uc).apply(null,arguments)},t._DrawingWand_StrokeWidth=function(){return(t._DrawingWand_StrokeWidth=t.asm.Vc).apply(null,arguments)},t._DrawingWand_Text=function(){return(t._DrawingWand_Text=t.asm.Wc).apply(null,arguments)},t._DrawingWand_TextAlignment=function(){return(t._DrawingWand_TextAlignment=t.asm.Xc).apply(null,arguments)},t._DrawingWand_TextAntialias=function(){return(t._DrawingWand_TextAntialias=t.asm.Yc).apply(null,arguments)},t._DrawingWand_TextDecoration=function(){return(t._DrawingWand_TextDecoration=t.asm.Zc).apply(null,arguments)},t._DrawingWand_TextDirection=function(){return(t._DrawingWand_TextDirection=t.asm._c).apply(null,arguments)},t._DrawingWand_TextEncoding=function(){return(t._DrawingWand_TextEncoding=t.asm.$c).apply(null,arguments)},t._DrawingWand_TextInterlineSpacing=function(){return(t._DrawingWand_TextInterlineSpacing=t.asm.ad).apply(null,arguments)},t._DrawingWand_TextInterwordSpacing=function(){return(t._DrawingWand_TextInterwordSpacing=t.asm.bd).apply(null,arguments)},t._DrawingWand_TextKerning=function(){return(t._DrawingWand_TextKerning=t.asm.cd).apply(null,arguments)},t._DrawingWand_TextUnderColor=function(){return(t._DrawingWand_TextUnderColor=t.asm.dd).apply(null,arguments)},t._DrawingWand_Translation=function(){return(t._DrawingWand_Translation=t.asm.ed).apply(null,arguments)},t._DrawingWand_Viewbox=function(){return(t._DrawingWand_Viewbox=t.asm.fd).apply(null,arguments)},t._PointInfoCollection_Create=function(){return(t._PointInfoCollection_Create=t.asm.gd).apply(null,arguments)},t._PointInfoCollection_Dispose=function(){return(t._PointInfoCollection_Dispose=t.asm.hd).apply(null,arguments)},t._PointInfoCollection_GetX=function(){return(t._PointInfoCollection_GetX=t.asm.id).apply(null,arguments)},t._PointInfoCollection_GetY=function(){return(t._PointInfoCollection_GetY=t.asm.jd).apply(null,arguments)},t._PointInfoCollection_Set=function(){return(t._PointInfoCollection_Set=t.asm.kd).apply(null,arguments)},t._MagickExceptionHelper_Description=function(){return(t._MagickExceptionHelper_Description=t.asm.ld).apply(null,arguments)},t._MagickExceptionHelper_Dispose=function(){return(t._MagickExceptionHelper_Dispose=t.asm.md).apply(null,arguments)},t._MagickExceptionHelper_Related=function(){return(t._MagickExceptionHelper_Related=t.asm.nd).apply(null,arguments)},t._MagickExceptionHelper_RelatedCount=function(){return(t._MagickExceptionHelper_RelatedCount=t.asm.od).apply(null,arguments)},t._MagickExceptionHelper_Message=function(){return(t._MagickExceptionHelper_Message=t.asm.pd).apply(null,arguments)},t._MagickExceptionHelper_Severity=function(){return(t._MagickExceptionHelper_Severity=t.asm.qd).apply(null,arguments)},t._PdfInfo_PageCount=function(){return(t._PdfInfo_PageCount=t.asm.rd).apply(null,arguments)},t._Environment_Initialize=function(){return(t._Environment_Initialize=t.asm.sd).apply(null,arguments)},t._Environment_GetEnv=function(){return(t._Environment_GetEnv=t.asm.td).apply(null,arguments)},t._Environment_SetEnv=function(){return(t._Environment_SetEnv=t.asm.ud).apply(null,arguments)},t._MagickMemory_Relinquish=function(){return(t._MagickMemory_Relinquish=t.asm.vd).apply(null,arguments)},t._Magick_Delegates_Get=function(){return(t._Magick_Delegates_Get=t.asm.wd).apply(null,arguments)},t._Magick_Features_Get=function(){return(t._Magick_Features_Get=t.asm.xd).apply(null,arguments)},t._Magick_ImageMagickVersion_Get=function(){return(t._Magick_ImageMagickVersion_Get=t.asm.yd).apply(null,arguments)},t._Magick_GetFonts=function(){return(t._Magick_GetFonts=t.asm.zd).apply(null,arguments)},t._Magick_GetFontFamily=function(){return(t._Magick_GetFontFamily=t.asm.Ad).apply(null,arguments)},t._Magick_GetFontName=function(){return(t._Magick_GetFontName=t.asm.Bd).apply(null,arguments)},t._Magick_DisposeFonts=function(){return(t._Magick_DisposeFonts=t.asm.Cd).apply(null,arguments)},t._Magick_SetDefaultFontFile=function(){return(t._Magick_SetDefaultFontFile=t.asm.Dd).apply(null,arguments)},t._Magick_SetRandomSeed=function(){return(t._Magick_SetRandomSeed=t.asm.Ed).apply(null,arguments)},t._Magick_SetLogDelegate=function(){return(t._Magick_SetLogDelegate=t.asm.Fd).apply(null,arguments)},t._Magick_SetLogEvents=function(){return(t._Magick_SetLogEvents=t.asm.Gd).apply(null,arguments)},t._Magick_SetOpenCLEnabled=function(){return(t._Magick_SetOpenCLEnabled=t.asm.Hd).apply(null,arguments)},t._MagickFormatInfo_CreateList=function(){return(t._MagickFormatInfo_CreateList=t.asm.Id).apply(null,arguments)},t._MagickFormatInfo_DisposeList=function(){return(t._MagickFormatInfo_DisposeList=t.asm.Jd).apply(null,arguments)},t._MagickFormatInfo_CanReadMultithreaded_Get=function(){return(t._MagickFormatInfo_CanReadMultithreaded_Get=t.asm.Kd).apply(null,arguments)},t._MagickFormatInfo_CanWriteMultithreaded_Get=function(){return(t._MagickFormatInfo_CanWriteMultithreaded_Get=t.asm.Ld).apply(null,arguments)},t._MagickFormatInfo_Description_Get=function(){return(t._MagickFormatInfo_Description_Get=t.asm.Md).apply(null,arguments)},t._MagickFormatInfo_Format_Get=function(){return(t._MagickFormatInfo_Format_Get=t.asm.Nd).apply(null,arguments)},t._MagickFormatInfo_MimeType_Get=function(){return(t._MagickFormatInfo_MimeType_Get=t.asm.Od).apply(null,arguments)},t._MagickFormatInfo_Module_Get=function(){return(t._MagickFormatInfo_Module_Get=t.asm.Pd).apply(null,arguments)},t._MagickFormatInfo_SupportsMultipleFrames_Get=function(){return(t._MagickFormatInfo_SupportsMultipleFrames_Get=t.asm.Qd).apply(null,arguments)},t._MagickFormatInfo_SupportsReading_Get=function(){return(t._MagickFormatInfo_SupportsReading_Get=t.asm.Rd).apply(null,arguments)},t._MagickFormatInfo_SupportsWriting_Get=function(){return(t._MagickFormatInfo_SupportsWriting_Get=t.asm.Sd).apply(null,arguments)},t._MagickFormatInfo_GetInfo=function(){return(t._MagickFormatInfo_GetInfo=t.asm.Td).apply(null,arguments)},t._MagickFormatInfo_GetInfoByName=function(){return(t._MagickFormatInfo_GetInfoByName=t.asm.Ud).apply(null,arguments)},t._MagickFormatInfo_GetInfoWithBlob=function(){return(t._MagickFormatInfo_GetInfoWithBlob=t.asm.Vd).apply(null,arguments)},t._MagickFormatInfo_Unregister=function(){return(t._MagickFormatInfo_Unregister=t.asm.Wd).apply(null,arguments)},t._MagickImage_Create=function(){return(t._MagickImage_Create=t.asm.Xd).apply(null,arguments)},t._MagickImage_Dispose=function(){return(t._MagickImage_Dispose=t.asm.Yd).apply(null,arguments)},t._MagickImage_AnimationDelay_Get=function(){return(t._MagickImage_AnimationDelay_Get=t.asm.Zd).apply(null,arguments)},t._MagickImage_AnimationDelay_Set=function(){return(t._MagickImage_AnimationDelay_Set=t.asm._d).apply(null,arguments)},t._MagickImage_AnimationIterations_Get=function(){return(t._MagickImage_AnimationIterations_Get=t.asm.$d).apply(null,arguments)},t._MagickImage_AnimationIterations_Set=function(){return(t._MagickImage_AnimationIterations_Set=t.asm.ae).apply(null,arguments)},t._MagickImage_AnimationTicksPerSecond_Get=function(){return(t._MagickImage_AnimationTicksPerSecond_Get=t.asm.be).apply(null,arguments)},t._MagickImage_AnimationTicksPerSecond_Set=function(){return(t._MagickImage_AnimationTicksPerSecond_Set=t.asm.ce).apply(null,arguments)},t._MagickImage_BackgroundColor_Get=function(){return(t._MagickImage_BackgroundColor_Get=t.asm.de).apply(null,arguments)},t._MagickImage_BackgroundColor_Set=function(){return(t._MagickImage_BackgroundColor_Set=t.asm.ee).apply(null,arguments)},t._MagickImage_BaseHeight_Get=function(){return(t._MagickImage_BaseHeight_Get=t.asm.fe).apply(null,arguments)},t._MagickImage_BaseWidth_Get=function(){return(t._MagickImage_BaseWidth_Get=t.asm.ge).apply(null,arguments)},t._MagickImage_BlackPointCompensation_Get=function(){return(t._MagickImage_BlackPointCompensation_Get=t.asm.he).apply(null,arguments)},t._MagickImage_BlackPointCompensation_Set=function(){return(t._MagickImage_BlackPointCompensation_Set=t.asm.ie).apply(null,arguments)},t._MagickImage_BorderColor_Get=function(){return(t._MagickImage_BorderColor_Get=t.asm.je).apply(null,arguments)},t._MagickImage_BorderColor_Set=function(){return(t._MagickImage_BorderColor_Set=t.asm.ke).apply(null,arguments)},t._MagickImage_BoundingBox_Get=function(){return(t._MagickImage_BoundingBox_Get=t.asm.le).apply(null,arguments)},t._MagickRectangle_Create=function(){return(t._MagickRectangle_Create=t.asm.me).apply(null,arguments)},t._MagickImage_ChannelCount_Get=function(){return(t._MagickImage_ChannelCount_Get=t.asm.ne).apply(null,arguments)},t._MagickImage_ChromaBluePrimary_Get=function(){return(t._MagickImage_ChromaBluePrimary_Get=t.asm.oe).apply(null,arguments)},t._PrimaryInfo_Create=function(){return(t._PrimaryInfo_Create=t.asm.pe).apply(null,arguments)},t._MagickImage_ChromaBluePrimary_Set=function(){return(t._MagickImage_ChromaBluePrimary_Set=t.asm.qe).apply(null,arguments)},t._MagickImage_ChromaGreenPrimary_Get=function(){return(t._MagickImage_ChromaGreenPrimary_Get=t.asm.re).apply(null,arguments)},t._MagickImage_ChromaGreenPrimary_Set=function(){return(t._MagickImage_ChromaGreenPrimary_Set=t.asm.se).apply(null,arguments)},t._MagickImage_ChromaRedPrimary_Get=function(){return(t._MagickImage_ChromaRedPrimary_Get=t.asm.te).apply(null,arguments)},t._MagickImage_ChromaRedPrimary_Set=function(){return(t._MagickImage_ChromaRedPrimary_Set=t.asm.ue).apply(null,arguments)},t._MagickImage_ChromaWhitePoint_Get=function(){return(t._MagickImage_ChromaWhitePoint_Get=t.asm.ve).apply(null,arguments)},t._MagickImage_ChromaWhitePoint_Set=function(){return(t._MagickImage_ChromaWhitePoint_Set=t.asm.we).apply(null,arguments)},t._MagickImage_ClassType_Get=function(){return(t._MagickImage_ClassType_Get=t.asm.xe).apply(null,arguments)},t._MagickImage_ClassType_Set=function(){return(t._MagickImage_ClassType_Set=t.asm.ye).apply(null,arguments)},t._QuantizeSettings_Create=function(){return(t._QuantizeSettings_Create=t.asm.ze).apply(null,arguments)},t._QuantizeSettings_Dispose=function(){return(t._QuantizeSettings_Dispose=t.asm.Ae).apply(null,arguments)},t._MagickImage_ColorFuzz_Get=function(){return(t._MagickImage_ColorFuzz_Get=t.asm.Be).apply(null,arguments)},t._MagickImage_ColorFuzz_Set=function(){return(t._MagickImage_ColorFuzz_Set=t.asm.Ce).apply(null,arguments)},t._MagickImage_ColormapSize_Get=function(){return(t._MagickImage_ColormapSize_Get=t.asm.De).apply(null,arguments)},t._MagickImage_ColormapSize_Set=function(){return(t._MagickImage_ColormapSize_Set=t.asm.Ee).apply(null,arguments)},t._MagickImage_ColorSpace_Get=function(){return(t._MagickImage_ColorSpace_Get=t.asm.Fe).apply(null,arguments)},t._MagickImage_ColorSpace_Set=function(){return(t._MagickImage_ColorSpace_Set=t.asm.Ge).apply(null,arguments)},t._MagickImage_ColorType_Get=function(){return(t._MagickImage_ColorType_Get=t.asm.He).apply(null,arguments)},t._MagickImage_ColorType_Set=function(){return(t._MagickImage_ColorType_Set=t.asm.Ie).apply(null,arguments)},t._MagickImage_Compose_Get=function(){return(t._MagickImage_Compose_Get=t.asm.Je).apply(null,arguments)},t._MagickImage_Compose_Set=function(){return(t._MagickImage_Compose_Set=t.asm.Ke).apply(null,arguments)},t._MagickImage_Compression_Get=function(){return(t._MagickImage_Compression_Get=t.asm.Le).apply(null,arguments)},t._MagickImage_Compression_Set=function(){return(t._MagickImage_Compression_Set=t.asm.Me).apply(null,arguments)},t._MagickImage_Depth_Get=function(){return(t._MagickImage_Depth_Get=t.asm.Ne).apply(null,arguments)},t._MagickImage_Depth_Set=function(){return(t._MagickImage_Depth_Set=t.asm.Oe).apply(null,arguments)},t._MagickImage_EncodingGeometry_Get=function(){return(t._MagickImage_EncodingGeometry_Get=t.asm.Pe).apply(null,arguments)},t._MagickImage_Endian_Get=function(){return(t._MagickImage_Endian_Get=t.asm.Qe).apply(null,arguments)},t._MagickImage_Endian_Set=function(){return(t._MagickImage_Endian_Set=t.asm.Re).apply(null,arguments)},t._MagickImage_FileName_Get=function(){return(t._MagickImage_FileName_Get=t.asm.Se).apply(null,arguments)},t._MagickImage_FileName_Set=function(){return(t._MagickImage_FileName_Set=t.asm.Te).apply(null,arguments)},t._MagickImage_FilterType_Get=function(){return(t._MagickImage_FilterType_Get=t.asm.Ue).apply(null,arguments)},t._MagickImage_FilterType_Set=function(){return(t._MagickImage_FilterType_Set=t.asm.Ve).apply(null,arguments)},t._MagickImage_Format_Get=function(){return(t._MagickImage_Format_Get=t.asm.We).apply(null,arguments)},t._MagickImage_Format_Set=function(){return(t._MagickImage_Format_Set=t.asm.Xe).apply(null,arguments)},t._MagickImage_Gamma_Get=function(){return(t._MagickImage_Gamma_Get=t.asm.Ye).apply(null,arguments)},t._MagickImage_GifDisposeMethod_Get=function(){return(t._MagickImage_GifDisposeMethod_Get=t.asm.Ze).apply(null,arguments)},t._MagickImage_GifDisposeMethod_Set=function(){return(t._MagickImage_GifDisposeMethod_Set=t.asm._e).apply(null,arguments)},t._MagickImage_Interpolate_Get=function(){return(t._MagickImage_Interpolate_Get=t.asm.$e).apply(null,arguments)},t._MagickImage_Interpolate_Set=function(){return(t._MagickImage_Interpolate_Set=t.asm.af).apply(null,arguments)},t._MagickImage_HasAlpha_Get=function(){return(t._MagickImage_HasAlpha_Get=t.asm.bf).apply(null,arguments)},t._MagickImage_HasAlpha_Set=function(){return(t._MagickImage_HasAlpha_Set=t.asm.cf).apply(null,arguments)},t._MagickImage_Height_Get=function(){return(t._MagickImage_Height_Get=t.asm.df).apply(null,arguments)},t._MagickImage_Interlace_Get=function(){return(t._MagickImage_Interlace_Get=t.asm.ef).apply(null,arguments)},t._MagickImage_Interlace_Set=function(){return(t._MagickImage_Interlace_Set=t.asm.ff).apply(null,arguments)},t._MagickImage_IsOpaque_Get=function(){return(t._MagickImage_IsOpaque_Get=t.asm.gf).apply(null,arguments)},t._MagickImage_MatteColor_Get=function(){return(t._MagickImage_MatteColor_Get=t.asm.hf).apply(null,arguments)},t._MagickImage_MatteColor_Set=function(){return(t._MagickImage_MatteColor_Set=t.asm.jf).apply(null,arguments)},t._MagickImage_MeanErrorPerPixel_Get=function(){return(t._MagickImage_MeanErrorPerPixel_Get=t.asm.kf).apply(null,arguments)},t._MagickImage_NormalizedMaximumError_Get=function(){return(t._MagickImage_NormalizedMaximumError_Get=t.asm.lf).apply(null,arguments)},t._MagickImage_NormalizedMeanError_Get=function(){return(t._MagickImage_NormalizedMeanError_Get=t.asm.mf).apply(null,arguments)},t._MagickImage_Orientation_Get=function(){return(t._MagickImage_Orientation_Get=t.asm.nf).apply(null,arguments)},t._MagickImage_Orientation_Set=function(){return(t._MagickImage_Orientation_Set=t.asm.of).apply(null,arguments)},t._MagickImage_RenderingIntent_Get=function(){return(t._MagickImage_RenderingIntent_Get=t.asm.pf).apply(null,arguments)},t._MagickImage_RenderingIntent_Set=function(){return(t._MagickImage_RenderingIntent_Set=t.asm.qf).apply(null,arguments)},t._MagickImage_Page_Get=function(){return(t._MagickImage_Page_Get=t.asm.rf).apply(null,arguments)},t._MagickImage_Page_Set=function(){return(t._MagickImage_Page_Set=t.asm.sf).apply(null,arguments)},t._MagickImage_Quality_Get=function(){return(t._MagickImage_Quality_Get=t.asm.tf).apply(null,arguments)},t._MagickImage_Quality_Set=function(){return(t._MagickImage_Quality_Set=t.asm.uf).apply(null,arguments)},t._MagickImage_ResolutionUnits_Get=function(){return(t._MagickImage_ResolutionUnits_Get=t.asm.vf).apply(null,arguments)},t._MagickImage_ResolutionUnits_Set=function(){return(t._MagickImage_ResolutionUnits_Set=t.asm.wf).apply(null,arguments)},t._MagickImage_ResolutionX_Get=function(){return(t._MagickImage_ResolutionX_Get=t.asm.xf).apply(null,arguments)},t._MagickImage_ResolutionX_Set=function(){return(t._MagickImage_ResolutionX_Set=t.asm.yf).apply(null,arguments)},t._MagickImage_ResolutionY_Get=function(){return(t._MagickImage_ResolutionY_Get=t.asm.zf).apply(null,arguments)},t._MagickImage_ResolutionY_Set=function(){return(t._MagickImage_ResolutionY_Set=t.asm.Af).apply(null,arguments)},t._MagickImage_Signature_Get=function(){return(t._MagickImage_Signature_Get=t.asm.Bf).apply(null,arguments)},t._MagickImage_TotalColors_Get=function(){return(t._MagickImage_TotalColors_Get=t.asm.Cf).apply(null,arguments)},t._MagickImage_VirtualPixelMethod_Get=function(){return(t._MagickImage_VirtualPixelMethod_Get=t.asm.Df).apply(null,arguments)},t._MagickImage_VirtualPixelMethod_Set=function(){return(t._MagickImage_VirtualPixelMethod_Set=t.asm.Ef).apply(null,arguments)},t._MagickImage_Width_Get=function(){return(t._MagickImage_Width_Get=t.asm.Ff).apply(null,arguments)},t._MagickImage_AdaptiveBlur=function(){return(t._MagickImage_AdaptiveBlur=t.asm.Gf).apply(null,arguments)},t._MagickImage_AdaptiveResize=function(){return(t._MagickImage_AdaptiveResize=t.asm.Hf).apply(null,arguments)},t._MagickImage_AdaptiveSharpen=function(){return(t._MagickImage_AdaptiveSharpen=t.asm.If).apply(null,arguments)},t._MagickImage_AdaptiveThreshold=function(){return(t._MagickImage_AdaptiveThreshold=t.asm.Jf).apply(null,arguments)},t._MagickImage_AddNoise=function(){return(t._MagickImage_AddNoise=t.asm.Kf).apply(null,arguments)},t._MagickImage_AddProfile=function(){return(t._MagickImage_AddProfile=t.asm.Lf).apply(null,arguments)},t._MagickImage_AffineTransform=function(){return(t._MagickImage_AffineTransform=t.asm.Mf).apply(null,arguments)},t._MagickImage_Annotate=function(){return(t._MagickImage_Annotate=t.asm.Nf).apply(null,arguments)},t._MagickImage_AnnotateGravity=function(){return(t._MagickImage_AnnotateGravity=t.asm.Of).apply(null,arguments)},t._MagickImage_AutoGamma=function(){return(t._MagickImage_AutoGamma=t.asm.Pf).apply(null,arguments)},t._MagickImage_AutoLevel=function(){return(t._MagickImage_AutoLevel=t.asm.Qf).apply(null,arguments)},t._MagickImage_AutoOrient=function(){return(t._MagickImage_AutoOrient=t.asm.Rf).apply(null,arguments)},t._MagickImage_AutoThreshold=function(){return(t._MagickImage_AutoThreshold=t.asm.Sf).apply(null,arguments)},t._MagickImage_BilateralBlur=function(){return(t._MagickImage_BilateralBlur=t.asm.Tf).apply(null,arguments)},t._MagickImage_BlackThreshold=function(){return(t._MagickImage_BlackThreshold=t.asm.Uf).apply(null,arguments)},t._MagickImage_BlueShift=function(){return(t._MagickImage_BlueShift=t.asm.Vf).apply(null,arguments)},t._MagickImage_Blur=function(){return(t._MagickImage_Blur=t.asm.Wf).apply(null,arguments)},t._MagickImage_Border=function(){return(t._MagickImage_Border=t.asm.Xf).apply(null,arguments)},t._MagickImage_BrightnessContrast=function(){return(t._MagickImage_BrightnessContrast=t.asm.Yf).apply(null,arguments)},t._MagickImage_CannyEdge=function(){return(t._MagickImage_CannyEdge=t.asm.Zf).apply(null,arguments)},t._MagickImage_ChannelOffset=function(){return(t._MagickImage_ChannelOffset=t.asm._f).apply(null,arguments)},t._MagickImage_Charcoal=function(){return(t._MagickImage_Charcoal=t.asm.$f).apply(null,arguments)},t._MagickImage_Chop=function(){return(t._MagickImage_Chop=t.asm.ag).apply(null,arguments)},t._MagickImage_Clahe=function(){return(t._MagickImage_Clahe=t.asm.bg).apply(null,arguments)},t._MagickImage_Clamp=function(){return(t._MagickImage_Clamp=t.asm.cg).apply(null,arguments)},t._MagickImage_ClipPath=function(){return(t._MagickImage_ClipPath=t.asm.dg).apply(null,arguments)},t._MagickImage_Clone=function(){return(t._MagickImage_Clone=t.asm.eg).apply(null,arguments)},t._MagickImage_CloneArea=function(){return(t._MagickImage_CloneArea=t.asm.fg).apply(null,arguments)},t._MagickImage_Clut=function(){return(t._MagickImage_Clut=t.asm.gg).apply(null,arguments)},t._MagickImage_ColorDecisionList=function(){return(t._MagickImage_ColorDecisionList=t.asm.hg).apply(null,arguments)},t._MagickImage_Colorize=function(){return(t._MagickImage_Colorize=t.asm.ig).apply(null,arguments)},t._MagickImage_ColorMatrix=function(){return(t._MagickImage_ColorMatrix=t.asm.jg).apply(null,arguments)},t._MagickImage_ColorThreshold=function(){return(t._MagickImage_ColorThreshold=t.asm.kg).apply(null,arguments)},t._MagickImage_Compare=function(){return(t._MagickImage_Compare=t.asm.lg).apply(null,arguments)},t._MagickImage_CompareDistortion=function(){return(t._MagickImage_CompareDistortion=t.asm.mg).apply(null,arguments)},t._MagickImage_Composite=function(){return(t._MagickImage_Composite=t.asm.ng).apply(null,arguments)},t._MagickImage_CompositeGravity=function(){return(t._MagickImage_CompositeGravity=t.asm.og).apply(null,arguments)},t._MagickImage_ConnectedComponents=function(){return(t._MagickImage_ConnectedComponents=t.asm.pg).apply(null,arguments)},t._MagickImage_Contrast=function(){return(t._MagickImage_Contrast=t.asm.qg).apply(null,arguments)},t._MagickImage_ContrastStretch=function(){return(t._MagickImage_ContrastStretch=t.asm.rg).apply(null,arguments)},t._MagickImage_ConvexHull=function(){return(t._MagickImage_ConvexHull=t.asm.sg).apply(null,arguments)},t._MagickImage_Convolve=function(){return(t._MagickImage_Convolve=t.asm.tg).apply(null,arguments)},t._MagickImage_CopyPixels=function(){return(t._MagickImage_CopyPixels=t.asm.ug).apply(null,arguments)},t._MagickImage_Crop=function(){return(t._MagickImage_Crop=t.asm.vg).apply(null,arguments)},t._MagickImage_CropToTiles=function(){return(t._MagickImage_CropToTiles=t.asm.wg).apply(null,arguments)},t._MagickImage_CycleColormap=function(){return(t._MagickImage_CycleColormap=t.asm.xg).apply(null,arguments)},t._MagickImage_Decipher=function(){return(t._MagickImage_Decipher=t.asm.yg).apply(null,arguments)},t._MagickImage_Deskew=function(){return(t._MagickImage_Deskew=t.asm.zg).apply(null,arguments)},t._MagickImage_Despeckle=function(){return(t._MagickImage_Despeckle=t.asm.Ag).apply(null,arguments)},t._MagickImage_DetermineBitDepth=function(){return(t._MagickImage_DetermineBitDepth=t.asm.Bg).apply(null,arguments)},t._MagickImage_DetermineColorType=function(){return(t._MagickImage_DetermineColorType=t.asm.Cg).apply(null,arguments)},t._MagickImage_Distort=function(){return(t._MagickImage_Distort=t.asm.Dg).apply(null,arguments)},t._MagickImage_Edge=function(){return(t._MagickImage_Edge=t.asm.Eg).apply(null,arguments)},t._MagickImage_Emboss=function(){return(t._MagickImage_Emboss=t.asm.Fg).apply(null,arguments)},t._MagickImage_Encipher=function(){return(t._MagickImage_Encipher=t.asm.Gg).apply(null,arguments)},t._MagickImage_Enhance=function(){return(t._MagickImage_Enhance=t.asm.Hg).apply(null,arguments)},t._MagickImage_Equalize=function(){return(t._MagickImage_Equalize=t.asm.Ig).apply(null,arguments)},t._MagickImage_Equals=function(){return(t._MagickImage_Equals=t.asm.Jg).apply(null,arguments)},t._MagickImage_EvaluateFunction=function(){return(t._MagickImage_EvaluateFunction=t.asm.Kg).apply(null,arguments)},t._MagickImage_EvaluateGeometry=function(){return(t._MagickImage_EvaluateGeometry=t.asm.Lg).apply(null,arguments)},t._MagickImage_EvaluateOperator=function(){return(t._MagickImage_EvaluateOperator=t.asm.Mg).apply(null,arguments)},t._MagickImage_Extent=function(){return(t._MagickImage_Extent=t.asm.Ng).apply(null,arguments)},t._MagickImage_Flip=function(){return(t._MagickImage_Flip=t.asm.Og).apply(null,arguments)},t._MagickImage_FloodFill=function(){return(t._MagickImage_FloodFill=t.asm.Pg).apply(null,arguments)},t._MagickImage_Flop=function(){return(t._MagickImage_Flop=t.asm.Qg).apply(null,arguments)},t._MagickImage_FontTypeMetrics=function(){return(t._MagickImage_FontTypeMetrics=t.asm.Rg).apply(null,arguments)},t._MagickImage_FormatExpression=function(){return(t._MagickImage_FormatExpression=t.asm.Sg).apply(null,arguments)},t._MagickImage_Frame=function(){return(t._MagickImage_Frame=t.asm.Tg).apply(null,arguments)},t._MagickImage_Fx=function(){return(t._MagickImage_Fx=t.asm.Ug).apply(null,arguments)},t._MagickImage_GammaCorrect=function(){return(t._MagickImage_GammaCorrect=t.asm.Vg).apply(null,arguments)},t._MagickImage_GaussianBlur=function(){return(t._MagickImage_GaussianBlur=t.asm.Wg).apply(null,arguments)},t._MagickImage_GetArtifact=function(){return(t._MagickImage_GetArtifact=t.asm.Xg).apply(null,arguments)},t._MagickImage_GetAttribute=function(){return(t._MagickImage_GetAttribute=t.asm.Yg).apply(null,arguments)},t._MagickImage_GetColormapColor=function(){return(t._MagickImage_GetColormapColor=t.asm.Zg).apply(null,arguments)},t._MagickImage_GetNext=function(){return(t._MagickImage_GetNext=t.asm._g).apply(null,arguments)},t._MagickImage_GetNextArtifactName=function(){return(t._MagickImage_GetNextArtifactName=t.asm.$g).apply(null,arguments)},t._MagickImage_GetNextAttributeName=function(){return(t._MagickImage_GetNextAttributeName=t.asm.ah).apply(null,arguments)},t._MagickImage_GetNextProfileName=function(){return(t._MagickImage_GetNextProfileName=t.asm.bh).apply(null,arguments)},t._MagickImage_GetProfile=function(){return(t._MagickImage_GetProfile=t.asm.ch).apply(null,arguments)},t._MagickImage_GetReadMask=function(){return(t._MagickImage_GetReadMask=t.asm.dh).apply(null,arguments)},t._MagickImage_GetWriteMask=function(){return(t._MagickImage_GetWriteMask=t.asm.eh).apply(null,arguments)},t._MagickImage_Grayscale=function(){return(t._MagickImage_Grayscale=t.asm.fh).apply(null,arguments)},t._MagickImage_HaldClut=function(){return(t._MagickImage_HaldClut=t.asm.gh).apply(null,arguments)},t._MagickImage_HasChannel=function(){return(t._MagickImage_HasChannel=t.asm.hh).apply(null,arguments)},t._MagickImage_HasProfile=function(){return(t._MagickImage_HasProfile=t.asm.ih).apply(null,arguments)},t._MagickImage_Histogram=function(){return(t._MagickImage_Histogram=t.asm.jh).apply(null,arguments)},t._MagickImage_HoughLine=function(){return(t._MagickImage_HoughLine=t.asm.kh).apply(null,arguments)},t._MagickImage_Implode=function(){return(t._MagickImage_Implode=t.asm.lh).apply(null,arguments)},t._MagickImage_ImportPixels=function(){return(t._MagickImage_ImportPixels=t.asm.mh).apply(null,arguments)},t._MagickImage_Integral=function(){return(t._MagickImage_Integral=t.asm.nh).apply(null,arguments)},t._MagickImage_InterpolativeResize=function(){return(t._MagickImage_InterpolativeResize=t.asm.oh).apply(null,arguments)},t._MagickImage_Kmeans=function(){return(t._MagickImage_Kmeans=t.asm.ph).apply(null,arguments)},t._MagickImage_Kuwahara=function(){return(t._MagickImage_Kuwahara=t.asm.qh).apply(null,arguments)},t._MagickImage_Level=function(){return(t._MagickImage_Level=t.asm.rh).apply(null,arguments)},t._MagickImage_LevelColors=function(){return(t._MagickImage_LevelColors=t.asm.sh).apply(null,arguments)},t._MagickImage_Levelize=function(){return(t._MagickImage_Levelize=t.asm.th).apply(null,arguments)},t._MagickImage_LinearStretch=function(){return(t._MagickImage_LinearStretch=t.asm.uh).apply(null,arguments)},t._MagickImage_LiquidRescale=function(){return(t._MagickImage_LiquidRescale=t.asm.vh).apply(null,arguments)},t._MagickImage_LocalContrast=function(){return(t._MagickImage_LocalContrast=t.asm.wh).apply(null,arguments)},t._MagickImage_Magnify=function(){return(t._MagickImage_Magnify=t.asm.xh).apply(null,arguments)},t._MagickImage_Map=function(){return(t._MagickImage_Map=t.asm.yh).apply(null,arguments)},t._MagickImage_MeanShift=function(){return(t._MagickImage_MeanShift=t.asm.zh).apply(null,arguments)},t._MagickImage_Minify=function(){return(t._MagickImage_Minify=t.asm.Ah).apply(null,arguments)},t._MagickImage_MinimumBoundingBox=function(){return(t._MagickImage_MinimumBoundingBox=t.asm.Bh).apply(null,arguments)},t._MagickImage_Modulate=function(){return(t._MagickImage_Modulate=t.asm.Ch).apply(null,arguments)},t._MagickImage_Moments=function(){return(t._MagickImage_Moments=t.asm.Dh).apply(null,arguments)},t._MagickImage_Morphology=function(){return(t._MagickImage_Morphology=t.asm.Eh).apply(null,arguments)},t._MagickImage_MotionBlur=function(){return(t._MagickImage_MotionBlur=t.asm.Fh).apply(null,arguments)},t._MagickImage_Negate=function(){return(t._MagickImage_Negate=t.asm.Gh).apply(null,arguments)},t._MagickImage_Normalize=function(){return(t._MagickImage_Normalize=t.asm.Hh).apply(null,arguments)},t._MagickImage_OilPaint=function(){return(t._MagickImage_OilPaint=t.asm.Ih).apply(null,arguments)},t._MagickImage_Opaque=function(){return(t._MagickImage_Opaque=t.asm.Jh).apply(null,arguments)},t._MagickImage_OrderedDither=function(){return(t._MagickImage_OrderedDither=t.asm.Kh).apply(null,arguments)},t._MagickImage_Perceptible=function(){return(t._MagickImage_Perceptible=t.asm.Lh).apply(null,arguments)},t._MagickImage_PerceptualHash=function(){return(t._MagickImage_PerceptualHash=t.asm.Mh).apply(null,arguments)},t._MagickImage_Quantize=function(){return(t._MagickImage_Quantize=t.asm.Nh).apply(null,arguments)},t._MagickImage_Polaroid=function(){return(t._MagickImage_Polaroid=t.asm.Oh).apply(null,arguments)},t._MagickImage_Posterize=function(){return(t._MagickImage_Posterize=t.asm.Ph).apply(null,arguments)},t._MagickImage_RaiseOrLower=function(){return(t._MagickImage_RaiseOrLower=t.asm.Qh).apply(null,arguments)},t._MagickImage_RandomThreshold=function(){return(t._MagickImage_RandomThreshold=t.asm.Rh).apply(null,arguments)},t._MagickImage_RangeThreshold=function(){return(t._MagickImage_RangeThreshold=t.asm.Sh).apply(null,arguments)},t._MagickImage_ReadBlob=function(){return(t._MagickImage_ReadBlob=t.asm.Th).apply(null,arguments)},t._MagickImage_ReadFile=function(){return(t._MagickImage_ReadFile=t.asm.Uh).apply(null,arguments)},t._MagickImage_ReadPixels=function(){return(t._MagickImage_ReadPixels=t.asm.Vh).apply(null,arguments)},t._MagickImage_ReadStream=function(){return(t._MagickImage_ReadStream=t.asm.Wh).apply(null,arguments)},t._MagickImage_RegionMask=function(){return(t._MagickImage_RegionMask=t.asm.Xh).apply(null,arguments)},t._MagickImage_RemoveArtifact=function(){return(t._MagickImage_RemoveArtifact=t.asm.Yh).apply(null,arguments)},t._MagickImage_RemoveAttribute=function(){return(t._MagickImage_RemoveAttribute=t.asm.Zh).apply(null,arguments)},t._MagickImage_RemoveProfile=function(){return(t._MagickImage_RemoveProfile=t.asm._h).apply(null,arguments)},t._MagickImage_ResetArtifactIterator=function(){return(t._MagickImage_ResetArtifactIterator=t.asm.$h).apply(null,arguments)},t._MagickImage_ResetAttributeIterator=function(){return(t._MagickImage_ResetAttributeIterator=t.asm.ai).apply(null,arguments)},t._MagickImage_ResetProfileIterator=function(){return(t._MagickImage_ResetProfileIterator=t.asm.bi).apply(null,arguments)},t._MagickImage_Resample=function(){return(t._MagickImage_Resample=t.asm.ci).apply(null,arguments)},t._MagickImage_Resize=function(){return(t._MagickImage_Resize=t.asm.di).apply(null,arguments)},t._MagickImage_Roll=function(){return(t._MagickImage_Roll=t.asm.ei).apply(null,arguments)},t._MagickImage_Rotate=function(){return(t._MagickImage_Rotate=t.asm.fi).apply(null,arguments)},t._MagickImage_RotationalBlur=function(){return(t._MagickImage_RotationalBlur=t.asm.gi).apply(null,arguments)},t._MagickImage_Sample=function(){return(t._MagickImage_Sample=t.asm.hi).apply(null,arguments)},t._MagickImage_Scale=function(){return(t._MagickImage_Scale=t.asm.ii).apply(null,arguments)},t._MagickImage_Segment=function(){return(t._MagickImage_Segment=t.asm.ji).apply(null,arguments)},t._MagickImage_SelectiveBlur=function(){return(t._MagickImage_SelectiveBlur=t.asm.ki).apply(null,arguments)},t._MagickImage_Separate=function(){return(t._MagickImage_Separate=t.asm.li).apply(null,arguments)},t._MagickImage_SepiaTone=function(){return(t._MagickImage_SepiaTone=t.asm.mi).apply(null,arguments)},t._MagickImage_SetAlpha=function(){return(t._MagickImage_SetAlpha=t.asm.ni).apply(null,arguments)},t._MagickImage_SetArtifact=function(){return(t._MagickImage_SetArtifact=t.asm.oi).apply(null,arguments)},t._MagickImage_SetAttribute=function(){return(t._MagickImage_SetAttribute=t.asm.pi).apply(null,arguments)},t._MagickImage_SetBitDepth=function(){return(t._MagickImage_SetBitDepth=t.asm.qi).apply(null,arguments)},t._MagickImage_SetColormapColor=function(){return(t._MagickImage_SetColormapColor=t.asm.ri).apply(null,arguments)},t._MagickImage_SetColorMetric=function(){return(t._MagickImage_SetColorMetric=t.asm.si).apply(null,arguments)},t._MagickImage_SetNext=function(){return(t._MagickImage_SetNext=t.asm.ti).apply(null,arguments)},t._MagickImage_SetProgressDelegate=function(){return(t._MagickImage_SetProgressDelegate=t.asm.ui).apply(null,arguments)},t._MagickImage_SetReadMask=function(){return(t._MagickImage_SetReadMask=t.asm.vi).apply(null,arguments)},t._MagickImage_SetWriteMask=function(){return(t._MagickImage_SetWriteMask=t.asm.wi).apply(null,arguments)},t._MagickImage_Shade=function(){return(t._MagickImage_Shade=t.asm.xi).apply(null,arguments)},t._MagickImage_Shadow=function(){return(t._MagickImage_Shadow=t.asm.yi).apply(null,arguments)},t._MagickImage_Sharpen=function(){return(t._MagickImage_Sharpen=t.asm.zi).apply(null,arguments)},t._MagickImage_Shave=function(){return(t._MagickImage_Shave=t.asm.Ai).apply(null,arguments)},t._MagickImage_Shear=function(){return(t._MagickImage_Shear=t.asm.Bi).apply(null,arguments)},t._MagickImage_SigmoidalContrast=function(){return(t._MagickImage_SigmoidalContrast=t.asm.Ci).apply(null,arguments)},t._MagickImage_SparseColor=function(){return(t._MagickImage_SparseColor=t.asm.Di).apply(null,arguments)},t._MagickImage_Spread=function(){return(t._MagickImage_Spread=t.asm.Ei).apply(null,arguments)},t._MagickImage_Sketch=function(){return(t._MagickImage_Sketch=t.asm.Fi).apply(null,arguments)},t._MagickImage_Solarize=function(){return(t._MagickImage_Solarize=t.asm.Gi).apply(null,arguments)},t._MagickImage_SortPixels=function(){return(t._MagickImage_SortPixels=t.asm.Hi).apply(null,arguments)},t._MagickImage_Splice=function(){return(t._MagickImage_Splice=t.asm.Ii).apply(null,arguments)},t._MagickImage_Statistic=function(){return(t._MagickImage_Statistic=t.asm.Ji).apply(null,arguments)},t._MagickImage_Statistics=function(){return(t._MagickImage_Statistics=t.asm.Ki).apply(null,arguments)},t._MagickImage_Stegano=function(){return(t._MagickImage_Stegano=t.asm.Li).apply(null,arguments)},t._MagickImage_Stereo=function(){return(t._MagickImage_Stereo=t.asm.Mi).apply(null,arguments)},t._MagickImage_Strip=function(){return(t._MagickImage_Strip=t.asm.Ni).apply(null,arguments)},t._MagickImage_SubImageSearch=function(){return(t._MagickImage_SubImageSearch=t.asm.Oi).apply(null,arguments)},t._MagickImage_Swirl=function(){return(t._MagickImage_Swirl=t.asm.Pi).apply(null,arguments)},t._MagickImage_Texture=function(){return(t._MagickImage_Texture=t.asm.Qi).apply(null,arguments)},t._MagickImage_Threshold=function(){return(t._MagickImage_Threshold=t.asm.Ri).apply(null,arguments)},t._MagickImage_Thumbnail=function(){return(t._MagickImage_Thumbnail=t.asm.Si).apply(null,arguments)},t._MagickImage_Tint=function(){return(t._MagickImage_Tint=t.asm.Ti).apply(null,arguments)},t._MagickImage_Transparent=function(){return(t._MagickImage_Transparent=t.asm.Ui).apply(null,arguments)},t._MagickImage_TransparentChroma=function(){return(t._MagickImage_TransparentChroma=t.asm.Vi).apply(null,arguments)},t._MagickImage_Transpose=function(){return(t._MagickImage_Transpose=t.asm.Wi).apply(null,arguments)},t._MagickImage_Transverse=function(){return(t._MagickImage_Transverse=t.asm.Xi).apply(null,arguments)},t._MagickImage_Trim=function(){return(t._MagickImage_Trim=t.asm.Yi).apply(null,arguments)},t._MagickImage_UniqueColors=function(){return(t._MagickImage_UniqueColors=t.asm.Zi).apply(null,arguments)},t._MagickImage_UnsharpMask=function(){return(t._MagickImage_UnsharpMask=t.asm._i).apply(null,arguments)},t._MagickImage_Vignette=function(){return(t._MagickImage_Vignette=t.asm.$i).apply(null,arguments)},t._MagickImage_Wave=function(){return(t._MagickImage_Wave=t.asm.aj).apply(null,arguments)},t._MagickImage_WaveletDenoise=function(){return(t._MagickImage_WaveletDenoise=t.asm.bj).apply(null,arguments)},t._MagickImage_WhiteBalance=function(){return(t._MagickImage_WhiteBalance=t.asm.cj).apply(null,arguments)},t._MagickImage_WhiteThreshold=function(){return(t._MagickImage_WhiteThreshold=t.asm.dj).apply(null,arguments)},t._MagickImage_WriteBlob=function(){return(t._MagickImage_WriteBlob=t.asm.ej).apply(null,arguments)},t._MagickImage_WriteFile=function(){return(t._MagickImage_WriteFile=t.asm.fj).apply(null,arguments)},t._MagickImage_WriteStream=function(){return(t._MagickImage_WriteStream=t.asm.gj).apply(null,arguments)},t._MagickImageCollection_Append=function(){return(t._MagickImageCollection_Append=t.asm.hj).apply(null,arguments)},t._MagickImageCollection_Coalesce=function(){return(t._MagickImageCollection_Coalesce=t.asm.ij).apply(null,arguments)},t._MagickImageCollection_Combine=function(){return(t._MagickImageCollection_Combine=t.asm.jj).apply(null,arguments)},t._MagickImageCollection_Complex=function(){return(t._MagickImageCollection_Complex=t.asm.kj).apply(null,arguments)},t._MagickImageCollection_Deconstruct=function(){return(t._MagickImageCollection_Deconstruct=t.asm.lj).apply(null,arguments)},t._MagickImageCollection_Dispose=function(){return(t._MagickImageCollection_Dispose=t.asm.mj).apply(null,arguments)},t._MagickImageCollection_Evaluate=function(){return(t._MagickImageCollection_Evaluate=t.asm.nj).apply(null,arguments)},t._MagickImageCollection_Fx=function(){return(t._MagickImageCollection_Fx=t.asm.oj).apply(null,arguments)},t._MagickImageCollection_Map=function(){return(t._MagickImageCollection_Map=t.asm.pj).apply(null,arguments)},t._MagickImageCollection_Merge=function(){return(t._MagickImageCollection_Merge=t.asm.qj).apply(null,arguments)},t._MagickImageCollection_Montage=function(){return(t._MagickImageCollection_Montage=t.asm.rj).apply(null,arguments)},t._MagickImageCollection_Morph=function(){return(t._MagickImageCollection_Morph=t.asm.sj).apply(null,arguments)},t._MagickImageCollection_Optimize=function(){return(t._MagickImageCollection_Optimize=t.asm.tj).apply(null,arguments)},t._MagickImageCollection_OptimizePlus=function(){return(t._MagickImageCollection_OptimizePlus=t.asm.uj).apply(null,arguments)},t._MagickImageCollection_OptimizeTransparency=function(){return(t._MagickImageCollection_OptimizeTransparency=t.asm.vj).apply(null,arguments)},t._MagickImageCollection_Polynomial=function(){return(t._MagickImageCollection_Polynomial=t.asm.wj).apply(null,arguments)},t._MagickImageCollection_Quantize=function(){return(t._MagickImageCollection_Quantize=t.asm.xj).apply(null,arguments)},t._MagickImageCollection_ReadBlob=function(){return(t._MagickImageCollection_ReadBlob=t.asm.yj).apply(null,arguments)},t._MagickImageCollection_ReadFile=function(){return(t._MagickImageCollection_ReadFile=t.asm.zj).apply(null,arguments)},t._MagickImageCollection_ReadStream=function(){return(t._MagickImageCollection_ReadStream=t.asm.Aj).apply(null,arguments)},t._MagickImageCollection_Smush=function(){return(t._MagickImageCollection_Smush=t.asm.Bj).apply(null,arguments)},t._MagickImageCollection_WriteFile=function(){return(t._MagickImageCollection_WriteFile=t.asm.Cj).apply(null,arguments)},t._MagickImageCollection_WriteStream=function(){return(t._MagickImageCollection_WriteStream=t.asm.Dj).apply(null,arguments)},t._DoubleMatrix_Create=function(){return(t._DoubleMatrix_Create=t.asm.Ej).apply(null,arguments)},t._DoubleMatrix_Dispose=function(){return(t._DoubleMatrix_Dispose=t.asm.Fj).apply(null,arguments)},t._OpenCL_GetDevices=function(){return(t._OpenCL_GetDevices=t.asm.Gj).apply(null,arguments)},t._OpenCL_GetDevice=function(){return(t._OpenCL_GetDevice=t.asm.Hj).apply(null,arguments)},t._OpenCL_GetEnabled=function(){return(t._OpenCL_GetEnabled=t.asm.Ij).apply(null,arguments)},t._OpenCL_SetEnabled=function(){return(t._OpenCL_SetEnabled=t.asm.Jj).apply(null,arguments)},t._OpenCLDevice_DeviceType_Get=function(){return(t._OpenCLDevice_DeviceType_Get=t.asm.Kj).apply(null,arguments)},t._OpenCLDevice_BenchmarkScore_Get=function(){return(t._OpenCLDevice_BenchmarkScore_Get=t.asm.Lj).apply(null,arguments)},t._OpenCLDevice_IsEnabled_Get=function(){return(t._OpenCLDevice_IsEnabled_Get=t.asm.Mj).apply(null,arguments)},t._OpenCLDevice_IsEnabled_Set=function(){return(t._OpenCLDevice_IsEnabled_Set=t.asm.Nj).apply(null,arguments)},t._OpenCLDevice_Name_Get=function(){return(t._OpenCLDevice_Name_Get=t.asm.Oj).apply(null,arguments)},t._OpenCLDevice_Version_Get=function(){return(t._OpenCLDevice_Version_Get=t.asm.Pj).apply(null,arguments)},t._OpenCLDevice_GetKernelProfileRecords=function(){return(t._OpenCLDevice_GetKernelProfileRecords=t.asm.Qj).apply(null,arguments)},t._OpenCLDevice_GetKernelProfileRecord=function(){return(t._OpenCLDevice_GetKernelProfileRecord=t.asm.Rj).apply(null,arguments)},t._OpenCLDevice_SetProfileKernels=function(){return(t._OpenCLDevice_SetProfileKernels=t.asm.Sj).apply(null,arguments)},t._OpenCLKernelProfileRecord_Count_Get=function(){return(t._OpenCLKernelProfileRecord_Count_Get=t.asm.Tj).apply(null,arguments)},t._OpenCLKernelProfileRecord_Name_Get=function(){return(t._OpenCLKernelProfileRecord_Name_Get=t.asm.Uj).apply(null,arguments)},t._OpenCLKernelProfileRecord_MaximumDuration_Get=function(){return(t._OpenCLKernelProfileRecord_MaximumDuration_Get=t.asm.Vj).apply(null,arguments)},t._OpenCLKernelProfileRecord_MinimumDuration_Get=function(){return(t._OpenCLKernelProfileRecord_MinimumDuration_Get=t.asm.Wj).apply(null,arguments)},t._OpenCLKernelProfileRecord_TotalDuration_Get=function(){return(t._OpenCLKernelProfileRecord_TotalDuration_Get=t.asm.Xj).apply(null,arguments)},t._JpegOptimizer_CompressFile=function(){return(t._JpegOptimizer_CompressFile=t.asm.Yj).apply(null,arguments)},t._JpegOptimizer_CompressStream=function(){return(t._JpegOptimizer_CompressStream=t.asm.Zj).apply(null,arguments)};var ye=t._malloc=function(){return(ye=t._malloc=t.asm._j).apply(null,arguments)},Se=t._free=function(){return(Se=t._free=t.asm.$j).apply(null,arguments)},nn=function(){return(nn=t.asm.ak).apply(null,arguments)};t._PixelCollection_Create=function(){return(t._PixelCollection_Create=t.asm.bk).apply(null,arguments)},t._PixelCollection_Dispose=function(){return(t._PixelCollection_Dispose=t.asm.ck).apply(null,arguments)},t._PixelCollection_GetArea=function(){return(t._PixelCollection_GetArea=t.asm.dk).apply(null,arguments)},t._PixelCollection_SetArea=function(){return(t._PixelCollection_SetArea=t.asm.ek).apply(null,arguments)},t._PixelCollection_ToByteArray=function(){return(t._PixelCollection_ToByteArray=t.asm.fk).apply(null,arguments)},t._PixelCollection_ToShortArray=function(){return(t._PixelCollection_ToShortArray=t.asm.gk).apply(null,arguments)},t._Quantum_Depth_Get=function(){return(t._Quantum_Depth_Get=t.asm.hk).apply(null,arguments)},t._Quantum_Max_Get=function(){return(t._Quantum_Max_Get=t.asm.ik).apply(null,arguments)},t._Quantum_ScaleToByte=function(){return(t._Quantum_ScaleToByte=t.asm.jk).apply(null,arguments)},t._ResourceLimits_Area_Get=function(){return(t._ResourceLimits_Area_Get=t.asm.kk).apply(null,arguments)},t._ResourceLimits_Area_Set=function(){return(t._ResourceLimits_Area_Set=t.asm.lk).apply(null,arguments)},t._ResourceLimits_Disk_Get=function(){return(t._ResourceLimits_Disk_Get=t.asm.mk).apply(null,arguments)},t._ResourceLimits_Disk_Set=function(){return(t._ResourceLimits_Disk_Set=t.asm.nk).apply(null,arguments)},t._ResourceLimits_Height_Get=function(){return(t._ResourceLimits_Height_Get=t.asm.ok).apply(null,arguments)},t._ResourceLimits_Height_Set=function(){return(t._ResourceLimits_Height_Set=t.asm.pk).apply(null,arguments)},t._ResourceLimits_ListLength_Get=function(){return(t._ResourceLimits_ListLength_Get=t.asm.qk).apply(null,arguments)},t._ResourceLimits_ListLength_Set=function(){return(t._ResourceLimits_ListLength_Set=t.asm.rk).apply(null,arguments)},t._ResourceLimits_MaxMemoryRequest_Get=function(){return(t._ResourceLimits_MaxMemoryRequest_Get=t.asm.sk).apply(null,arguments)},t._ResourceLimits_MaxMemoryRequest_Set=function(){return(t._ResourceLimits_MaxMemoryRequest_Set=t.asm.tk).apply(null,arguments)},t._ResourceLimits_Memory_Get=function(){return(t._ResourceLimits_Memory_Get=t.asm.uk).apply(null,arguments)},t._ResourceLimits_Memory_Set=function(){return(t._ResourceLimits_Memory_Set=t.asm.vk).apply(null,arguments)},t._ResourceLimits_Thread_Get=function(){return(t._ResourceLimits_Thread_Get=t.asm.wk).apply(null,arguments)},t._ResourceLimits_Thread_Set=function(){return(t._ResourceLimits_Thread_Set=t.asm.xk).apply(null,arguments)},t._ResourceLimits_Throttle_Get=function(){return(t._ResourceLimits_Throttle_Get=t.asm.yk).apply(null,arguments)},t._ResourceLimits_Throttle_Set=function(){return(t._ResourceLimits_Throttle_Set=t.asm.zk).apply(null,arguments)},t._ResourceLimits_Width_Get=function(){return(t._ResourceLimits_Width_Get=t.asm.Ak).apply(null,arguments)},t._ResourceLimits_Width_Set=function(){return(t._ResourceLimits_Width_Set=t.asm.Bk).apply(null,arguments)},t._ResourceLimits_LimitMemory=function(){return(t._ResourceLimits_LimitMemory=t.asm.Ck).apply(null,arguments)},t._DrawingSettings_Create=function(){return(t._DrawingSettings_Create=t.asm.Dk).apply(null,arguments)},t._DrawingSettings_Dispose=function(){return(t._DrawingSettings_Dispose=t.asm.Ek).apply(null,arguments)},t._DrawingSettings_BorderColor_Get=function(){return(t._DrawingSettings_BorderColor_Get=t.asm.Fk).apply(null,arguments)},t._DrawingSettings_BorderColor_Set=function(){return(t._DrawingSettings_BorderColor_Set=t.asm.Gk).apply(null,arguments)},t._DrawingSettings_FillColor_Get=function(){return(t._DrawingSettings_FillColor_Get=t.asm.Hk).apply(null,arguments)},t._DrawingSettings_FillColor_Set=function(){return(t._DrawingSettings_FillColor_Set=t.asm.Ik).apply(null,arguments)},t._DrawingSettings_FillRule_Get=function(){return(t._DrawingSettings_FillRule_Get=t.asm.Jk).apply(null,arguments)},t._DrawingSettings_FillRule_Set=function(){return(t._DrawingSettings_FillRule_Set=t.asm.Kk).apply(null,arguments)},t._DrawingSettings_Font_Get=function(){return(t._DrawingSettings_Font_Get=t.asm.Lk).apply(null,arguments)},t._DrawingSettings_Font_Set=function(){return(t._DrawingSettings_Font_Set=t.asm.Mk).apply(null,arguments)},t._DrawingSettings_FontFamily_Get=function(){return(t._DrawingSettings_FontFamily_Get=t.asm.Nk).apply(null,arguments)},t._DrawingSettings_FontFamily_Set=function(){return(t._DrawingSettings_FontFamily_Set=t.asm.Ok).apply(null,arguments)},t._DrawingSettings_FontPointsize_Get=function(){return(t._DrawingSettings_FontPointsize_Get=t.asm.Pk).apply(null,arguments)},t._DrawingSettings_FontPointsize_Set=function(){return(t._DrawingSettings_FontPointsize_Set=t.asm.Qk).apply(null,arguments)},t._DrawingSettings_FontStyle_Get=function(){return(t._DrawingSettings_FontStyle_Get=t.asm.Rk).apply(null,arguments)},t._DrawingSettings_FontStyle_Set=function(){return(t._DrawingSettings_FontStyle_Set=t.asm.Sk).apply(null,arguments)},t._DrawingSettings_FontWeight_Get=function(){return(t._DrawingSettings_FontWeight_Get=t.asm.Tk).apply(null,arguments)},t._DrawingSettings_FontWeight_Set=function(){return(t._DrawingSettings_FontWeight_Set=t.asm.Uk).apply(null,arguments)},t._DrawingSettings_StrokeAntiAlias_Get=function(){return(t._DrawingSettings_StrokeAntiAlias_Get=t.asm.Vk).apply(null,arguments)},t._DrawingSettings_StrokeAntiAlias_Set=function(){return(t._DrawingSettings_StrokeAntiAlias_Set=t.asm.Wk).apply(null,arguments)},t._DrawingSettings_StrokeColor_Get=function(){return(t._DrawingSettings_StrokeColor_Get=t.asm.Xk).apply(null,arguments)},t._DrawingSettings_StrokeColor_Set=function(){return(t._DrawingSettings_StrokeColor_Set=t.asm.Yk).apply(null,arguments)},t._DrawingSettings_StrokeDashOffset_Get=function(){return(t._DrawingSettings_StrokeDashOffset_Get=t.asm.Zk).apply(null,arguments)},t._DrawingSettings_StrokeDashOffset_Set=function(){return(t._DrawingSettings_StrokeDashOffset_Set=t.asm._k).apply(null,arguments)},t._DrawingSettings_StrokeLineCap_Get=function(){return(t._DrawingSettings_StrokeLineCap_Get=t.asm.$k).apply(null,arguments)},t._DrawingSettings_StrokeLineCap_Set=function(){return(t._DrawingSettings_StrokeLineCap_Set=t.asm.al).apply(null,arguments)},t._DrawingSettings_StrokeLineJoin_Get=function(){return(t._DrawingSettings_StrokeLineJoin_Get=t.asm.bl).apply(null,arguments)},t._DrawingSettings_StrokeLineJoin_Set=function(){return(t._DrawingSettings_StrokeLineJoin_Set=t.asm.cl).apply(null,arguments)},t._DrawingSettings_StrokeMiterLimit_Get=function(){return(t._DrawingSettings_StrokeMiterLimit_Get=t.asm.dl).apply(null,arguments)},t._DrawingSettings_StrokeMiterLimit_Set=function(){return(t._DrawingSettings_StrokeMiterLimit_Set=t.asm.el).apply(null,arguments)},t._DrawingSettings_StrokeWidth_Get=function(){return(t._DrawingSettings_StrokeWidth_Get=t.asm.fl).apply(null,arguments)},t._DrawingSettings_StrokeWidth_Set=function(){return(t._DrawingSettings_StrokeWidth_Set=t.asm.gl).apply(null,arguments)},t._DrawingSettings_TextAntiAlias_Get=function(){return(t._DrawingSettings_TextAntiAlias_Get=t.asm.hl).apply(null,arguments)},t._DrawingSettings_TextAntiAlias_Set=function(){return(t._DrawingSettings_TextAntiAlias_Set=t.asm.il).apply(null,arguments)},t._DrawingSettings_TextDirection_Get=function(){return(t._DrawingSettings_TextDirection_Get=t.asm.jl).apply(null,arguments)},t._DrawingSettings_TextDirection_Set=function(){return(t._DrawingSettings_TextDirection_Set=t.asm.kl).apply(null,arguments)},t._DrawingSettings_TextEncoding_Get=function(){return(t._DrawingSettings_TextEncoding_Get=t.asm.ll).apply(null,arguments)},t._DrawingSettings_TextEncoding_Set=function(){return(t._DrawingSettings_TextEncoding_Set=t.asm.ml).apply(null,arguments)},t._DrawingSettings_TextGravity_Get=function(){return(t._DrawingSettings_TextGravity_Get=t.asm.nl).apply(null,arguments)},t._DrawingSettings_TextGravity_Set=function(){return(t._DrawingSettings_TextGravity_Set=t.asm.ol).apply(null,arguments)},t._DrawingSettings_TextInterlineSpacing_Get=function(){return(t._DrawingSettings_TextInterlineSpacing_Get=t.asm.pl).apply(null,arguments)},t._DrawingSettings_TextInterlineSpacing_Set=function(){return(t._DrawingSettings_TextInterlineSpacing_Set=t.asm.ql).apply(null,arguments)},t._DrawingSettings_TextInterwordSpacing_Get=function(){return(t._DrawingSettings_TextInterwordSpacing_Get=t.asm.rl).apply(null,arguments)},t._DrawingSettings_TextInterwordSpacing_Set=function(){return(t._DrawingSettings_TextInterwordSpacing_Set=t.asm.sl).apply(null,arguments)},t._DrawingSettings_TextKerning_Get=function(){return(t._DrawingSettings_TextKerning_Get=t.asm.tl).apply(null,arguments)},t._DrawingSettings_TextKerning_Set=function(){return(t._DrawingSettings_TextKerning_Set=t.asm.ul).apply(null,arguments)},t._DrawingSettings_TextUnderColor_Get=function(){return(t._DrawingSettings_TextUnderColor_Get=t.asm.vl).apply(null,arguments)},t._DrawingSettings_TextUnderColor_Set=function(){return(t._DrawingSettings_TextUnderColor_Set=t.asm.wl).apply(null,arguments)},t._DrawingSettings_SetAffine=function(){return(t._DrawingSettings_SetAffine=t.asm.xl).apply(null,arguments)},t._DrawingSettings_SetFillPattern=function(){return(t._DrawingSettings_SetFillPattern=t.asm.yl).apply(null,arguments)},t._DrawingSettings_SetStrokeDashArray=function(){return(t._DrawingSettings_SetStrokeDashArray=t.asm.zl).apply(null,arguments)},t._DrawingSettings_SetStrokePattern=function(){return(t._DrawingSettings_SetStrokePattern=t.asm.Al).apply(null,arguments)},t._DrawingSettings_SetText=function(){return(t._DrawingSettings_SetText=t.asm.Bl).apply(null,arguments)},t._MagickSettings_Create=function(){return(t._MagickSettings_Create=t.asm.Cl).apply(null,arguments)},t._MagickSettings_Dispose=function(){return(t._MagickSettings_Dispose=t.asm.Dl).apply(null,arguments)},t._MagickSettings_AntiAlias_Get=function(){return(t._MagickSettings_AntiAlias_Get=t.asm.El).apply(null,arguments)},t._MagickSettings_AntiAlias_Set=function(){return(t._MagickSettings_AntiAlias_Set=t.asm.Fl).apply(null,arguments)},t._MagickSettings_BackgroundColor_Get=function(){return(t._MagickSettings_BackgroundColor_Get=t.asm.Gl).apply(null,arguments)},t._MagickSettings_BackgroundColor_Set=function(){return(t._MagickSettings_BackgroundColor_Set=t.asm.Hl).apply(null,arguments)},t._MagickSettings_ColorSpace_Get=function(){return(t._MagickSettings_ColorSpace_Get=t.asm.Il).apply(null,arguments)},t._MagickSettings_ColorSpace_Set=function(){return(t._MagickSettings_ColorSpace_Set=t.asm.Jl).apply(null,arguments)},t._MagickSettings_ColorType_Get=function(){return(t._MagickSettings_ColorType_Get=t.asm.Kl).apply(null,arguments)},t._MagickSettings_ColorType_Set=function(){return(t._MagickSettings_ColorType_Set=t.asm.Ll).apply(null,arguments)},t._MagickSettings_Compression_Get=function(){return(t._MagickSettings_Compression_Get=t.asm.Ml).apply(null,arguments)},t._MagickSettings_Compression_Set=function(){return(t._MagickSettings_Compression_Set=t.asm.Nl).apply(null,arguments)},t._MagickSettings_Debug_Get=function(){return(t._MagickSettings_Debug_Get=t.asm.Ol).apply(null,arguments)},t._MagickSettings_Debug_Set=function(){return(t._MagickSettings_Debug_Set=t.asm.Pl).apply(null,arguments)},t._MagickSettings_Density_Get=function(){return(t._MagickSettings_Density_Get=t.asm.Ql).apply(null,arguments)},t._MagickSettings_Density_Set=function(){return(t._MagickSettings_Density_Set=t.asm.Rl).apply(null,arguments)},t._MagickSettings_Depth_Get=function(){return(t._MagickSettings_Depth_Get=t.asm.Sl).apply(null,arguments)},t._MagickSettings_Depth_Set=function(){return(t._MagickSettings_Depth_Set=t.asm.Tl).apply(null,arguments)},t._MagickSettings_Endian_Get=function(){return(t._MagickSettings_Endian_Get=t.asm.Ul).apply(null,arguments)},t._MagickSettings_Endian_Set=function(){return(t._MagickSettings_Endian_Set=t.asm.Vl).apply(null,arguments)},t._MagickSettings_Extract_Get=function(){return(t._MagickSettings_Extract_Get=t.asm.Wl).apply(null,arguments)},t._MagickSettings_Extract_Set=function(){return(t._MagickSettings_Extract_Set=t.asm.Xl).apply(null,arguments)},t._MagickSettings_Format_Get=function(){return(t._MagickSettings_Format_Get=t.asm.Yl).apply(null,arguments)},t._MagickSettings_Format_Set=function(){return(t._MagickSettings_Format_Set=t.asm.Zl).apply(null,arguments)},t._MagickSettings_Font_Get=function(){return(t._MagickSettings_Font_Get=t.asm._l).apply(null,arguments)},t._MagickSettings_Font_Set=function(){return(t._MagickSettings_Font_Set=t.asm.$l).apply(null,arguments)},t._MagickSettings_FontPointsize_Get=function(){return(t._MagickSettings_FontPointsize_Get=t.asm.am).apply(null,arguments)},t._MagickSettings_FontPointsize_Set=function(){return(t._MagickSettings_FontPointsize_Set=t.asm.bm).apply(null,arguments)},t._MagickSettings_Interlace_Get=function(){return(t._MagickSettings_Interlace_Get=t.asm.cm).apply(null,arguments)},t._MagickSettings_Interlace_Set=function(){return(t._MagickSettings_Interlace_Set=t.asm.dm).apply(null,arguments)},t._MagickSettings_Monochrome_Get=function(){return(t._MagickSettings_Monochrome_Get=t.asm.em).apply(null,arguments)},t._MagickSettings_Monochrome_Set=function(){return(t._MagickSettings_Monochrome_Set=t.asm.fm).apply(null,arguments)},t._MagickSettings_Verbose_Get=function(){return(t._MagickSettings_Verbose_Get=t.asm.gm).apply(null,arguments)},t._MagickSettings_Verbose_Set=function(){return(t._MagickSettings_Verbose_Set=t.asm.hm).apply(null,arguments)},t._MagickSettings_SetColorFuzz=function(){return(t._MagickSettings_SetColorFuzz=t.asm.im).apply(null,arguments)},t._MagickSettings_SetFileName=function(){return(t._MagickSettings_SetFileName=t.asm.jm).apply(null,arguments)},t._MagickSettings_SetNumberScenes=function(){return(t._MagickSettings_SetNumberScenes=t.asm.km).apply(null,arguments)},t._MagickSettings_SetOption=function(){return(t._MagickSettings_SetOption=t.asm.lm).apply(null,arguments)},t._MagickSettings_SetPage=function(){return(t._MagickSettings_SetPage=t.asm.mm).apply(null,arguments)},t._MagickSettings_SetPing=function(){return(t._MagickSettings_SetPing=t.asm.nm).apply(null,arguments)},t._MagickSettings_SetQuality=function(){return(t._MagickSettings_SetQuality=t.asm.om).apply(null,arguments)},t._MagickSettings_SetScenes=function(){return(t._MagickSettings_SetScenes=t.asm.pm).apply(null,arguments)},t._MagickSettings_SetScene=function(){return(t._MagickSettings_SetScene=t.asm.qm).apply(null,arguments)},t._MagickSettings_SetSize=function(){return(t._MagickSettings_SetSize=t.asm.rm).apply(null,arguments)},t._MontageSettings_Create=function(){return(t._MontageSettings_Create=t.asm.sm).apply(null,arguments)},t._MontageSettings_Dispose=function(){return(t._MontageSettings_Dispose=t.asm.tm).apply(null,arguments)},t._MontageSettings_SetBackgroundColor=function(){return(t._MontageSettings_SetBackgroundColor=t.asm.um).apply(null,arguments)},t._MontageSettings_SetBorderColor=function(){return(t._MontageSettings_SetBorderColor=t.asm.vm).apply(null,arguments)},t._MontageSettings_SetBorderWidth=function(){return(t._MontageSettings_SetBorderWidth=t.asm.wm).apply(null,arguments)},t._MontageSettings_SetFillColor=function(){return(t._MontageSettings_SetFillColor=t.asm.xm).apply(null,arguments)},t._MontageSettings_SetFont=function(){return(t._MontageSettings_SetFont=t.asm.ym).apply(null,arguments)},t._MontageSettings_SetFontPointsize=function(){return(t._MontageSettings_SetFontPointsize=t.asm.zm).apply(null,arguments)},t._MontageSettings_SetFrameGeometry=function(){return(t._MontageSettings_SetFrameGeometry=t.asm.Am).apply(null,arguments)},t._MontageSettings_SetGeometry=function(){return(t._MontageSettings_SetGeometry=t.asm.Bm).apply(null,arguments)},t._MontageSettings_SetGravity=function(){return(t._MontageSettings_SetGravity=t.asm.Cm).apply(null,arguments)},t._MontageSettings_SetShadow=function(){return(t._MontageSettings_SetShadow=t.asm.Dm).apply(null,arguments)},t._MontageSettings_SetStrokeColor=function(){return(t._MontageSettings_SetStrokeColor=t.asm.Em).apply(null,arguments)},t._MontageSettings_SetTextureFileName=function(){return(t._MontageSettings_SetTextureFileName=t.asm.Fm).apply(null,arguments)},t._MontageSettings_SetTileGeometry=function(){return(t._MontageSettings_SetTileGeometry=t.asm.Gm).apply(null,arguments)},t._MontageSettings_SetTitle=function(){return(t._MontageSettings_SetTitle=t.asm.Hm).apply(null,arguments)},t._QuantizeSettings_SetColors=function(){return(t._QuantizeSettings_SetColors=t.asm.Im).apply(null,arguments)},t._QuantizeSettings_SetColorSpace=function(){return(t._QuantizeSettings_SetColorSpace=t.asm.Jm).apply(null,arguments)},t._QuantizeSettings_SetDitherMethod=function(){return(t._QuantizeSettings_SetDitherMethod=t.asm.Km).apply(null,arguments)},t._QuantizeSettings_SetMeasureErrors=function(){return(t._QuantizeSettings_SetMeasureErrors=t.asm.Lm).apply(null,arguments)},t._QuantizeSettings_SetTreeDepth=function(){return(t._QuantizeSettings_SetTreeDepth=t.asm.Mm).apply(null,arguments)},t._ChannelMoments_Centroid_Get=function(){return(t._ChannelMoments_Centroid_Get=t.asm.Nm).apply(null,arguments)},t._ChannelMoments_EllipseAngle_Get=function(){return(t._ChannelMoments_EllipseAngle_Get=t.asm.Om).apply(null,arguments)},t._ChannelMoments_EllipseAxis_Get=function(){return(t._ChannelMoments_EllipseAxis_Get=t.asm.Pm).apply(null,arguments)},t._ChannelMoments_EllipseEccentricity_Get=function(){return(t._ChannelMoments_EllipseEccentricity_Get=t.asm.Qm).apply(null,arguments)},t._ChannelMoments_EllipseIntensity_Get=function(){return(t._ChannelMoments_EllipseIntensity_Get=t.asm.Rm).apply(null,arguments)},t._ChannelMoments_GetHuInvariants=function(){return(t._ChannelMoments_GetHuInvariants=t.asm.Sm).apply(null,arguments)},t._ChannelPerceptualHash_GetHclpHuPhash=function(){return(t._ChannelPerceptualHash_GetHclpHuPhash=t.asm.Tm).apply(null,arguments)},t._ChannelPerceptualHash_GetSrgbHuPhash=function(){return(t._ChannelPerceptualHash_GetSrgbHuPhash=t.asm.Um).apply(null,arguments)},t._ChannelStatistics_Depth_Get=function(){return(t._ChannelStatistics_Depth_Get=t.asm.Vm).apply(null,arguments)},t._ChannelStatistics_Entropy_Get=function(){return(t._ChannelStatistics_Entropy_Get=t.asm.Wm).apply(null,arguments)},t._ChannelStatistics_Kurtosis_Get=function(){return(t._ChannelStatistics_Kurtosis_Get=t.asm.Xm).apply(null,arguments)},t._ChannelStatistics_Maximum_Get=function(){return(t._ChannelStatistics_Maximum_Get=t.asm.Ym).apply(null,arguments)},t._ChannelStatistics_Mean_Get=function(){return(t._ChannelStatistics_Mean_Get=t.asm.Zm).apply(null,arguments)},t._ChannelStatistics_Minimum_Get=function(){return(t._ChannelStatistics_Minimum_Get=t.asm._m).apply(null,arguments)},t._ChannelStatistics_Skewness_Get=function(){return(t._ChannelStatistics_Skewness_Get=t.asm.$m).apply(null,arguments)},t._ChannelStatistics_StandardDeviation_Get=function(){return(t._ChannelStatistics_StandardDeviation_Get=t.asm.an).apply(null,arguments)},t._Moments_DisposeList=function(){return(t._Moments_DisposeList=t.asm.bn).apply(null,arguments)},t._Moments_GetInstance=function(){return(t._Moments_GetInstance=t.asm.cn).apply(null,arguments)},t._PerceptualHash_DisposeList=function(){return(t._PerceptualHash_DisposeList=t.asm.dn).apply(null,arguments)},t._PerceptualHash_GetInstance=function(){return(t._PerceptualHash_GetInstance=t.asm.en).apply(null,arguments)},t._Statistics_DisposeList=function(){return(t._Statistics_DisposeList=t.asm.fn).apply(null,arguments)},t._Statistics_GetInstance=function(){return(t._Statistics_GetInstance=t.asm.gn).apply(null,arguments)},t._ConnectedComponent_DisposeList=function(){return(t._ConnectedComponent_DisposeList=t.asm.hn).apply(null,arguments)},t._ConnectedComponent_GetArea=function(){return(t._ConnectedComponent_GetArea=t.asm.jn).apply(null,arguments)},t._ConnectedComponent_GetCentroid=function(){return(t._ConnectedComponent_GetCentroid=t.asm.kn).apply(null,arguments)},t._ConnectedComponent_GetColor=function(){return(t._ConnectedComponent_GetColor=t.asm.ln).apply(null,arguments)},t._ConnectedComponent_GetHeight=function(){return(t._ConnectedComponent_GetHeight=t.asm.mn).apply(null,arguments)},t._ConnectedComponent_GetId=function(){return(t._ConnectedComponent_GetId=t.asm.nn).apply(null,arguments)},t._ConnectedComponent_GetWidth=function(){return(t._ConnectedComponent_GetWidth=t.asm.on).apply(null,arguments)},t._ConnectedComponent_GetX=function(){return(t._ConnectedComponent_GetX=t.asm.pn).apply(null,arguments)},t._ConnectedComponent_GetY=function(){return(t._ConnectedComponent_GetY=t.asm.qn).apply(null,arguments)},t._ConnectedComponent_GetInstance=function(){return(t._ConnectedComponent_GetInstance=t.asm.rn).apply(null,arguments)},t._MagickGeometry_Create=function(){return(t._MagickGeometry_Create=t.asm.sn).apply(null,arguments)},t._MagickGeometry_Dispose=function(){return(t._MagickGeometry_Dispose=t.asm.tn).apply(null,arguments)},t._MagickGeometry_X_Get=function(){return(t._MagickGeometry_X_Get=t.asm.un).apply(null,arguments)},t._MagickGeometry_Y_Get=function(){return(t._MagickGeometry_Y_Get=t.asm.vn).apply(null,arguments)},t._MagickGeometry_Width_Get=function(){return(t._MagickGeometry_Width_Get=t.asm.wn).apply(null,arguments)},t._MagickGeometry_Height_Get=function(){return(t._MagickGeometry_Height_Get=t.asm.xn).apply(null,arguments)},t._MagickGeometry_Initialize=function(){return(t._MagickGeometry_Initialize=t.asm.yn).apply(null,arguments)},t._MagickRectangle_Dispose=function(){return(t._MagickRectangle_Dispose=t.asm.zn).apply(null,arguments)},t._MagickRectangle_X_Get=function(){return(t._MagickRectangle_X_Get=t.asm.An).apply(null,arguments)},t._MagickRectangle_X_Set=function(){return(t._MagickRectangle_X_Set=t.asm.Bn).apply(null,arguments)},t._MagickRectangle_Y_Get=function(){return(t._MagickRectangle_Y_Get=t.asm.Cn).apply(null,arguments)},t._MagickRectangle_Y_Set=function(){return(t._MagickRectangle_Y_Set=t.asm.Dn).apply(null,arguments)},t._MagickRectangle_Width_Get=function(){return(t._MagickRectangle_Width_Get=t.asm.En).apply(null,arguments)},t._MagickRectangle_Width_Set=function(){return(t._MagickRectangle_Width_Set=t.asm.Fn).apply(null,arguments)},t._MagickRectangle_Height_Get=function(){return(t._MagickRectangle_Height_Get=t.asm.Gn).apply(null,arguments)},t._MagickRectangle_Height_Set=function(){return(t._MagickRectangle_Height_Set=t.asm.Hn).apply(null,arguments)},t._MagickRectangle_FromPageSize=function(){return(t._MagickRectangle_FromPageSize=t.asm.In).apply(null,arguments)},t._OffsetInfo_Create=function(){return(t._OffsetInfo_Create=t.asm.Jn).apply(null,arguments)},t._OffsetInfo_Dispose=function(){return(t._OffsetInfo_Dispose=t.asm.Kn).apply(null,arguments)},t._OffsetInfo_SetX=function(){return(t._OffsetInfo_SetX=t.asm.Ln).apply(null,arguments)},t._OffsetInfo_SetY=function(){return(t._OffsetInfo_SetY=t.asm.Mn).apply(null,arguments)},t._PointInfo_X_Get=function(){return(t._PointInfo_X_Get=t.asm.Nn).apply(null,arguments)},t._PointInfo_Y_Get=function(){return(t._PointInfo_Y_Get=t.asm.On).apply(null,arguments)},t._PrimaryInfo_Dispose=function(){return(t._PrimaryInfo_Dispose=t.asm.Pn).apply(null,arguments)},t._PrimaryInfo_X_Get=function(){return(t._PrimaryInfo_X_Get=t.asm.Qn).apply(null,arguments)},t._PrimaryInfo_X_Set=function(){return(t._PrimaryInfo_X_Set=t.asm.Rn).apply(null,arguments)},t._PrimaryInfo_Y_Get=function(){return(t._PrimaryInfo_Y_Get=t.asm.Sn).apply(null,arguments)},t._PrimaryInfo_Y_Set=function(){return(t._PrimaryInfo_Y_Set=t.asm.Tn).apply(null,arguments)},t._PrimaryInfo_Z_Get=function(){return(t._PrimaryInfo_Z_Get=t.asm.Un).apply(null,arguments)},t._PrimaryInfo_Z_Set=function(){return(t._PrimaryInfo_Z_Set=t.asm.Vn).apply(null,arguments)},t._StringInfo_Length_Get=function(){return(t._StringInfo_Length_Get=t.asm.Wn).apply(null,arguments)},t._StringInfo_Datum_Get=function(){return(t._StringInfo_Datum_Get=t.asm.Xn).apply(null,arguments)},t._TypeMetric_Dispose=function(){return(t._TypeMetric_Dispose=t.asm.Yn).apply(null,arguments)},t._TypeMetric_Ascent_Get=function(){return(t._TypeMetric_Ascent_Get=t.asm.Zn).apply(null,arguments)},t._TypeMetric_Descent_Get=function(){return(t._TypeMetric_Descent_Get=t.asm._n).apply(null,arguments)},t._TypeMetric_MaxHorizontalAdvance_Get=function(){return(t._TypeMetric_MaxHorizontalAdvance_Get=t.asm.$n).apply(null,arguments)},t._TypeMetric_TextHeight_Get=function(){return(t._TypeMetric_TextHeight_Get=t.asm.ao).apply(null,arguments)},t._TypeMetric_TextWidth_Get=function(){return(t._TypeMetric_TextWidth_Get=t.asm.bo).apply(null,arguments)},t._TypeMetric_UnderlinePosition_Get=function(){return(t._TypeMetric_UnderlinePosition_Get=t.asm.co).apply(null,arguments)},t._TypeMetric_UnderlineThickness_Get=function(){return(t._TypeMetric_UnderlineThickness_Get=t.asm.eo).apply(null,arguments)};var Ui=function(){return(Ui=t.asm.fo).apply(null,arguments)},yn=function(){return(yn=t.asm.go).apply(null,arguments)},ni=function(){return(ni=t.asm.ho).apply(null,arguments)},Sn=function(){return(Sn=t.asm.io).apply(null,arguments)},Vi=t.___getTypeName=function(){return(Vi=t.___getTypeName=t.asm.jo).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.ko).apply(null,arguments)};var $i=function(){return($i=t.asm.lo).apply(null,arguments)},qi=function(){return(qi=t.asm.mo).apply(null,arguments)},Bt=function(){return(Bt=t.asm.no).apply(null,arguments)},jt=function(){return(jt=t.asm.oo).apply(null,arguments)},Wt=function(){return(Wt=t.asm.po).apply(null,arguments)},Ki=function(){return(Ki=t.asm.qo).apply(null,arguments)},Qi=function(){return(Qi=t.asm.ro).apply(null,arguments)},Ji=t.dynCall_ji=function(){return(Ji=t.dynCall_ji=t.asm.so).apply(null,arguments)},Zi=t.dynCall_iiijj=function(){return(Zi=t.dynCall_iiijj=t.asm.to).apply(null,arguments)},tr=t.dynCall_iij=function(){return(tr=t.dynCall_iij=t.asm.uo).apply(null,arguments)},er=t.dynCall_vij=function(){return(er=t.dynCall_vij=t.asm.vo).apply(null,arguments)};t.dynCall_iji=function(){return(t.dynCall_iji=t.asm.wo).apply(null,arguments)},t.dynCall_jji=function(){return(t.dynCall_jji=t.asm.xo).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.yo).apply(null,arguments)},t.dynCall_viij=function(){return(t.dynCall_viij=t.asm.zo).apply(null,arguments)},t.dynCall_jjii=function(){return(t.dynCall_jjii=t.asm.Ao).apply(null,arguments)},t.dynCall_iiji=function(){return(t.dynCall_iiji=t.asm.Bo).apply(null,arguments)},t.dynCall_jiiiii=function(){return(t.dynCall_jiiiii=t.asm.Co).apply(null,arguments)};var nr=t.dynCall_iiiijj=function(){return(nr=t.dynCall_iiiijj=t.asm.Do).apply(null,arguments)},ir=t.dynCall_ij=function(){return(ir=t.dynCall_ij=t.asm.Eo).apply(null,arguments)};t.dynCall_iiijii=function(){return(t.dynCall_iiijii=t.asm.Fo).apply(null,arguments)},t.dynCall_jiiiiiiiii=function(){return(t.dynCall_jiiiiiiiii=t.asm.Go).apply(null,arguments)},t.dynCall_jiiiiii=function(){return(t.dynCall_jiiiiii=t.asm.Ho).apply(null,arguments)},t.dynCall_jiiiiiiii=function(){return(t.dynCall_jiiiiiiii=t.asm.Io).apply(null,arguments)},t.dynCall_viijii=function(){return(t.dynCall_viijii=t.asm.Jo).apply(null,arguments)},t.dynCall_iiiiij=function(){return(t.dynCall_iiiiij=t.asm.Ko).apply(null,arguments)},t.dynCall_iiiiijj=function(){return(t.dynCall_iiiiijj=t.asm.Lo).apply(null,arguments)},t.dynCall_iiiiiijj=function(){return(t.dynCall_iiiiiijj=t.asm.Mo).apply(null,arguments)},t.___emscripten_embedded_file_data=4501376;function lo(i,l,d,y){var w=jt();try{Ht(i)(l,d,y)}catch(M){if(Wt(w),M!==M+0)throw M;Bt(1,0)}}function uo(i,l,d,y){var w=jt();try{return Ht(i)(l,d,y)}catch(M){if(Wt(w),M!==M+0)throw M;Bt(1,0)}}function co(i,l,d){var y=jt();try{return Ht(i)(l,d)}catch(w){if(Wt(y),w!==w+0)throw w;Bt(1,0)}}function ho(i,l){var d=jt();try{return Ht(i)(l)}catch(y){if(Wt(d),y!==y+0)throw y;Bt(1,0)}}function fo(i,l){var d=jt();try{Ht(i)(l)}catch(y){if(Wt(d),y!==y+0)throw y;Bt(1,0)}}function go(i,l,d){var y=jt();try{Ht(i)(l,d)}catch(w){if(Wt(y),w!==w+0)throw w;Bt(1,0)}}function _o(i,l,d,y,w){var M=jt();try{Ht(i)(l,d,y,w)}catch(T){if(Wt(M),T!==T+0)throw T;Bt(1,0)}}function mo(i){var l=jt();try{return Ht(i)()}catch(d){if(Wt(l),d!==d+0)throw d;Bt(1,0)}}function po(i,l,d,y,w,M,T){var E=jt();try{return Ht(i)(l,d,y,w,M,T)}catch(L){if(Wt(E),L!==L+0)throw L;Bt(1,0)}}function vo(i,l,d,y,w){var M=jt();try{return Ht(i)(l,d,y,w)}catch(T){if(Wt(M),T!==T+0)throw T;Bt(1,0)}}function yo(i,l,d,y,w,M,T,E,L){var H=jt();try{return Ht(i)(l,d,y,w,M,T,E,L)}catch(et){if(Wt(H),et!==et+0)throw et;Bt(1,0)}}function So(i,l,d,y,w,M){var T=jt();try{return Ht(i)(l,d,y,w,M)}catch(E){if(Wt(T),E!==E+0)throw E;Bt(1,0)}}function Co(i,l,d){var y=jt();try{return Ht(i)(l,d)}catch(w){if(Wt(y),w!==w+0)throw w;Bt(1,0)}}function wo(i){var l=jt();try{Ht(i)()}catch(d){if(Wt(l),d!==d+0)throw d;Bt(1,0)}}function ko(i,l,d,y,w,M){var T=jt();try{Ht(i)(l,d,y,w,M)}catch(E){if(Wt(T),E!==E+0)throw E;Bt(1,0)}}function bo(i,l,d,y,w,M,T,E){var L=jt();try{return Ht(i)(l,d,y,w,M,T,E)}catch(H){if(Wt(L),H!==H+0)throw H;Bt(1,0)}}function Mo(i,l,d,y,w,M,T,E,L,H){var et=jt();try{return Ht(i)(l,d,y,w,M,T,E,L,H)}catch(pt){if(Wt(et),pt!==pt+0)throw pt;Bt(1,0)}}function xo(i,l,d,y){var w=jt();try{Ht(i)(l,d,y)}catch(M){if(Wt(w),M!==M+0)throw M;Bt(1,0)}}function To(i,l,d,y,w,M,T,E,L,H,et){var pt=jt();try{Ht(i)(l,d,y,w,M,T,E,L,H,et)}catch(ot){if(Wt(pt),ot!==ot+0)throw ot;Bt(1,0)}}function Io(i,l,d,y,w,M,T,E,L,H){var et=jt();try{Ht(i)(l,d,y,w,M,T,E,L,H)}catch(pt){if(Wt(et),pt!==pt+0)throw pt;Bt(1,0)}}function Po(i,l,d,y,w,M,T){var E=jt();try{Ht(i)(l,d,y,w,M,T)}catch(L){if(Wt(E),L!==L+0)throw L;Bt(1,0)}}function Eo(i,l,d,y,w,M,T,E){var L=jt();try{Ht(i)(l,d,y,w,M,T,E)}catch(H){if(Wt(L),H!==H+0)throw H;Bt(1,0)}}function Do(i,l,d,y,w,M,T,E,L,H,et,pt){var ot=jt();try{return Ht(i)(l,d,y,w,M,T,E,L,H,et,pt)}catch(Ct){if(Wt(ot),Ct!==Ct+0)throw Ct;Bt(1,0)}}function Oo(i,l){var d=jt();try{return Ji(i,l)}catch(y){if(Wt(d),y!==y+0)throw y;Bt(1,0)}}function Ao(i,l,d,y,w,M,T){var E=jt();try{return Zi(i,l,d,y,w,M,T)}catch(L){if(Wt(E),L!==L+0)throw L;Bt(1,0)}}function Fo(i,l,d,y){var w=jt();try{return tr(i,l,d,y)}catch(M){if(Wt(w),M!==M+0)throw M;Bt(1,0)}}function Ro(i,l,d,y){var w=jt();try{er(i,l,d,y)}catch(M){if(Wt(w),M!==M+0)throw M;Bt(1,0)}}function Lo(i,l,d,y,w,M,T,E){var L=jt();try{return nr(i,l,d,y,w,M,T,E)}catch(H){if(Wt(L),H!==H+0)throw H;Bt(1,0)}}function Go(i,l,d){var y=jt();try{return ir(i,l,d)}catch(w){if(Wt(y),w!==w+0)throw w;Bt(1,0)}}t.addRunDependency=nt,t.removeRunDependency=q,t.FS_createPath=b.createPath,t.FS_createDataFile=b.createDataFile,t.FS_createPreloadedFile=b.createPreloadedFile,t.FS_createLazyFile=b.createLazyFile,t.FS_createDevice=b.createDevice,t.FS_unlink=b.unlink,t.setValue=Bn,t.getValue=ne,t.UTF8ToString=ue,t.stringToUTF8=ze,t.lengthBytesUTF8=Ie,t.FS=b;var Cn;tt=function i(){Cn||rr(),Cn||(tt=i)};function rr(){if(X>0||(Z(),X>0))return;function i(){Cn||(Cn=!0,t.calledRun=!0,!at&&($(),W(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),st()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),i()},1)):i()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return rr(),I.ready}})();m.exports=v})(Sr);var Zo=Sr.exports;const tl=Jo(Zo);var ee=(m=>(m[m.Undefined=0]="Undefined",m[m.Red=1]="Red",m[m.Gray=1]="Gray",m[m.Cyan=1]="Cyan",m[m.Green=2]="Green",m[m.Magenta=2]="Magenta",m[m.Blue=4]="Blue",m[m.Yellow=4]="Yellow",m[m.Black=8]="Black",m[m.Alpha=16]="Alpha",m[m.Opacity=16]="Opacity",m[m.Index=32]="Index",m[m.Composite=31]="Composite",m[m.All=134217727]="All",m[m.TrueAlpha=256]="TrueAlpha",m[m.RGB=7]="RGB",m[m.CMYK=15]="CMYK",m[m.Grays=1024]="Grays",m[m.Sync=131072]="Sync",m[m.Default=134217727]="Default",m))(ee||{});class el{constructor(u,v,k,I){mt(this,"red");mt(this,"green");mt(this,"blue");mt(this,"white");this.red=u,this.green=v,this.blue=k,this.white=I}}var Cr=(m=>(m[m.Undefined=0]="Undefined",m[m.CMY=1]="CMY",m[m.CMYK=2]="CMYK",m[m.Gray=3]="Gray",m[m.HCL=4]="HCL",m[m.HCLp=5]="HCLp",m[m.HSB=6]="HSB",m[m.HSI=7]="HSI",m[m.HSL=8]="HSL",m[m.HSV=9]="HSV",m[m.HWB=10]="HWB",m[m.Lab=11]="Lab",m[m.LCH=12]="LCH",m[m.LCHab=13]="LCHab",m[m.LCHuv=14]="LCHuv",m[m.Log=15]="Log",m[m.LMS=16]="LMS",m[m.Luv=17]="Luv",m[m.OHTA=18]="OHTA",m[m.Rec601YCbCr=19]="Rec601YCbCr",m[m.Rec709YCbCr=20]="Rec709YCbCr",m[m.RGB=21]="RGB",m[m.scRGB=22]="scRGB",m[m.sRGB=23]="sRGB",m[m.Transparent=24]="Transparent",m[m.XyY=25]="XyY",m[m.XYZ=26]="XYZ",m[m.YCbCr=27]="YCbCr",m[m.YCC=28]="YCC",m[m.YDbDr=29]="YDbDr",m[m.YIQ=30]="YIQ",m[m.YPbPr=31]="YPbPr",m[m.YUV=32]="YUV",m[m.LinearGray=33]="LinearGray",m))(Cr||{}),kn=(m=>(m[m.Undefined=0]="Undefined",m[m.Alpha=1]="Alpha",m[m.Atop=2]="Atop",m[m.Blend=3]="Blend",m[m.Blur=4]="Blur",m[m.Bumpmap=5]="Bumpmap",m[m.ChangeMask=6]="ChangeMask",m[m.Clear=7]="Clear",m[m.ColorBurn=8]="ColorBurn",m[m.ColorDodge=9]="ColorDodge",m[m.Colorize=10]="Colorize",m[m.CopyBlack=11]="CopyBlack",m[m.CopyBlue=12]="CopyBlue",m[m.Copy=13]="Copy",m[m.CopyCyan=14]="CopyCyan",m[m.CopyGreen=15]="CopyGreen",m[m.CopyMagenta=16]="CopyMagenta",m[m.CopyAlpha=17]="CopyAlpha",m[m.CopyRed=18]="CopyRed",m[m.CopyYellow=19]="CopyYellow",m[m.Darken=20]="Darken",m[m.DarkenIntensity=21]="DarkenIntensity",m[m.Difference=22]="Difference",m[m.Displace=23]="Displace",m[m.Dissolve=24]="Dissolve",m[m.Distort=25]="Distort",m[m.DivideDst=26]="DivideDst",m[m.DivideSrc=27]="DivideSrc",m[m.DstAtop=28]="DstAtop",m[m.Dst=29]="Dst",m[m.DstIn=30]="DstIn",m[m.DstOut=31]="DstOut",m[m.DstOver=32]="DstOver",m[m.Exclusion=33]="Exclusion",m[m.HardLight=34]="HardLight",m[m.HardMix=35]="HardMix",m[m.Hue=36]="Hue",m[m.In=37]="In",m[m.Intensity=38]="Intensity",m[m.Lighten=39]="Lighten",m[m.LightenIntensity=40]="LightenIntensity",m[m.LinearBurn=41]="LinearBurn",m[m.LinearDodge=42]="LinearDodge",m[m.LinearLight=43]="LinearLight",m[m.Luminize=44]="Luminize",m[m.Mathematics=45]="Mathematics",m[m.MinusDst=46]="MinusDst",m[m.MinusSrc=47]="MinusSrc",m[m.Modulate=48]="Modulate",m[m.ModulusAdd=49]="ModulusAdd",m[m.ModulusSubtract=50]="ModulusSubtract",m[m.Multiply=51]="Multiply",m[m.No=52]="No",m[m.Out=53]="Out",m[m.Over=54]="Over",m[m.Overlay=55]="Overlay",m[m.PegtopLight=56]="PegtopLight",m[m.PinLight=57]="PinLight",m[m.Plus=58]="Plus",m[m.Replace=59]="Replace",m[m.Saturate=60]="Saturate",m[m.Screen=61]="Screen",m[m.SoftLight=62]="SoftLight",m[m.SrcAtop=63]="SrcAtop",m[m.Src=64]="Src",m[m.SrcIn=65]="SrcIn",m[m.SrcOut=66]="SrcOut",m[m.SrcOver=67]="SrcOver",m[m.Threshold=68]="Threshold",m[m.VividLight=69]="VividLight",m[m.Xor=70]="Xor",m[m.Stereo=71]="Stereo",m))(kn||{}),wr=(m=>(m[m.Undefined=0]="Undefined",m[m.PixelsPerInch=1]="PixelsPerInch",m[m.PixelsPerCentimeter=2]="PixelsPerCentimeter",m))(wr||{});class nl{constructor(u,v,k){mt(this,"x");mt(this,"y");mt(this,"units");v===void 0?(this.x=u,this.y=u,this.units=wr.PixelsPerInch):k!==void 0?(this.x=u,this.y=v,this.units=k):(this.x=u,this.y=u,this.units=v)}}class Me{static _disposeAfterExecution(u,v){try{const k=v(u);return k instanceof Promise?Promise.resolve(k).then(I=>(u.dispose(),I)):(u.dispose(),k)}catch(k){throw u.dispose(),k}}}class kr{constructor(u,v,k){mt(this,"_pointer");mt(this,"_bytes");mt(this,"_func");this._pointer=u,this._func=k,this._bytes=A._api.HEAPU8.subarray(u,u+v)}func(u){return u._bytes===void 0?u._func(new Uint8Array):u._func(u._bytes)}dispose(){this._pointer=A._api._MagickMemory_Relinquish(this._pointer)}}var On=(m=>(m[m.Error=400]="Error",m[m.ResourceLimitError=400]="ResourceLimitError",m[m.TypeError=405]="TypeError",m[m.OptionError=410]="OptionError",m[m.DelegateError=415]="DelegateError",m[m.MissingDelegateError=420]="MissingDelegateError",m[m.CorruptImageError=425]="CorruptImageError",m[m.FileOpenError=430]="FileOpenError",m[m.BlobError=435]="BlobError",m[m.StreamError=440]="StreamError",m[m.CacheError=445]="CacheError",m[m.CoderError=450]="CoderError",m[m.FilterError=452]="FilterError",m[m.ModuleError=455]="ModuleError",m[m.DrawError=460]="DrawError",m[m.ImageError=465]="ImageError",m[m.WandError=470]="WandError",m[m.RandomError=475]="RandomError",m[m.XServerError=480]="XServerError",m[m.MonitorError=485]="MonitorError",m[m.RegistryError=490]="RegistryError",m[m.ConfigureError=495]="ConfigureError",m[m.PolicyError=499]="PolicyError",m))(On||{});class Qt extends Error{constructor(v,k=On.Error){super(v);mt(this,"_severity");mt(this,"_relatedErrors",[]);this._severity=k}get relatedErrors(){return this._relatedErrors}get severity(){return this._severity}_setRelatedErrors(v){this._relatedErrors=v}}class xe{constructor(){mt(this,"instance");this.instance=A._api._malloc(8),A._api.setValue(this.instance,0,"i64")}get ptr(){return this.instance}get value(){return A._api.getValue(this.instance,"i64")}static use(u){const v=new xe;try{return u(v)}finally{A._api._free(v.instance)}}}function _e(m){return m===0?null:A._api.UTF8ToString(m)}function oi(m,u,v){const k=m.lengthBytesUTF8(u)+1,I=m._malloc(k);try{return m.stringToUTF8(u,I,k),v(I)}finally{m._free(I)}}function Nt(m,u){return oi(A._api,m,u)}class lt{constructor(u){mt(this,"pointer");this.pointer=u}get ptr(){return this.pointer.ptr}check(u,v){return this.isError()?v():u()}static usePointer(u){return xe.use(v=>{const k=u(v.ptr);return lt.checkException(v,k)})}static use(u){return xe.use(v=>{const k=u(new lt(v));return lt.checkException(v,k)})}static checkException(u,v){if(!lt.isRaised(u))return v;const k=lt.getErrorSeverity(u.value);return k>=On.Error?lt.throw(u,k):lt.dispose(u),v}isError(){return lt.isRaised(this.pointer)?lt.getErrorSeverity(this.pointer.value)>=On.Error:!1}static getErrorSeverity(u){return A._api._MagickExceptionHelper_Severity(u)}static isRaised(u){return u.value!==0}static throw(u,v){const k=lt.createError(u.value,v);throw lt.dispose(u),k}static createError(u,v){const k=lt.getMessage(u),I=new Qt(k,v),t=A._api._MagickExceptionHelper_RelatedCount(u);if(t===0)return I;const W=[];for(let g=0;g<t;g++){const s=A._api._MagickExceptionHelper_Related(u,g),h=lt.getErrorSeverity(s),c=lt.createError(s,h);W.push(c)}return I._setRelatedErrors(W),I}static getMessage(u){const v=A._api._MagickExceptionHelper_Message(u),k=A._api._MagickExceptionHelper_Description(u);let I=_e(v);return k!==0&&(I+=`(${A._api.UTF8ToString(k)})`),I}static dispose(u){A._api._MagickExceptionHelper_Dispose(u.value)}}var Re=(m=>(m.Unknown="UNKNOWN",m.ThreeFr="3FR",m.ThreeG2="3G2",m.ThreeGp="3GP",m.A="A",m.Aai="AAI",m.Ai="AI",m.Apng="APNG",m.Art="ART",m.Arw="ARW",m.Ashlar="ASHLAR",m.Avi="AVI",m.Avif="AVIF",m.Avs="AVS",m.B="B",m.Bayer="BAYER",m.Bayera="BAYERA",m.Bgr="BGR",m.Bgra="BGRA",m.Bgro="BGRO",m.Bmp="BMP",m.Bmp2="BMP2",m.Bmp3="BMP3",m.Brf="BRF",m.C="C",m.Cal="CAL",m.Cals="CALS",m.Canvas="CANVAS",m.Caption="CAPTION",m.Cin="CIN",m.Cip="CIP",m.Clip="CLIP",m.Cmyk="CMYK",m.Cmyka="CMYKA",m.Cr2="CR2",m.Cr3="CR3",m.Crw="CRW",m.Cube="CUBE",m.Cur="CUR",m.Cut="CUT",m.Data="DATA",m.Dcm="DCM",m.Dcr="DCR",m.Dcraw="DCRAW",m.Dcx="DCX",m.Dds="DDS",m.Dfont="DFONT",m.Dng="DNG",m.Dpx="DPX",m.Dxt1="DXT1",m.Dxt5="DXT5",m.Epdf="EPDF",m.Epi="EPI",m.Eps="EPS",m.Eps2="EPS2",m.Eps3="EPS3",m.Epsf="EPSF",m.Epsi="EPSI",m.Ept="EPT",m.Ept2="EPT2",m.Ept3="EPT3",m.Erf="ERF",m.Exr="EXR",m.Farbfeld="FARBFELD",m.Fax="FAX",m.FF="FF",m.File="FILE",m.Fits="FITS",m.Fl32="FL32",m.Flv="FLV",m.Fractal="FRACTAL",m.Ftp="FTP",m.Ftxt="FTXT",m.Fts="FTS",m.G="G",m.G3="G3",m.G4="G4",m.Gif="GIF",m.Gif87="GIF87",m.Gradient="GRADIENT",m.Gray="GRAY",m.Graya="GRAYA",m.Group4="GROUP4",m.Hald="HALD",m.Hdr="HDR",m.Heic="HEIC",m.Heif="HEIF",m.Histogram="HISTOGRAM",m.Hrz="HRZ",m.Htm="HTM",m.Html="HTML",m.Http="HTTP",m.Https="HTTPS",m.Icb="ICB",m.Ico="ICO",m.Icon="ICON",m.Iiq="IIQ",m.Info="INFO",m.Inline="INLINE",m.Ipl="IPL",m.Isobrl="ISOBRL",m.Isobrl6="ISOBRL6",m.J2c="J2C",m.J2k="J2K",m.Jng="JNG",m.Jnx="JNX",m.Jp2="JP2",m.Jpc="JPC",m.Jpe="JPE",m.Jpeg="JPEG",m.Jpg="JPG",m.Jpm="JPM",m.Jps="JPS",m.Jpt="JPT",m.Json="JSON",m.Jxl="JXL",m.K="K",m.K25="K25",m.Kdc="KDC",m.Label="LABEL",m.M="M",m.M2v="M2V",m.M4v="M4V",m.Mac="MAC",m.Map="MAP",m.Mask="MASK",m.Mat="MAT",m.Matte="MATTE",m.Mef="MEF",m.Miff="MIFF",m.Mkv="MKV",m.Mng="MNG",m.Mono="MONO",m.Mov="MOV",m.Mp4="MP4",m.Mpc="MPC",m.Mpeg="MPEG",m.Mpg="MPG",m.Mrw="MRW",m.Msl="MSL",m.Msvg="MSVG",m.Mtv="MTV",m.Mvg="MVG",m.Nef="NEF",m.Nrw="NRW",m.Null="NULL",m.O="O",m.Ora="ORA",m.Orf="ORF",m.Otb="OTB",m.Otf="OTF",m.Pal="PAL",m.Palm="PALM",m.Pam="PAM",m.Pango="PANGO",m.Pattern="PATTERN",m.Pbm="PBM",m.Pcd="PCD",m.Pcds="PCDS",m.Pcl="PCL",m.Pct="PCT",m.Pcx="PCX",m.Pdb="PDB",m.Pdf="PDF",m.Pdfa="PDFA",m.Pef="PEF",m.Pes="PES",m.Pfa="PFA",m.Pfb="PFB",m.Pfm="PFM",m.Pgm="PGM",m.Pgx="PGX",m.Phm="PHM",m.Picon="PICON",m.Pict="PICT",m.Pix="PIX",m.Pjpeg="PJPEG",m.Plasma="PLASMA",m.Png="PNG",m.Png00="PNG00",m.Png24="PNG24",m.Png32="PNG32",m.Png48="PNG48",m.Png64="PNG64",m.Png8="PNG8",m.Pnm="PNM",m.Pocketmod="POCKETMOD",m.Ppm="PPM",m.Ps="PS",m.Ps2="PS2",m.Ps3="PS3",m.Psb="PSB",m.Psd="PSD",m.Ptif="PTIF",m.Pwp="PWP",m.Qoi="QOI",m.R="R",m.RadialGradient="RADIAL-GRADIENT",m.Raf="RAF",m.Ras="RAS",m.Raw="RAW",m.Rgb="RGB",m.Rgb565="RGB565",m.Rgba="RGBA",m.Rgbo="RGBO",m.Rgf="RGF",m.Rla="RLA",m.Rle="RLE",m.Rmf="RMF",m.Rw2="RW2",m.Scr="SCR",m.Screenshot="SCREENSHOT",m.Sct="SCT",m.Sfw="SFW",m.Sgi="SGI",m.Shtml="SHTML",m.Six="SIX",m.Sixel="SIXEL",m.SparseColor="SPARSE-COLOR",m.Sr2="SR2",m.Srf="SRF",m.Stegano="STEGANO",m.StrImg="STRIMG",m.Sun="SUN",m.Svg="SVG",m.Svgz="SVGZ",m.Text="TEXT",m.Tga="TGA",m.Thumbnail="THUMBNAIL",m.Tiff="TIFF",m.Tiff64="TIFF64",m.Tile="TILE",m.Tim="TIM",m.Tm2="TM2",m.Ttc="TTC",m.Ttf="TTF",m.Txt="TXT",m.Ubrl="UBRL",m.Ubrl6="UBRL6",m.Uil="UIL",m.Uyvy="UYVY",m.Vda="VDA",m.Vicar="VICAR",m.Vid="VID",m.Viff="VIFF",m.Vips="VIPS",m.Vst="VST",m.Wbmp="WBMP",m.Webp="WEBP",m.Webm="WEBM",m.Wmv="WMV",m.Wpg="WPG",m.X3f="X3F",m.Xbm="XBM",m.Xc="XC",m.Xcf="XCF",m.Xpm="XPM",m.Xps="XPS",m.Xv="XV",m.Y="Y",m.Yaml="YAML",m.Ycbcr="YCbCr",m.Ycbcra="YCbCrA",m.Yuv="YUV",m))(Re||{});const fe=class fe{constructor(u,v,k,I,t){mt(this,"_format");mt(this,"_description");mt(this,"_supportsMultipleFrames");mt(this,"_supportsReading");mt(this,"_supportsWriting");this._format=u,this._description=v,this._supportsMultipleFrames=k,this._supportsReading=I,this._supportsWriting=t}get description(){return this._description}get format(){return this._format}get supportsMultipleFrames(){return this._supportsMultipleFrames}get supportsReading(){return this._supportsReading}get supportsWriting(){return this._supportsWriting}static get all(){return fe._all===void 0&&(fe._all=fe.loadFormats()),fe._all}static create(u){for(const v of fe.all)if(v.format===u)return v;throw new Qt(`unable to get format info for ${u}`)}static loadFormats(){return lt.usePointer(u=>xe.use(v=>{const k=A._api._MagickFormatInfo_CreateList(v.ptr,u),I=v.value;try{const t=new Array(I),W=Object.values(Re);for(let g=0;g<I;g++){const s=A._api._MagickFormatInfo_GetInfo(k,g,u),h=_e(A._api._MagickFormatInfo_Format_Get(s)),c=fe.convertFormat(h,W),n=_e(A._api._MagickFormatInfo_Description_Get(s),""),a=A._api._MagickFormatInfo_SupportsMultipleFrames_Get(s)==1,e=A._api._MagickFormatInfo_SupportsReading_Get(s)==1,o=A._api._MagickFormatInfo_SupportsWriting_Get(s)==1;t[g]=new fe(c,n,a,e,o)}return t}finally{A._api._MagickFormatInfo_DisposeList(k,I)}}))}static convertFormat(u,v){return u===null?Re.Unknown:v.includes(u)?u:Re.Unknown}};mt(fe,"_all");let li=fe;class Gn{static get delegates(){return _e(A._api._Magick_Delegates_Get())}static get features(){return _e(A._api._Magick_Features_Get()).slice(0,-1)}static get imageMagickVersion(){return _e(A._api._Magick_ImageMagickVersion_Get())}static get supportedFormats(){return li.all}static addFont(u,v){const k=A._api.FS;k.analyzePath("/fonts").exists||k.mkdir("/fonts");const I=k.open(`/fonts/${u}`,"w");k.write(I,v,0,v.length),k.close(I)}static _getFontFileName(u){const v=`/fonts/${u}`;if(!A._api.FS.analyzePath(v).exists)throw`Unable to find a font with the name '${u}', add it with Magick.addFont.`;return v}}mt(Gn,"setRandomSeed",u=>A._api._Magick_SetRandomSeed(u));class sn{constructor(u,v){mt(this,"disposeMethod");mt(this,"instance");this.instance=u,this.disposeMethod=v}get _instance(){if(this.instance>0)return this.instance;throw this.instance===-1&&this._instanceNotInitialized(),new Qt("instance is disposed")}set _instance(u){this.disposeInstance(this.instance),this.instance=u}dispose(){this.instance=this.disposeInstance(this.instance)}_setInstance(u,v){v.check(()=>{this.dispose(),this.instance=u},()=>{this.disposeInstance(u)})}_instanceNotInitialized(){throw new Qt("instance is not initialized")}disposeInstance(u){return u>0&&this.disposeMethod(u),0}}class il extends sn{constructor(u){const v=A._api._DrawingSettings_Create(),k=A._api._DrawingSettings_Dispose;if(super(v,k),u.fillColor!==void 0&&u.fillColor._use(I=>{A._api._DrawingSettings_FillColor_Set(this._instance,I)}),u.font!==void 0){const I=Gn._getFontFileName(u.font);Nt(I,t=>{A._api._DrawingSettings_Font_Set(this._instance,t)})}u.fontPointsize!==void 0&&A._api._DrawingSettings_FontPointsize_Set(this._instance,u.fontPointsize),u.strokeColor!==void 0&&u.strokeColor._use(I=>{A._api._DrawingSettings_StrokeColor_Set(this._instance,I)}),u.strokeWidth!==void 0&&A._api._DrawingSettings_StrokeWidth_Set(this._instance,u.strokeWidth)}}class ci{constructor(){mt(this,"backgroundColor");mt(this,"fillColor");mt(this,"font");mt(this,"fontPointsize");mt(this,"strokeColor");mt(this,"strokeWidth")}static _create(u){const v=new ci;return v.fillColor=u.fillColor,v.font=u.font,v.fontPointsize=u.fontPointsize,v.strokeColor=u.strokeColor,v.strokeWidth=u.strokeWidth,v}_use(u){const v=new il(this);return Me._disposeAfterExecution(v,u)}}class hi extends sn{constructor(u,v){const k=ci._create(v)._use(t=>A._api._DrawingWand_Create(u._instance,t._instance)),I=A._api._DrawingWand_Dispose;super(k,I)}color(u,v,k){lt.usePointer(I=>{A._api._DrawingWand_Color(this._instance,u,v,k,I)})}draw(u){u.forEach(v=>{v.draw(this)}),lt.usePointer(v=>{A._api._DrawingWand_Render(this._instance,v)})}fillColor(u){lt.usePointer(v=>{u._use(k=>{A._api._DrawingWand_FillColor(this._instance,k,v)})})}fillOpacity(u){lt.usePointer(v=>{A._api._DrawingWand_FillOpacity(this._instance,u,v)})}font(u){lt.usePointer(v=>{Nt(u,k=>{A._api._DrawingWand_Font(this._instance,k,v)})})}fontPointSize(u){lt.usePointer(v=>{A._api._DrawingWand_FontPointSize(this._instance,u,v)})}gravity(u){lt.usePointer(v=>{A._api._DrawingWand_Gravity(this._instance,u,v)})}rectangle(u,v,k,I){lt.usePointer(t=>{A._api._DrawingWand_Rectangle(this._instance,u,v,k,I,t)})}roundRectangle(u,v,k,I,t,W){lt.usePointer(g=>{A._api._DrawingWand_RoundRectangle(this._instance,u,v,k,I,t,W,g)})}text(u,v,k){lt.usePointer(I=>{Nt(k,t=>{A._api._DrawingWand_Text(this._instance,u,v,t,I)})})}static _create(u,v){return new hi(u,v)}}var bn=(m=>(m[m.Undefined=0]="Undefined",m[m.Forget=0]="Forget",m[m.Northwest=1]="Northwest",m[m.North=2]="North",m[m.Northeast=3]="Northeast",m[m.West=4]="West",m[m.Center=5]="Center",m[m.East=6]="East",m[m.Southwest=7]="Southwest",m[m.South=8]="South",m[m.Southeast=9]="Southeast",m))(bn||{});function*rl(m){for(const u of m)switch(u){case 2:yield"north";break;case 3:yield"north",yield"east";break;case 1:yield"north",yield"west";break;case 6:yield"east";break;case 4:yield"west";break;case 8:yield"south";break;case 9:yield"south",yield"east";break;case 7:yield"south",yield"west"}}class al{constructor(u,v){mt(this,"_data");mt(this,"name");this.name=u,this._data=v}getData(){return this._data}}class Le{static get depth(){return A._api._Quantum_Depth_Get()}static get max(){return A._api._Quantum_Max_Get()}}class we{constructor(u,v,k,I,t){mt(this,"_r",0);mt(this,"_g",0);mt(this,"_b",0);mt(this,"_a",0);mt(this,"_k",0);mt(this,"_isCmyk",!1);if(u!==void 0)if(typeof u=="string"){let W=0;try{W=A._api._MagickColor_Create(),Nt(u,g=>{if(A._api._MagickColor_Initialize(W,g)===0)throw new Qt("invalid color specified");this.initialize(W)})}finally{A._api._free(W)}}else this._r=u,this._g=v??0,this._b=k??0,t===void 0?this._a=I??Le.max:(this._k=I??0,this._a=t,this._isCmyk=!0)}static _create(u){const v=new we;return v.initialize(u),v}get r(){return this._r}set r(u){this._r=u}get g(){return this._g}set g(u){this._g=u}get b(){return this._b}set b(u){this._b=u}get a(){return this._a}set a(u){this._a=u}get k(){return this._k}set k(u){this._k=u}get isCmyk(){return this._isCmyk}toShortString(){return this._a!==Le.max?this.toString():this.isCmyk?`cmyka(${this._r},${this._g},${this._b},${this._k})`:`#${this.toHex(this._r)}${this.toHex(this._g)}${this.toHex(this._b)}`}toString(){return this.isCmyk?`cmyka(${this._r},${this._g},${this._b},${this._k},${(this._a/Le.max).toFixed(4)})`:`#${this.toHex(this._r)}${this.toHex(this._g)}${this.toHex(this._b)}${this.toHex(this._a)}`}_use(u){let v=0;try{v=A._api._MagickColor_Create(),A._api._MagickColor_Red_Set(v,this._r),A._api._MagickColor_Green_Set(v,this._g),A._api._MagickColor_Blue_Set(v,this._b),A._api._MagickColor_Alpha_Set(v,this._a),A._api._MagickColor_IsCMYK_Set(v,this._isCmyk?1:0),u(v)}finally{A._api._free(v)}}initialize(u){this._r=A._api._MagickColor_Red_Get(u),this._g=A._api._MagickColor_Green_Get(u),this._b=A._api._MagickColor_Blue_Get(u),this._a=A._api._MagickColor_Alpha_Get(u),this._isCmyk=A._api._MagickColor_IsCMYK_Get(u)===1}toHex(u){return u.toString(16).padStart(2,"0")}}var Ce=(m=>(m[m.NoValue=0]="NoValue",m[m.PercentValue=4096]="PercentValue",m[m.IgnoreAspectRatio=8192]="IgnoreAspectRatio",m[m.Less=16384]="Less",m[m.Greater=32768]="Greater",m[m.FillArea=65536]="FillArea",m[m.LimitPixels=131072]="LimitPixels",m[m.AspectRatio=1048576]="AspectRatio",m))(Ce||{});class re{constructor(u,v,k,I){mt(this,"_width",0);mt(this,"_height",0);mt(this,"_x",0);mt(this,"_y",0);mt(this,"_aspectRatio",!1);mt(this,"_fillArea",!1);mt(this,"_greater",!1);mt(this,"_isPercentage",!1);mt(this,"_ignoreAspectRatio",!1);mt(this,"_less",!1);mt(this,"_limitPixels",!1);if(typeof u=="number"){if(k!==void 0&&I!==void 0?(this._width=k,this._height=I,this._x=u,this._y=v??0):(this._width=u,this._height=v??this._width,this._x=0,this._y=0),this._width<0)throw new Qt("negative width is not allowed");if(this._height<0)throw new Qt("negative height is not allowed")}else{const t=A._api._MagickGeometry_Create();try{Nt(u,W=>{const g=A._api._MagickGeometry_Initialize(t,W);if(g===Ce.NoValue)throw new Qt("invalid geometry specified");this.hasFlag(g,Ce.AspectRatio)?this.initializeFromAspectRation(t,u):this.initialize(t,g)})}finally{A._api._MagickGeometry_Dispose(t)}}}get aspectRatio(){return this._aspectRatio}get fillArea(){return this._fillArea}set fillArea(u){this._fillArea=u}get greater(){return this._greater}set greater(u){this._greater=u}get ignoreAspectRatio(){return this._ignoreAspectRatio}set ignoreAspectRatio(u){this._ignoreAspectRatio=u}get isPercentage(){return this._isPercentage}set isPercentage(u){this._isPercentage=u}get less(){return this._less}set less(u){this._less=u}get limitPixels(){return this._limitPixels}set limitPixels(u){this._limitPixels=u}get height(){return this._height}set height(u){this._height=u}get width(){return this._width}set width(u){this._width=u}get x(){return this._x}set x(u){this._x=u}get y(){return this._y}set y(u){this._y=u}toString(){if(this._aspectRatio)return this._width+":"+this._height;let u="";return this._width>0&&(u+=this._width.toString()),this._height>0?u+="x"+this._height.toString():u+="x",(this._x!=0||this._y!=0)&&(this._x>=0&&(u+="+"),u+=this._x,this.y>=0&&(u+="+"),u+=this.y),this._fillArea&&(u+="^"),this._greater&&(u+=">"),this._isPercentage&&(u+="%"),this._ignoreAspectRatio&&(u+="!"),this._less&&(u+="<"),this._limitPixels&&(u+="@"),u}static _fromRectangle(u){if(u===0)throw new Qt("unable to allocate memory");try{const v=A._api._MagickRectangle_Width_Get(u),k=A._api._MagickRectangle_Height_Get(u),I=A._api._MagickRectangle_X_Get(u),t=A._api._MagickRectangle_Y_Get(u);return new re(I,t,v,k)}finally{A._api._MagickRectangle_Dispose(u)}}_toRectangle(u){const v=A._api._MagickRectangle_Create();if(v===0)throw new Qt("unable to allocate memory");try{A._api._MagickRectangle_Width_Set(v,this._width),A._api._MagickRectangle_Height_Set(v,this._height),A._api._MagickRectangle_X_Set(v,this._x),A._api._MagickRectangle_Y_Set(v,this._y),u(v)}finally{A._api._MagickRectangle_Dispose(v)}}initialize(u,v){this._width=A._api._MagickGeometry_Width_Get(u),this._height=A._api._MagickGeometry_Height_Get(u),this._x=A._api._MagickGeometry_X_Get(u),this._y=A._api._MagickGeometry_Y_Get(u),this._ignoreAspectRatio=this.hasFlag(v,Ce.IgnoreAspectRatio),this._isPercentage=this.hasFlag(v,Ce.PercentValue),this._fillArea=this.hasFlag(v,Ce.FillArea),this._greater=this.hasFlag(v,Ce.Greater),this._less=this.hasFlag(v,Ce.Less),this._limitPixels=this.hasFlag(v,Ce.LimitPixels)}initializeFromAspectRation(u,v){this._aspectRatio=!0;const k=v.split(":");this._width=this.parseNumber(k[0]),this._height=this.parseNumber(k[1]),this._x=A._api._MagickGeometry_X_Get(u),this._y=A._api._MagickGeometry_Y_Get(u)}parseNumber(u){let v=0;for(;v<u.length&&!this.isNumber(u[v]);)v++;const k=v;for(;v<u.length&&this.isNumber(u[v]);)v++;return parseInt(u.substr(k,v-k))}isNumber(u){return u>="0"&&u<="9"}hasFlag(u,v){return(u&v)===v}}class br extends sn{constructor(u){const v=A._api._MagickSettings_Create(),k=A._api._MagickSettings_Dispose;if(super(v,k),u._fileName!==void 0&&Nt(u._fileName,I=>{A._api._MagickSettings_SetFileName(this._instance,I)}),u._ping&&A._api._MagickSettings_SetPing(this._instance,1),u._quality!==void 0&&A._api._MagickSettings_SetQuality(this._instance,u._quality),u.backgroundColor!==void 0&&u.backgroundColor._use(I=>{A._api._MagickSettings_BackgroundColor_Set(this._instance,I)}),u.colorType!==void 0&&A._api._MagickSettings_ColorType_Set(this._instance,u.colorType),u.fillColor!==void 0&&this.setOption("fill",u.fillColor.toString()),u.font!==void 0){const I=Gn._getFontFileName(u.font);Nt(I,t=>{A._api._MagickSettings_Font_Set(this._instance,t)})}u.fontPointsize!==void 0&&A._api._MagickSettings_FontPointsize_Set(this._instance,u.fontPointsize),u.format!==void 0&&Nt(u.format,I=>{A._api._MagickSettings_Format_Set(this._instance,I)}),u.strokeColor!==void 0&&this.setOption("stroke",u.strokeColor.toString()),u.strokeWidth!==void 0&&this.setOption("strokeWidth",u.strokeWidth.toString()),u.textInterlineSpacing!==void 0&&this.setOption("interline-spacing",u.textInterlineSpacing.toString()),u.textKerning!==void 0&&this.setOption("kerning",u.textKerning.toString());for(const I in u._options)this.setOption(I,u._options[I])}setOption(u,v){Nt(u,k=>{Nt(v,I=>{A._api._MagickSettings_SetOption(this._instance,k,I)})})}}class Ye{constructor(){mt(this,"_options",{});mt(this,"_fileName");mt(this,"_ping",!1);mt(this,"_quality");mt(this,"backgroundColor");mt(this,"colorType");mt(this,"fillColor");mt(this,"font");mt(this,"fontPointsize");mt(this,"format");mt(this,"strokeColor");mt(this,"strokeWidth");mt(this,"textInterlineSpacing");mt(this,"textKerning")}getDefine(u,v){return v!==void 0?this._options[`${u}:${v}`]??null:this._options[u]??null}setDefine(u,v,k){if(k===void 0)this._options[u]=v;else{const I=this.parseDefine(u,v);typeof k=="string"?this._options[I]=k:typeof k=="number"?this._options[I]=k.toString():this._options[I]=k?"true":"false"}}setDefines(u){u.getDefines().forEach(v=>{v!==void 0&&this.setDefine(v.format,v.name,v.value)})}_clone(){const u=new Ye;return Object.assign(u,this),u}_use(u){const v=new br(this);return Me._disposeAfterExecution(v,u)}parseDefine(u,v){return u===Re.Unknown?v:`${u}:${v}`}}class oe extends Ye{constructor(v){super();mt(this,"height");mt(this,"width");Object.assign(this,v)}_use(v){const k=new br(this),I=this.getSize();return I!==""&&Nt(I,t=>{A._api._MagickSettings_SetSize(k._instance,t)}),Me._disposeAfterExecution(k,v)}getSize(){return this.width!==void 0&&this.height!==void 0?`${this.width}x${this.height}`:this.width!==void 0?`${this.width}x`:this.height!==void 0?`x${this.height}`:""}}class ge extends Array{constructor(){super()}dispose(){let u=this.pop();for(;u!==void 0;)u.dispose(),u=this.pop()}appendHorizontally(u){return this.createImage((v,k)=>A._api._MagickImageCollection_Append(v,0,k.ptr),u)}appendVertically(u){return this.createImage((v,k)=>A._api._MagickImageCollection_Append(v,1,k.ptr),u)}clone(u){const v=ge.create();for(let k=0;k<this.length;k++)v.push(te._clone(this[k]));return v._use(u)}evaluate(u,v){return this.createImage((k,I)=>A._api._MagickImageCollection_Evaluate(k,u,I.ptr),v)}flatten(u){return this.mergeImages(14,u)}merge(u){return this.mergeImages(13,u)}montage(u,v){this.throwIfEmpty();try{this.attachImages();const k=u._use(W=>lt.use(g=>{const s=A._api._MagickImageCollection_Montage(this[0]._instance,W._instance,g.ptr);return this.checkResult(s,g)})),I=ge._createFromImages(k,this.getSettings()),t=u.transparentColor;return t!==void 0&&I.forEach(W=>{W.transparent(t)}),I.merge(v)}finally{this.detachImages()}}mosaic(u){return this.mergeImages(15,u)}read(u,v){this.dispose(),lt.use(k=>{const I=ge.createSettings(v);u instanceof Uint8Array?I._use(t=>{const W=u.byteLength;let g=0;try{g=A._api._malloc(W),A._api.HEAPU8.set(u,g);const s=A._api._MagickImageCollection_ReadBlob(t._instance,g,0,W,k.ptr);this.addImages(s,I)}finally{g!==0&&A._api._free(g)}}):(I._fileName=u,I._use(t=>{const W=A._api._MagickImageCollection_ReadFile(t._instance,k.ptr);this.addImages(W,I)}))})}write(u,v){this.throwIfEmpty();let k=0,I=0;lt.use(W=>{xe.use(g=>{const s=this[0],h=this.getSettings();v!==void 0?h.format=v:h.format=s.format,h._use(c=>{try{this.attachImages(),k=A._api._MagickImage_WriteBlob(s._instance,c._instance,g.ptr,W.ptr),I=g.value}finally{this.detachImages()}})})});const t=new kr(k,I,u);return Me._disposeAfterExecution(t,t.func)}static create(){return ge.createObject()}static _createFromImages(u,v){const k=ge.createObject();return k.addImages(u,v._clone()),k}_use(u){return Me._disposeAfterExecution(this,u)}addImages(u,v){v.format=Re.Unknown;let k=u;for(;k!==0;){const I=A._api._MagickImage_GetNext(k);A._api._MagickImage_SetNext(k,0),this.push(te._createFromImage(k,v)),k=I}}attachImages(){for(let u=0;u<this.length-1;u++)A._api._MagickImage_SetNext(this[u]._instance,this[u+1]._instance)}static createObject(){return Object.create(ge.prototype)}createImage(u,v){this.throwIfEmpty();try{this.attachImages();const k=lt.use(I=>{const t=u(this[0]._instance,I);return this.checkResult(t,I)});return te._createFromImage(k,this.getSettings())._use(v)}finally{this.detachImages()}}static createSettings(u){return u==null?new Ye:new oe(u)}detachImages(){for(let u=0;u<this.length-1;u++)A._api._MagickImage_SetNext(this[u]._instance,0)}getSettings(){return this[0]._getSettings()._clone()}mergeImages(u,v){return this.createImage((k,I)=>A._api._MagickImageCollection_Merge(k,u,I.ptr),v)}throwIfEmpty(){if(this.length===0)throw new Qt("operation requires at least one image")}checkResult(u,v){return v.check(()=>u,()=>(A._api._MagickImageCollection_Dispose(u),0))}}class se{constructor(u){mt(this,"_value");this._value=u}static fromQuantum(u){return new se(u/Le.max*100)}multiply(u){return u*this._value/100}toDouble(){return this._value}toQuantum(){return Le.max*(this._value/100)}}class ur{static use(u,v,k){const I=A._api._MagickRectangle_Create();try{A._api._MagickRectangle_X_Set(I,v.x),A._api._MagickRectangle_Y_Set(I,v.y);let t=v.width,W=v.height;return v.isPercentage&&(t=new se(v.width).multiply(u.width),W=new se(v.height).multiply(u.height)),A._api._MagickRectangle_Width_Set(I,t),A._api._MagickRectangle_Height_Set(I,W),k(I)}finally{A._api._MagickRectangle_Dispose(I)}}}var be=(m=>(m[m.Red=0]="Red",m[m.Cyan=0]="Cyan",m[m.Gray=0]="Gray",m[m.Green=1]="Green",m[m.Magenta=1]="Magenta",m[m.Blue=2]="Blue",m[m.Yellow=2]="Yellow",m[m.Black=3]="Black",m[m.Alpha=4]="Alpha",m[m.Index=5]="Index",m[m.Composite=64]="Composite",m))(be||{});function sl(m,u){const v=m.length*8;if(v===0)return u(0);const k=A._api._malloc(v);try{const I=new ArrayBuffer(v),t=new Float64Array(I);for(let W=0;W<m.length;W++)t[W]=m[W];return A._api.HEAPU8.set(new Int8Array(I),k),u(k)}finally{A._api._free(k)}}function ol(m,u){const v=m.length*8;if(v===0)return u(0);const k=A._api._malloc(v);try{return A._api.HEAPU8.set(m,k),u(k)}finally{A._api._free(k)}}class Oe extends sn{constructor(v){const k=lt.usePointer(t=>A._api._PixelCollection_Create(v._instance,t)),I=A._api._PixelCollection_Dispose;super(k,I);mt(this,"image");this.image=v}static _create(v){return new Oe(v)}static _use(v,k){const I=new Oe(v);return Me._disposeAfterExecution(I,k)}static _map(v,k,I){const t=new Oe(v);try{t.use(0,0,v.width,v.height,k,W=>{I(W)})}finally{t.dispose()}}getArea(v,k,I,t){return lt.usePointer(W=>{const g=A._api._PixelCollection_GetArea(this._instance,v,k,I,t,W),s=I*t*this.image.channelCount;return A._api.HEAPU8.subarray(g,g+s)})}getPixel(v,k){return this.getArea(v,k,1,1)}setArea(v,k,I,t,W){lt.usePointer(g=>{const s=W instanceof Uint8Array?W:new Uint8Array(W);ol(s,h=>{A._api._PixelCollection_SetArea(this._instance,v,k,I,t,h,s.length,g)})})}setPixel(v,k,I){I instanceof Uint8Array?this.setArea(v,k,1,1,I):this.setArea(v,k,1,1,I)}toByteArray(v,k,I,t,W){return this.use(v,k,I,t,W,g=>Oe.createArray(g,I,t,W.length))}static createArray(v,k,I,t){if(v===0)return null;try{const W=k*I*t;return A._api.HEAPU8.slice(v,v+W)}finally{v=A._api._MagickMemory_Relinquish(v)}}use(v,k,I,t,W,g){return Nt(W,s=>lt.use(h=>{let c=A._api._PixelCollection_ToByteArray(this._instance,v,k,I,t,s,h.ptr);return h.check(()=>{const n=g(c);return c=A._api._MagickMemory_Relinquish(c),n},()=>(c=A._api._MagickMemory_Relinquish(c),null))}))}}class rn{constructor(u,v){mt(this,"_x");mt(this,"_y");this._x=u,this._y=v??u}get x(){return this._x}set x(u){this._x=u}get y(){return this._y}set y(u){this._y=u}}class Ae{constructor(u,v,k){mt(this,"_x");mt(this,"_y");mt(this,"_z");this._x=u,this._y=v,this._z=k}get x(){return this._x}get y(){return this._y}get z(){return this._z}static _create(u){return u===0?new Ae(0,0,0):new Ae(A._api._PrimaryInfo_X_Get(u),A._api._PrimaryInfo_Y_Get(u),A._api._PrimaryInfo_Z_Get(u))}_use(u){let v=0;try{v=A._api._PrimaryInfo_Create(),A._api._PrimaryInfo_X_Set(v,this._x),A._api._PrimaryInfo_Y_Set(v,this._y),A._api._PrimaryInfo_Z_Set(v,this._z),u(v)}finally{A._api._free(v)}}}class fi{constructor(){mt(this,"_channels",{})}get channels(){const u=[];for(const v in this._channels)u.push(parseInt(v));return u}composite(){return this._channels[be.Composite]}getChannel(u){const v=this._channels[u];return v!==void 0?v:null}static _create(u,v,k){const I=new fi;return u.channels.forEach(t=>{k>>t&1&&I.addChannel(v,t)}),I.addChannel(v,be.Composite),I}addChannel(u,v){const k=A._api._Statistics_GetInstance(u,v);k!==0&&(this._channels[v]=new hl(v,k))}}class ll{static toArray(u){if(u===0)return null;const v=A._api._StringInfo_Datum_Get(u),k=A._api._StringInfo_Length_Get(u);return A._api.HEAPU8.subarray(v,v+k)}}class te extends sn{constructor(v,k){super(v,A._api._MagickImage_Dispose);mt(this,"_settings");mt(this,"contrast",()=>this._contrast(!0));mt(this,"inverseContrast",()=>this._contrast(!1));mt(this,"inverseOpaque",(v,k)=>this._opaque(v,k,!0));mt(this,"inverseTransparent",v=>this._transparent(v,!0));mt(this,"opaque",(v,k)=>this._opaque(v,k,!1));mt(this,"toString",()=>`${this.format} ${this.width}x${this.height} ${this.depth}-bit ${Cr[this.colorSpace]}`);this._settings=k}get animationDelay(){return A._api._MagickImage_AnimationDelay_Get(this._instance)}set animationDelay(v){A._api._MagickImage_AnimationDelay_Set(this._instance,v)}get animationIterations(){return A._api._MagickImage_AnimationIterations_Get(this._instance)}set animationIterations(v){A._api._MagickImage_AnimationIterations_Set(this._instance,v)}get animationTicksPerSecond(){return A._api._MagickImage_AnimationTicksPerSecond_Get(this._instance)}set animationTicksPerSecond(v){A._api._MagickImage_AnimationTicksPerSecond_Set(this._instance,v)}get artifactNames(){const v=[];A._api._MagickImage_ResetArtifactIterator(this._instance);let k=A._api._MagickImage_GetNextArtifactName(this._instance);for(;k!==0;)v.push(A._api.UTF8ToString(k)),k=A._api._MagickImage_GetNextArtifactName(this._instance);return v}get attributeNames(){const v=[];A._api._MagickImage_ResetAttributeIterator(this._instance);let k=A._api._MagickImage_GetNextAttributeName(this._instance);for(;k!==0;)v.push(A._api.UTF8ToString(k)),k=A._api._MagickImage_GetNextAttributeName(this._instance);return v}get backgroundColor(){const v=A._api._MagickImage_BackgroundColor_Get(this._instance);return we._create(v)}set backgroundColor(v){v._use(k=>{A._api._MagickImage_BackgroundColor_Set(this._instance,k)})}get baseHeight(){return A._api._MagickImage_BaseHeight_Get(this._instance)}get baseWidth(){return A._api._MagickImage_BaseWidth_Get(this._instance)}get blackPointCompensation(){return A._api._MagickImage_BlackPointCompensation_Get(this._instance)===1}set blackPointCompensation(v){A._api._MagickImage_BlackPointCompensation_Set(this._instance,v?1:0)}get borderColor(){const v=A._api._MagickImage_BorderColor_Get(this._instance);return we._create(v)}set borderColor(v){v._use(k=>{A._api._MagickImage_BorderColor_Set(this._instance,k)})}get boundingBox(){return lt.usePointer(v=>{const k=A._api._MagickImage_BoundingBox_Get(this._instance,v),I=re._fromRectangle(k);return I.width===0||I.height===0?null:I})}get channelCount(){return A._api._MagickImage_ChannelCount_Get(this._instance)}get channels(){const v=[];return[be.Red,be.Green,be.Blue,be.Black,be.Alpha].forEach(k=>{A._api._MagickImage_HasChannel(this._instance,k)&&v.push(k)}),v}get chromaticity(){return new el(Ae._create(A._api._MagickImage_ChromaRedPrimary_Get(this._instance)),Ae._create(A._api._MagickImage_ChromaGreenPrimary_Get(this._instance)),Ae._create(A._api._MagickImage_ChromaBluePrimary_Get(this._instance)),Ae._create(A._api._MagickImage_ChromaWhitePoint_Get(this._instance)))}set chromaticity(v){v.blue._use(k=>A._api._MagickImage_ChromaBluePrimary_Set(this._instance,k)),v.green._use(k=>A._api._MagickImage_ChromaGreenPrimary_Set(this._instance,k)),v.red._use(k=>A._api._MagickImage_ChromaRedPrimary_Set(this._instance,k)),v.white._use(k=>A._api._MagickImage_ChromaWhitePoint_Set(this._instance,k))}get classType(){return lt.usePointer(v=>A._api._MagickImage_ClassType_Get(this._instance,v))}set classType(v){lt.usePointer(k=>{A._api._MagickImage_ClassType_Set(this._instance,v,k)})}get colorFuzz(){return se.fromQuantum(A._api._MagickImage_ColorFuzz_Get(this._instance))}set colorFuzz(v){A._api._MagickImage_ColorFuzz_Set(this._instance,v.toQuantum())}get colormapSize(){return lt.usePointer(v=>A._api._MagickImage_ColormapSize_Get(this._instance,v))}set colormapSize(v){lt.usePointer(k=>{A._api._MagickImage_ColormapSize_Set(this._instance,v,k)})}get colorSpace(){return lt.usePointer(v=>A._api._MagickImage_ColorSpace_Get(this._instance,v))}set colorSpace(v){lt.usePointer(k=>{A._api._MagickImage_ColorSpace_Set(this._instance,v,k)})}get colorType(){return this.settings.colorType!==void 0?this.settings.colorType:lt.usePointer(v=>A._api._MagickImage_ColorType_Get(this._instance,v))}set colorType(v){lt.usePointer(k=>{A._api._MagickImage_ColorType_Set(this._instance,v,k)})}get comment(){return this.getAttribute("comment")}set comment(v){v===null?this.removeAttribute("comment"):this.setAttribute("comment",v)}get compose(){return A._api._MagickImage_Compose_Get(this._instance)}set compose(v){A._api._MagickImage_Compose_Set(this._instance,v)}get compression(){return A._api._MagickImage_Compression_Get(this._instance)}get density(){return new nl(A._api._MagickImage_ResolutionX_Get(this._instance),A._api._MagickImage_ResolutionY_Get(this._instance),A._api._MagickImage_ResolutionUnits_Get(this._instance))}set density(v){A._api._MagickImage_ResolutionX_Set(this._instance,v.x),A._api._MagickImage_ResolutionY_Set(this._instance,v.y),A._api._MagickImage_ResolutionUnits_Set(this._instance,v.units)}get depth(){return A._api._MagickImage_Depth_Get(this._instance)}set depth(v){A._api._MagickImage_Depth_Set(this._instance,v)}get filterType(){return A._api._MagickImage_FilterType_Get(this._instance)}set filterType(v){A._api._MagickImage_FilterType_Set(this._instance,v)}get format(){return _e(A._api._MagickImage_Format_Get(this._instance))}set format(v){Nt(v.toString(),k=>A._api._MagickImage_Format_Set(this._instance,k))}get hasAlpha(){return lt.usePointer(v=>this.toBool(A._api._MagickImage_HasAlpha_Get(this._instance,v)))}set hasAlpha(v){lt.usePointer(k=>{v&&this.alpha(yr.Opaque),A._api._MagickImage_HasAlpha_Set(this._instance,this.fromBool(v),k)})}get height(){return A._api._MagickImage_Height_Get(this._instance)}get interpolate(){return A._api._MagickImage_Interpolate_Get(this._instance)}set interpolate(v){A._api._MagickImage_Interpolate_Set(this._instance,v)}get label(){return this.getAttribute("label")}set label(v){v===null?this.removeAttribute("label"):this.setAttribute("label",v)}get orientation(){return A._api._MagickImage_Orientation_Get(this._instance)}set orientation(v){A._api._MagickImage_Orientation_Set(this._instance,v)}get page(){const v=A._api._MagickImage_Page_Get(this._instance);return re._fromRectangle(v)}set page(v){v._toRectangle(k=>{A._api._MagickImage_Page_Set(this._instance,k)})}get quality(){return A._api._MagickImage_Quality_Get(this._instance)}set quality(v){let k=v<1?1:v;k=k>100?100:k,A._api._MagickImage_Quality_Set(this._instance,k),this._settings._quality=k}get settings(){return this._settings}get signature(){return lt.usePointer(v=>_e(A._api._MagickImage_Signature_Get(this._instance,v)))}get virtualPixelMethod(){return lt.usePointer(v=>A._api._MagickImage_VirtualPixelMethod_Get(this._instance,v))}set virtualPixelMethod(v){lt.usePointer(k=>{A._api._MagickImage_VirtualPixelMethod_Set(this._instance,v,k)})}get width(){return A._api._MagickImage_Width_Get(this._instance)}alpha(v){lt.usePointer(k=>{A._api._MagickImage_SetAlpha(this._instance,v,k)})}autoOrient(){lt.use(v=>{const k=A._api._MagickImage_AutoOrient(this._instance,v.ptr);this._setInstance(k,v)})}autoThreshold(v){lt.use(k=>{A._api._MagickImage_AutoThreshold(this._instance,v,k.ptr)})}blur(v,k,I){let t=0;const W=this.valueOrDefault(k,1);let g=this.valueOrDefault(I,ee.Undefined);typeof v=="number"?t=v:v!==void 0&&(g=v),lt.use(s=>{const h=A._api._MagickImage_Blur(this._instance,t,W,g,s.ptr);this._setInstance(h,s)})}border(v,k){const I=v,t=this.valueOrDefault(k,v),W=new re(0,0,I,t);lt.use(g=>{W._toRectangle(s=>{const h=A._api._MagickImage_Border(this._instance,s,g.ptr);this._setInstance(h,g)})})}brightnessContrast(v,k,I){const t=this.valueOrDefault(I,ee.Undefined);lt.use(W=>{A._api._MagickImage_BrightnessContrast(this._instance,v.toDouble(),k.toDouble(),t,W.ptr)})}channelOffset(v){return A._api._MagickImage_HasChannel(this._instance,v)?A._api._MagickImage_ChannelOffset(this._instance,v):-1}charcoal(v,k){const I=v===void 0?0:v,t=k===void 0?1:k;lt.use(W=>{const g=A._api._MagickImage_Charcoal(this._instance,I,t,W.ptr);this._setInstance(g,W)})}clahe(v,k,I,t){lt.usePointer(W=>{const g=v instanceof se?v.multiply(this.width):v,s=k instanceof se?k.multiply(this.height):k;A._api._MagickImage_Clahe(this._instance,g,s,I,t,W)})}clone(v){return te._clone(this)._use(v)}colorAlpha(v){if(!this.hasAlpha)return;const k=te.create();k.read(v,this.width,this.height),k.composite(this,kn.SrcOver,new rn(0,0)),this._instance=k._instance}compare(v,k,I){return lt.usePointer(t=>{const W=this.valueOrDefault(I,ee.Undefined);return A._api._MagickImage_CompareDistortion(this._instance,v._instance,k,W,t)})}composite(v,k,I,t,W){let g=0,s=0,h=kn.In,c=ee.Default,n=null;k instanceof rn?(g=k.x,s=k.y):k!==void 0&&(h=k),I instanceof rn?(g=I.x,s=I.y):typeof I=="string"?n=I:I!==void 0&&(c=I),typeof t=="string"?n=t:t!==void 0&&(c=t),W!==void 0&&(c=W),n!==null&&this.setArtifact("compose:args",n),lt.usePointer(a=>{A._api._MagickImage_Composite(this._instance,v._instance,g,s,h,c,a)}),n!==null&&this.removeArtifact("compose:args")}compositeGravity(v,k,I,t,W,g){let s=0,h=0,c=kn.In,n=ee.Default,a=null;I instanceof rn?(s=I.x,h=I.y):I!==void 0&&(c=I),t instanceof rn?(s=t.x,h=t.y):typeof t=="string"?a=t:t!==void 0&&(n=t),typeof W=="string"?a=W:W!==void 0&&(n=W),g!==void 0&&(n=g),a!==null&&this.setArtifact("compose:args",a),lt.usePointer(e=>{A._api._MagickImage_CompositeGravity(this._instance,v._instance,k,s,h,c,n,e)}),a!==null&&this.removeArtifact("compose:args")}contrastStretch(v,k,I){const t=this.width*this.height,W=v.multiply(t),g=t-(k??v).multiply(t),s=this.valueOrDefault(I,ee.Undefined);lt.usePointer(h=>{A._api._MagickImage_ContrastStretch(this._instance,W,g,s,h)})}static create(v,k,I){const t=new te(te.createInstance(),new Ye);return v!==void 0&&t.readOrPing(!1,v,k,I),t}crop(v,k,I){let t,W;v instanceof re?(t=v,W=this.valueOrDefault(k,bn.Undefined)):k!==void 0&&(t=new re(v,k),W=this.valueOrDefault(I,bn.Undefined)),lt.use(g=>{Nt(t.toString(),s=>{const h=A._api._MagickImage_Crop(this._instance,s,W,g.ptr);this._setInstance(h,g)})})}cropToTiles(v){return lt.use(k=>Nt(v.toString(),I=>{const t=A._api._MagickImage_CropToTiles(this._instance,I,k.ptr);return ge._createFromImages(t,this._settings)}))}deskew(v){lt.use(I=>{const t=A._api._MagickImage_Deskew(this._instance,v.toQuantum(),I.ptr);this._setInstance(t,I)});const k=Number(this.getArtifact("deskew:angle"));return isNaN(k)?0:k}distort(v,k,I){let t,W=0,g=null;k instanceof Array?t=k:I instanceof Array?(t=I,g=k,W=g.bestFit?1:0,g._setArtifacts(this)):t=[],lt.use(s=>{sl(t,h=>{const c=A._api._MagickImage_Distort(this._instance,v,W,h,t.length,s.ptr);this._setInstance(c,s)})}),g!==null&&g._removeArtifacts(this)}draw(...v){const k=hi._create(this,this._settings);try{k.draw(v.flat())}finally{k.dispose()}}evaluate(v,k,I,t){if(typeof k=="number"){const W=k,g=typeof I=="number"?I:I.toQuantum();lt.usePointer(s=>{A._api._MagickImage_EvaluateOperator(this._instance,v,W,g,s)})}else if(t!==void 0){if(typeof I!="number")throw new Qt("this should not happen");const W=k,g=I,s=typeof t=="number"?t:t.toQuantum();if(W.isPercentage)throw new Qt("percentage is not supported");lt.usePointer(h=>{ur.use(this,W,c=>{A._api._MagickImage_EvaluateGeometry(this._instance,v,c,g,s,h)})})}}extent(v,k,I){let t=bn.Undefined,W;v instanceof re?W=v:typeof k=="number"&&(W=new re(v,k)),k instanceof we?this.backgroundColor=k:k!==void 0&&(t=k),I instanceof we?this.backgroundColor=I:I!==void 0&&(t=I),lt.use(g=>{Nt(W.toString(),s=>{const h=A._api._MagickImage_Extent(this._instance,s,t,g.ptr);this._setInstance(h,g)})})}flip(){lt.use(v=>{const k=A._api._MagickImage_Flip(this._instance,v.ptr);this._setInstance(k,v)})}flop(){lt.use(v=>{const k=A._api._MagickImage_Flop(this._instance,v.ptr);this._setInstance(k,v)})}getArtifact(v){return Nt(v,k=>{const I=A._api._MagickImage_GetArtifact(this._instance,k);return _e(I)})}getAttribute(v){return lt.use(k=>Nt(v,I=>{const t=A._api._MagickImage_GetAttribute(this._instance,I,k.ptr);return _e(t)}))}getProfile(v){return Nt(v,k=>{const I=A._api._MagickImage_GetProfile(this._instance,k),t=ll.toArray(I);return t===null?null:new al(v,t)})}getWriteMask(v){const k=lt.usePointer(t=>A._api._MagickImage_GetWriteMask(this._instance,t)),I=k===0?null:new te(k,new Ye);return I==null?v(I):I._use(v)}getPixels(v){if(this._settings._ping)throw new Qt("image contains no pixel data");return Oe._use(this,v)}histogram(){const v=new Map;return lt.usePointer(k=>{xe.use(I=>{const t=A._api._MagickImage_Histogram(this._instance,I.ptr,k);if(t!==0){const W=I.value;for(let g=0;g<W;g++){const s=A._api._MagickColorCollection_GetInstance(t,g),h=we._create(s),c=A._api._MagickColor_Count_Get(s);v.set(h.toString(),c)}A._api._MagickColorCollection_DisposeList(t)}})}),v}inverseSigmoidalContrast(v,k,I){this._sigmoidalContrast(!1,v,k,I)}level(v,k,I,t){let W=ee.Composite,g,s,h=this.valueOrDefault(t,1);typeof v=="number"?(W=v,g=k,I instanceof se&&(s=I)):(g=v,s=k,typeof I=="number"&&(h=I)),lt.usePointer(c=>{A._api._MagickImage_Level(this._instance,g.toDouble(),s.toQuantum(),h,W,c)})}linearStretch(v,k){lt.usePointer(I=>{A._api._MagickImage_LinearStretch(this._instance,v.toDouble(),k.toQuantum(),I)})}liquidRescale(v,k){const I=typeof v=="number"?new re(v,k):v;lt.use(t=>{Nt(I.toString(),W=>{const g=A._api._MagickImage_LiquidRescale(this._instance,W,I.x,I.y,t.ptr);this._setInstance(g,t)})})}negate(v){lt.usePointer(k=>{const I=this.valueOrDefault(v,ee.Undefined);A._api._MagickImage_Negate(this._instance,0,I,k)})}negateGrayScale(v){lt.usePointer(k=>{const I=this.valueOrDefault(v,ee.Undefined);A._api._MagickImage_Negate(this._instance,1,I,k)})}normalize(){lt.usePointer(v=>{A._api._MagickImage_Normalize(this._instance,v)})}modulate(v,k,I){const t=this.valueOrDefault(k,new se(100)),W=this.valueOrDefault(I,new se(100));lt.usePointer(g=>{const s=`${v.toDouble()}/${t.toDouble()}/${W.toDouble()}`;Nt(s,h=>{A._api._MagickImage_Modulate(this._instance,h,g)})})}oilPaint(v){const k=this.valueOrDefault(v,3),I=0;lt.use(t=>{const W=A._api._MagickImage_OilPaint(this._instance,k,I,t.ptr);this._setInstance(W,t)})}ping(v,k){this.readOrPing(!0,v,k)}read(v,k,I){this.readOrPing(!1,v,k,I)}readFromCanvas(v){const k=v.getContext("2d");if(k===null)return;const I=k.getImageData(0,0,v.width,v.height),t=new oe;t.format=Re.Rgba,t.width=v.width,t.height=v.height,lt.use(W=>{this.readFromArray(I.data,t,W)})}removeArtifact(v){Nt(v,k=>{A._api._MagickImage_RemoveArtifact(this._instance,k)})}removeAttribute(v){Nt(v,k=>{A._api._MagickImage_RemoveAttribute(this._instance,k)})}removeWriteMask(){lt.usePointer(v=>{A._api._MagickImage_SetWriteMask(this._instance,0,v)})}repage(){this.page=new re(0,0,0,0)}resize(v,k){const I=typeof v=="number"?new re(v,k):v;lt.use(t=>{Nt(I.toString(),W=>{const g=A._api._MagickImage_Resize(this._instance,W,t.ptr);this._setInstance(g,t)})})}rotate(v){lt.use(k=>{const I=A._api._MagickImage_Rotate(this._instance,v,k.ptr);this._setInstance(I,k)})}separate(v,k){return lt.use(I=>{const t=this.valueOrDefault(k,ee.Undefined),W=A._api._MagickImage_Separate(this._instance,t,I.ptr);return ge._createFromImages(W,this._settings)._use(v)})}setArtifact(v,k){let I;typeof k=="string"?I=k:I=this.fromBool(k).toString(),Nt(v,t=>{Nt(I,W=>{A._api._MagickImage_SetArtifact(this._instance,t,W)})})}setAttribute(v,k){lt.use(I=>{Nt(v,t=>{Nt(k,W=>{A._api._MagickImage_SetAttribute(this._instance,t,W,I.ptr)})})})}setWriteMask(v){lt.usePointer(k=>{A._api._MagickImage_SetWriteMask(this._instance,v._instance,k)})}sharpen(v,k,I){const t=this.valueOrDefault(v,0),W=this.valueOrDefault(k,1),g=this.valueOrDefault(I,ee.Undefined);lt.use(s=>{const h=A._api._MagickImage_Sharpen(this._instance,t,W,g,s.ptr);this._setInstance(h,s)})}shave(v,k){lt.use(I=>{const t=A._api._MagickImage_Shave(this._instance,v,k,I.ptr);this._setInstance(t,I)})}sigmoidalContrast(v,k,I){this._sigmoidalContrast(!0,v,k,I)}splice(v){ur.use(this,v,k=>{lt.use(I=>{const t=A._api._MagickImage_Splice(this._instance,k,I.ptr);this._setInstance(t,I)})})}statistics(v){const k=this.valueOrDefault(v,ee.Default);return lt.usePointer(I=>{const t=A._api._MagickImage_Statistics(this._instance,k,I),W=fi._create(this,t,k);return A._api._Statistics_DisposeList(t),W})}strip(){lt.usePointer(v=>{A._api._MagickImage_Strip(this._instance,v)})}transparent(v){v._use(k=>{lt.usePointer(I=>{A._api._MagickImage_Transparent(this._instance,k,0,I)})})}trim(...v){if(v.length>0)if(v.length==1&&v[0]instanceof se){const k=v[0];this.setArtifact("trim:percent-background",k.toDouble().toString())}else{const k=v,I=[...new Set(rl(k))].join(",");this.setArtifact("trim:edges",I)}lt.use(k=>{const I=A._api._MagickImage_Trim(this._instance,k.ptr);this._setInstance(I,k),this.removeArtifact("trim:edges"),this.removeArtifact("trim:percent-background")})}wave(v,k,I){const t=this.valueOrDefault(v,this.interpolate),W=this.valueOrDefault(k,25),g=this.valueOrDefault(I,150);lt.use(s=>{const h=A._api._MagickImage_Wave(this._instance,t,W,g,s.ptr);this._setInstance(h,s)})}vignette(v,k,I,t){const W=this.valueOrDefault(v,0),g=this.valueOrDefault(k,1),s=this.valueOrDefault(I,0),h=this.valueOrDefault(t,0);lt.use(c=>{const n=A._api._MagickImage_Vignette(this._instance,W,g,s,h,c.ptr);this._setInstance(n,c)})}write(v,k){let I=0,t=0;k!==void 0?this._settings.format=v:k=v,lt.use(g=>{xe.use(s=>{this._settings._use(h=>{try{I=A._api._MagickImage_WriteBlob(this._instance,h._instance,s.ptr,g.ptr),t=s.value}catch{I!==0&&(I=A._api._MagickMemory_Relinquish(I))}})})});const W=new kr(I,t,k);return Me._disposeAfterExecution(W,W.func)}writeToCanvas(v){v.width=this.width,v.height=this.height;const k=v.getContext("2d");k!==null&&Oe._map(this,"RGBA",I=>{const t=k.createImageData(this.width,this.height);let W=0;for(let g=0;g<this.height;g++)for(let s=0;s<this.width;s++)t.data[W++]=A._api.HEAPU8[I++],t.data[W++]=A._api.HEAPU8[I++],t.data[W++]=A._api.HEAPU8[I++],t.data[W++]=A._api.HEAPU8[I++];k.putImageData(t,0,0)})}static _createFromImage(v,k){return new te(v,k)}static _clone(v){return lt.usePointer(k=>new te(A._api._MagickImage_Clone(v._instance,k),v._settings._clone()))}_getSettings(){return this._settings}_instanceNotInitialized(){throw new Qt("no image has been read")}_use(v){return Me._disposeAfterExecution(this,v)}static _use(v){return te.create()._use(v)}_contrast(v){lt.usePointer(k=>{A._api._MagickImage_Contrast(this._instance,this.fromBool(v),k)})}_opaque(v,k,I){lt.usePointer(t=>{v._use(W=>{k._use(g=>{A._api._MagickImage_Opaque(this._instance,W,g,this.fromBool(I),t)})})})}_sigmoidalContrast(v,k,I,t){let W;I!==void 0?typeof I=="number"?W=I:W=I.multiply(Le.max):W=Le.max*.5;const g=this.valueOrDefault(t,ee.Undefined);lt.usePointer(s=>{A._api._MagickImage_SigmoidalContrast(this._instance,this.fromBool(v),k,W,g,s)})}_transparent(v,k){v._use(I=>{lt.usePointer(t=>{A._api._MagickImage_Transparent(this._instance,I,this.fromBool(k),t)})})}static createInstance(){return lt.usePointer(v=>A._api._MagickImage_Create(0,v))}fromBool(v){return v?1:0}readOrPing(v,k,I,t){lt.use(W=>{if(k instanceof Uint8Array){const g=I instanceof oe?I:new oe(this._settings);g._ping=v,this._settings._ping=v,this.readFromArray(k,g,W)}else{const g=I instanceof oe?I:new oe(this._settings);g._ping=v,this._settings._ping=v,typeof k=="string"?g._fileName=k:k instanceof we&&(g._fileName="xc:"+k.toShortString(),g.width=typeof I=="number"?I:0,g.height=typeof t=="number"?t:0),g._use(s=>{const h=A._api._MagickImage_ReadFile(s._instance,W.ptr);this._setInstance(h,W)})}})}readFromArray(v,k,I){k._use(t=>{const W=v.byteLength;let g=0;try{g=A._api._malloc(W),A._api.HEAPU8.set(v,g);const s=A._api._MagickImage_ReadBlob(t._instance,g,0,W,I.ptr);this._setInstance(s,I)}finally{g!==0&&A._api._free(g)}})}toBool(v){return v===1}valueOrDefault(v,k){return v===void 0?k:v}}class ul{constructor(u){mt(this,"_wasmLocation");mt(this,"locateFile",(u,v)=>{let k=this._wasmLocation;return(k===void 0||k.length===0)&&(k=v+u),k});this._wasmLocation=u}}const An=class An{constructor(){mt(this,"loader");mt(this,"api");this.loader=u=>new Promise((v,k)=>{if(this.api!==void 0){v();return}const I=new ul(u);tl(I).then(t=>{try{oi(t,"MAGICK_CONFIGURE_PATH",W=>{oi(t,"/xml",g=>{t._Environment_SetEnv(W,g),this.api=t,v()})})}catch(W){k(W)}})})}async _initialize(u){await this.loader(u)}static get _api(){if(!Mn.api)throw new Qt("`await initializeImageMagick` should be called to initialize the library");return Mn.api}static set _api(u){Mn.api=u}static read(u,v,k,I){return te._use(t=>{let W=I;if(u instanceof we)typeof v=="number"&&typeof k=="number"&&t.read(u,v,k);else if(typeof v!="number"&&typeof k!="number"){W=k;let g;v instanceof oe?g=v:typeof v=="string"?(g=new oe,g.format=v):W=v,t.read(u,g)}return W(t)})}static readCollection(u,v,k){return ge.create()._use(I=>{let t=k,W;return v instanceof oe?W=v:typeof v=="string"?(W=new oe,W.format=v):t=v,I.read(u,W),t(I)})}static readFromCanvas(u,v){return te._use(k=>(k.readFromCanvas(u),v(k)))}};mt(An,"_create",()=>new An);let A=An;const Mn=A._create();async function cl(m){await Mn._initialize(m)}class hl{constructor(u,v){mt(this,"channel");mt(this,"depth");mt(this,"entropy");mt(this,"kurtosis");mt(this,"maximum");mt(this,"mean");mt(this,"minimum");mt(this,"skewness");mt(this,"standardDeviation");this.channel=u,this.depth=A._api._ChannelStatistics_Depth_Get(v),this.entropy=A._api._ChannelStatistics_Entropy_Get(v),this.kurtosis=A._api._ChannelStatistics_Kurtosis_Get(v),this.maximum=A._api._ChannelStatistics_Maximum_Get(v),this.mean=A._api._ChannelStatistics_Mean_Get(v),this.minimum=A._api._ChannelStatistics_Minimum_Get(v),this.skewness=A._api._ChannelStatistics_Skewness_Get(v),this.standardDeviation=A._api._ChannelStatistics_StandardDeviation_Get(v)}}function fl(m){if(m.__esModule)return m;var u=m.default;if(typeof u=="function"){var v=function k(){return this instanceof k?Reflect.construct(u,arguments,this.constructor):u.apply(this,arguments)};v.prototype=u.prototype}else v={};return Object.defineProperty(v,"__esModule",{value:!0}),Object.keys(m).forEach(function(k){var I=Object.getOwnPropertyDescriptor(m,k);Object.defineProperty(v,k,I.get?I:{enumerable:!0,get:function(){return m[k]}})}),v}var De={};const gl={},_l=Object.freeze(Object.defineProperty({__proto__:null,default:gl},Symbol.toStringTag,{value:"Module"})),ri=fl(_l);(function(m){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var u=u||{version:"5.3.0"};if(m.fabric=u,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?u.document=document:u.document=document.implementation.createHTMLDocument(""),u.window=window;else{var v=ri,k=new v.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;u.document=k.document,u.jsdomImplForWrapper=ri.implForWrapper,u.nodeCanvas=ri.Canvas,u.window=k,DOMParser=u.window.DOMParser}u.isTouchSupported="ontouchstart"in u.window||"ontouchstart"in u.document||u.window&&u.window.navigator&&u.window.navigator.maxTouchPoints>0,u.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",u.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],u.DPI=96,u.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",u.commaWsp="(?:\\s+,?\\s*|,\\s*)",u.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,u.reNonWord=/[ \n\.,;!\?\-]/,u.fontPaths={},u.iMatrix=[1,0,0,1,0,0],u.svgNS="http://www.w3.org/2000/svg",u.perfLimitSizeTotal=2097152,u.maxCacheSideLimit=4096,u.minCacheSideLimit=256,u.charWidthsCache={},u.textureSize=2048,u.disableStyleCopyPaste=!1,u.enableGLFiltering=!0,u.devicePixelRatio=u.window.devicePixelRatio||u.window.webkitDevicePixelRatio||u.window.mozDevicePixelRatio||1,u.browserShadowBlurConstant=1,u.arcToSegmentsCache={},u.boundsOfCurveCache={},u.cachesBoundsOfCurve=!0,u.forceGLPutImageData=!1,u.initFilterBackend=function(){if(u.enableGLFiltering&&u.isWebglSupported&&u.isWebglSupported(u.textureSize))return console.log("max texture size: "+u.maxTextureSize),new u.WebglFilterBackend({tileSize:u.textureSize});if(u.Canvas2dFilterBackend)return new u.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=u),function(){function g(e,o){if(this.__eventListeners[e]){var f=this.__eventListeners[e];o?f[f.indexOf(o)]=!1:u.util.array.fill(f,!1)}}function s(e,o){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var f in e)this.on(f,e[f]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(o);return this}function h(e,o){var f=(function(){o.apply(this,arguments),this.off(e,f)}).bind(this);this.on(e,f)}function c(e,o){if(arguments.length===1)for(var f in e)h.call(this,f,e[f]);else h.call(this,e,o);return this}function n(e,o){if(!this.__eventListeners)return this;if(arguments.length===0)for(e in this.__eventListeners)g.call(this,e);else if(arguments.length===1&&typeof arguments[0]=="object")for(var f in e)g.call(this,f,e[f]);else g.call(this,e,o);return this}function a(e,o){if(!this.__eventListeners)return this;var f=this.__eventListeners[e];if(!f)return this;for(var r=0,_=f.length;r<_;r++)f[r]&&f[r].call(this,o||{});return this.__eventListeners[e]=f.filter(function(p){return p!==!1}),this}u.Observable={fire:a,on:s,once:c,off:n}}(),u.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var g=0,s=arguments.length;g<s;g++)this._onObjectAdded(arguments[g]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(g,s,h){var c=this._objects;return h?c[s]=g:c.splice(s,0,g),this._onObjectAdded&&this._onObjectAdded(g),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var g=this._objects,s,h=!1,c=0,n=arguments.length;c<n;c++)s=g.indexOf(arguments[c]),s!==-1&&(h=!0,g.splice(s,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[c]));return this.renderOnAddRemove&&h&&this.requestRenderAll(),this},forEachObject:function(g,s){for(var h=this.getObjects(),c=0,n=h.length;c<n;c++)g.call(s,h[c],c,h);return this},getObjects:function(g){return typeof g>"u"?this._objects.concat():this._objects.filter(function(s){return s.type===g})},item:function(g){return this._objects[g]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(g,s){return this._objects.indexOf(g)>-1?!0:s?this._objects.some(function(h){return typeof h.contains=="function"&&h.contains(g,!0)}):!1},complexity:function(){return this._objects.reduce(function(g,s){return g+=s.complexity?s.complexity():0,g},0)}},u.CommonMethods={_setOptions:function(g){for(var s in g)this.set(s,g[s])},_initGradient:function(g,s){g&&g.colorStops&&!(g instanceof u.Gradient)&&this.set(s,new u.Gradient(g))},_initPattern:function(g,s,h){g&&g.source&&!(g instanceof u.Pattern)?this.set(s,new u.Pattern(g,h)):h&&h()},_setObject:function(g){for(var s in g)this._set(s,g[s])},set:function(g,s){return typeof g=="object"?this._setObject(g):this._set(g,s),this},_set:function(g,s){this[g]=s},toggle:function(g){var s=this.get(g);return typeof s=="boolean"&&this.set(g,!s),this},get:function(g){return this[g]}},function(g){var s=Math.sqrt,h=Math.atan2,c=Math.pow,n=Math.PI/180,a=Math.PI/2;u.util={cos:function(e){if(e===0)return 1;e<0&&(e=-e);var o=e/a;switch(o){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(e===0)return 0;var o=e/a,f=1;switch(e<0&&(f=-1),o){case 1:return f;case 2:return 0;case 3:return-f}return Math.sin(e)},removeFromArray:function(e,o){var f=e.indexOf(o);return f!==-1&&e.splice(f,1),e},getRandomInt:function(e,o){return Math.floor(Math.random()*(o-e+1))+e},degreesToRadians:function(e){return e*n},radiansToDegrees:function(e){return e/n},rotatePoint:function(e,o,f){var r=new u.Point(e.x-o.x,e.y-o.y),_=u.util.rotateVector(r,f);return new u.Point(_.x,_.y).addEquals(o)},rotateVector:function(e,o){var f=u.util.sin(o),r=u.util.cos(o),_=e.x*r-e.y*f,p=e.x*f+e.y*r;return{x:_,y:p}},createVector:function(e,o){return new u.Point(o.x-e.x,o.y-e.y)},calcAngleBetweenVectors:function(e,o){return Math.acos((e.x*o.x+e.y*o.y)/(Math.hypot(e.x,e.y)*Math.hypot(o.x,o.y)))},getHatVector:function(e){return new u.Point(e.x,e.y).multiply(1/Math.hypot(e.x,e.y))},getBisector:function(e,o,f){var r=u.util.createVector(e,o),_=u.util.createVector(e,f),p=u.util.calcAngleBetweenVectors(r,_),S=u.util.calcAngleBetweenVectors(u.util.rotateVector(r,p),_),C=p*(S===0?1:-1)/2;return{vector:u.util.getHatVector(u.util.rotateVector(r,C)),angle:p}},projectStrokeOnPoints:function(e,o,f){var r=[],_=o.strokeWidth/2,p=o.strokeUniform?new u.Point(1/o.scaleX,1/o.scaleY):new u.Point(1,1),S=function(C){var x=_/Math.hypot(C.x,C.y);return new u.Point(C.x*x*p.x,C.y*x*p.y)};return e.length<=1||e.forEach(function(C,x){var P=new u.Point(C.x,C.y),F,z;x===0?(z=e[x+1],F=f?S(u.util.createVector(z,P)).addEquals(P):e[e.length-1]):x===e.length-1?(F=e[x-1],z=f?S(u.util.createVector(F,P)).addEquals(P):e[0]):(F=e[x-1],z=e[x+1]);var K=u.util.getBisector(P,F,z),at=K.vector,_t=K.angle,dt,ct;if(o.strokeLineJoin==="miter"&&(dt=-_/Math.sin(_t/2),ct=new u.Point(at.x*dt*p.x,at.y*dt*p.y),Math.hypot(ct.x,ct.y)/_<=o.strokeMiterLimit)){r.push(P.add(ct)),r.push(P.subtract(ct));return}dt=-_*Math.SQRT2,ct=new u.Point(at.x*dt*p.x,at.y*dt*p.y),r.push(P.add(ct)),r.push(P.subtract(ct))}),r},transformPoint:function(e,o,f){return f?new u.Point(o[0]*e.x+o[2]*e.y,o[1]*e.x+o[3]*e.y):new u.Point(o[0]*e.x+o[2]*e.y+o[4],o[1]*e.x+o[3]*e.y+o[5])},makeBoundingBoxFromPoints:function(e,o){if(o)for(var f=0;f<e.length;f++)e[f]=u.util.transformPoint(e[f],o);var r=[e[0].x,e[1].x,e[2].x,e[3].x],_=u.util.array.min(r),p=u.util.array.max(r),S=p-_,C=[e[0].y,e[1].y,e[2].y,e[3].y],x=u.util.array.min(C),P=u.util.array.max(C),F=P-x;return{left:_,top:x,width:S,height:F}},invertTransform:function(e){var o=1/(e[0]*e[3]-e[1]*e[2]),f=[o*e[3],-o*e[1],-o*e[2],o*e[0]],r=u.util.transformPoint({x:e[4],y:e[5]},f,!0);return f[4]=-r.x,f[5]=-r.y,f},toFixed:function(e,o){return parseFloat(Number(e).toFixed(o))},parseUnit:function(e,o){var f=/\D{0,2}$/.exec(e),r=parseFloat(e);switch(o||(o=u.Text.DEFAULT_SVG_FONT_SIZE),f[0]){case"mm":return r*u.DPI/25.4;case"cm":return r*u.DPI/2.54;case"in":return r*u.DPI;case"pt":return r*u.DPI/72;case"pc":return r*u.DPI/72*12;case"em":return r*o;default:return r}},falseFunction:function(){return!1},getKlass:function(e,o){return e=u.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),u.util.resolveNamespace(o)[e]},getSvgAttributes:function(e){var o=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":o=o.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":o=o.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":o=o.concat(["offset","stop-color","stop-opacity"]);break}return o},resolveNamespace:function(e){if(!e)return u;var o=e.split("."),f=o.length,r,_=g||u.window;for(r=0;r<f;++r)_=_[o[r]];return _},loadImage:function(e,o,f,r){if(!e){o&&o.call(f,e);return}var _=u.util.createImage(),p=function(){o&&o.call(f,_,!1),_=_.onload=_.onerror=null};_.onload=p,_.onerror=function(){u.log("Error loading "+_.src),o&&o.call(f,null,!0),_=_.onload=_.onerror=null},e.indexOf("data")!==0&&r!==void 0&&r!==null&&(_.crossOrigin=r),e.substring(0,14)==="data:image/svg"&&(_.onload=null,u.util.loadImageInDom(_,p)),_.src=e},loadImageInDom:function(e,o){var f=u.document.createElement("div");f.style.width=f.style.height="1px",f.style.left=f.style.top="-100%",f.style.position="absolute",f.appendChild(e),u.document.querySelector("body").appendChild(f),e.onload=function(){o(),f.parentNode.removeChild(f),f=null}},enlivenObjects:function(e,o,f,r){e=e||[];var _=[],p=0,S=e.length;function C(){++p===S&&o&&o(_.filter(function(x){return x}))}if(!S){o&&o(_);return}e.forEach(function(x,P){if(!x||!x.type){C();return}var F=u.util.getKlass(x.type,f);F.fromObject(x,function(z,K){K||(_[P]=z),r&&r(x,z,K),C()})})},enlivenObjectEnlivables:function(e,o,f){var r=u.Object.ENLIVEN_PROPS.filter(function(_){return!!e[_]});u.util.enlivenObjects(r.map(function(_){return e[_]}),function(_){var p={};r.forEach(function(S,C){p[S]=_[C],o&&(o[S]=_[C])}),f&&f(p)})},enlivenPatterns:function(e,o){e=e||[];function f(){++_===p&&o&&o(r)}var r=[],_=0,p=e.length;if(!p){o&&o(r);return}e.forEach(function(S,C){S&&S.source?new u.Pattern(S,function(x){r[C]=x,f()}):(r[C]=S,f())})},groupSVGElements:function(e,o,f){var r;return e&&e.length===1?(typeof f<"u"&&(e[0].sourcePath=f),e[0]):(o&&(o.width&&o.height?o.centerPoint={x:o.width/2,y:o.height/2}:(delete o.width,delete o.height)),r=new u.Group(e,o),typeof f<"u"&&(r.sourcePath=f),r)},populateWithProperties:function(e,o,f){if(f&&Array.isArray(f))for(var r=0,_=f.length;r<_;r++)f[r]in e&&(o[f[r]]=e[f[r]])},createCanvasElement:function(){return u.document.createElement("canvas")},copyCanvasElement:function(e){var o=u.util.createCanvasElement();return o.width=e.width,o.height=e.height,o.getContext("2d").drawImage(e,0,0),o},toDataURL:function(e,o,f){return e.toDataURL("image/"+o,f)},createImage:function(){return u.document.createElement("img")},multiplyTransformMatrices:function(e,o,f){return[e[0]*o[0]+e[2]*o[1],e[1]*o[0]+e[3]*o[1],e[0]*o[2]+e[2]*o[3],e[1]*o[2]+e[3]*o[3],f?0:e[0]*o[4]+e[2]*o[5]+e[4],f?0:e[1]*o[4]+e[3]*o[5]+e[5]]},qrDecompose:function(e){var o=h(e[1],e[0]),f=c(e[0],2)+c(e[1],2),r=s(f),_=(e[0]*e[3]-e[2]*e[1])/r,p=h(e[0]*e[2]+e[1]*e[3],f);return{angle:o/n,scaleX:r,scaleY:_,skewX:p/n,skewY:0,translateX:e[4],translateY:e[5]}},calcRotateMatrix:function(e){if(!e.angle)return u.iMatrix.concat();var o=u.util.degreesToRadians(e.angle),f=u.util.cos(o),r=u.util.sin(o);return[f,r,-r,f,0,0]},calcDimensionsMatrix:function(e){var o=typeof e.scaleX>"u"?1:e.scaleX,f=typeof e.scaleY>"u"?1:e.scaleY,r=[e.flipX?-o:o,0,0,e.flipY?-f:f,0,0],_=u.util.multiplyTransformMatrices,p=u.util.degreesToRadians;return e.skewX&&(r=_(r,[1,0,Math.tan(p(e.skewX)),1],!0)),e.skewY&&(r=_(r,[1,Math.tan(p(e.skewY)),0,1],!0)),r},composeMatrix:function(e){var o=[1,0,0,1,e.translateX||0,e.translateY||0],f=u.util.multiplyTransformMatrices;return e.angle&&(o=f(o,u.util.calcRotateMatrix(e))),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&(o=f(o,u.util.calcDimensionsMatrix(e))),o},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},isTransparent:function(e,o,f,r){r>0&&(o>r?o-=r:o=0,f>r?f-=r:f=0);var _=!0,p,S,C=e.getImageData(o,f,r*2||1,r*2||1),x=C.data.length;for(p=3;p<x&&(S=C.data[p],_=S<=0,_!==!1);p+=4);return C=null,_},parsePreserveAspectRatioAttribute:function(e){var o="meet",f="Mid",r="Mid",_=e.split(" "),p;return _&&_.length&&(o=_.pop(),o!=="meet"&&o!=="slice"?(p=o,o="meet"):_.length&&(p=_.pop())),f=p!=="none"?p.slice(1,4):"none",r=p!=="none"?p.slice(5,8):"none",{meetOrSlice:o,alignX:f,alignY:r}},clearFabricFontCache:function(e){e=(e||"").toLowerCase(),e?u.charWidthsCache[e]&&delete u.charWidthsCache[e]:u.charWidthsCache={}},limitDimsByArea:function(e,o){var f=Math.sqrt(o*e),r=Math.floor(o/f);return{x:Math.floor(f),y:r}},capValue:function(e,o,f){return Math.max(e,Math.min(o,f))},findScaleToFit:function(e,o){return Math.min(o.width/e.width,o.height/e.height)},findScaleToCover:function(e,o){return Math.max(o.width/e.width,o.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map(function(o){return u.util.toFixed(o,u.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(e,o){var f=u.util.invertTransform(o),r=u.util.multiplyTransformMatrices(f,e.calcOwnMatrix());u.util.applyTransformToObject(e,r)},addTransformToObject:function(e,o){u.util.applyTransformToObject(e,u.util.multiplyTransformMatrices(o,e.calcOwnMatrix()))},applyTransformToObject:function(e,o){var f=u.util.qrDecompose(o),r=new u.Point(f.translateX,f.translateY);e.flipX=!1,e.flipY=!1,e.set("scaleX",f.scaleX),e.set("scaleY",f.scaleY),e.skewX=f.skewX,e.skewY=f.skewY,e.angle=f.angle,e.setPositionByOrigin(r,"center","center")},sizeAfterTransform:function(e,o,f){var r=e/2,_=o/2,p=[{x:-r,y:-_},{x:r,y:-_},{x:-r,y:_},{x:r,y:_}],S=u.util.calcDimensionsMatrix(f),C=u.util.makeBoundingBoxFromPoints(p,S);return{x:C.width,y:C.height}},mergeClipPaths:function(e,o){var f=e,r=o;f.inverted&&!r.inverted&&(f=o,r=e),u.util.applyTransformToObject(r,u.util.multiplyTransformMatrices(u.util.invertTransform(f.calcTransformMatrix()),r.calcTransformMatrix()));var _=f.inverted&&r.inverted;return _&&(f.inverted=r.inverted=!1),new u.Group([f],{clipPath:r,inverted:_})},hasStyleChanged:function(e,o,f){return f=f||!1,e.fill!==o.fill||e.stroke!==o.stroke||e.strokeWidth!==o.strokeWidth||e.fontSize!==o.fontSize||e.fontFamily!==o.fontFamily||e.fontWeight!==o.fontWeight||e.fontStyle!==o.fontStyle||e.textBackgroundColor!==o.textBackgroundColor||e.deltaY!==o.deltaY||f&&(e.overline!==o.overline||e.underline!==o.underline||e.linethrough!==o.linethrough)},stylesToArray:function(f,o){for(var f=u.util.object.clone(f,!0),r=o.split(`
`),_=-1,p={},S=[],C=0;C<r.length;C++){if(!f[C]){_+=r[C].length;continue}for(var x=0;x<r[C].length;x++){_++;var P=f[C][x];if(P&&Object.keys(P).length>0){var F=u.util.hasStyleChanged(p,P,!0);F?S.push({start:_,end:_+1,style:P}):S[S.length-1].end++}p=P||{}}}return S},stylesFromArray:function(e,o){if(!Array.isArray(e))return e;for(var f=o.split(`
`),r=-1,_=0,p={},S=0;S<f.length;S++)for(var C=0;C<f[S].length;C++)r++,e[_]&&e[_].start<=r&&r<e[_].end&&(p[S]=p[S]||{},p[S][C]=Object.assign({},e[_].style),r===e[_].end-1&&_++);return p}}}(m),function(){var g=Array.prototype.join,s={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},h={m:"l",M:"L"};function c(D,G,j,B,V,R,O,N,U,Z,$){var st=u.util.cos(D),gt=u.util.sin(D),vt=u.util.cos(G),Q=u.util.sin(G),X=j*V*vt-B*R*Q+O,tt=B*V*vt+j*R*Q+N,nt=Z+U*(-j*V*gt-B*R*st),q=$+U*(-B*V*gt+j*R*st),it=X+U*(j*V*Q+B*R*vt),St=tt+U*(B*V*Q-j*R*vt);return["C",nt,q,it,St,X,tt]}function n(D,G,j,B,V,R,O){var N=Math.PI,U=O*N/180,Z=u.util.sin(U),$=u.util.cos(U),st=0,gt=0;j=Math.abs(j),B=Math.abs(B);var vt=-$*D*.5-Z*G*.5,Q=-$*G*.5+Z*D*.5,X=j*j,tt=B*B,nt=Q*Q,q=vt*vt,it=X*tt-X*nt-tt*q,St=0;if(it<0){var It=Math.sqrt(1-it/(X*tt));j*=It,B*=It}else St=(V===R?-1:1)*Math.sqrt(it/(X*nt+tt*q));var bt=St*j*Q/B,J=-St*B*vt/j,Mt=$*bt-Z*J+D*.5,Pt=Z*bt+$*J+G*.5,Ot=a(1,0,(vt-bt)/j,(Q-J)/B),Ut=a((vt-bt)/j,(Q-J)/B,(-vt-bt)/j,(-Q-J)/B);R===0&&Ut>0?Ut-=2*N:R===1&&Ut<0&&(Ut+=2*N);for(var Lt=Math.ceil(Math.abs(Ut/N*2)),yt=[],xt=Ut/Lt,le=8/3*Math.sin(xt/4)*Math.sin(xt/4)/Math.sin(xt/2),me=Ot+xt,ne=0;ne<Lt;ne++)yt[ne]=c(Ot,me,$,Z,j,B,Mt,Pt,le,st,gt),st=yt[ne][5],gt=yt[ne][6],Ot=me,me+=xt;return yt}function a(D,G,j,B){var V=Math.atan2(G,D),R=Math.atan2(B,j);return R>=V?R-V:2*Math.PI-(V-R)}function e(D,G,j,B,V,R,O,N){var U;if(u.cachesBoundsOfCurve&&(U=g.call(arguments),u.boundsOfCurveCache[U]))return u.boundsOfCurveCache[U];var Z=Math.sqrt,$=Math.min,st=Math.max,gt=Math.abs,vt=[],Q=[[],[]],X,tt,nt,q,it,St,It,bt;tt=6*D-12*j+6*V,X=-3*D+9*j-9*V+3*O,nt=3*j-3*D;for(var J=0;J<2;++J){if(J>0&&(tt=6*G-12*B+6*R,X=-3*G+9*B-9*R+3*N,nt=3*B-3*G),gt(X)<1e-12){if(gt(tt)<1e-12)continue;q=-nt/tt,0<q&&q<1&&vt.push(q);continue}It=tt*tt-4*nt*X,!(It<0)&&(bt=Z(It),it=(-tt+bt)/(2*X),0<it&&it<1&&vt.push(it),St=(-tt-bt)/(2*X),0<St&&St<1&&vt.push(St))}for(var Mt,Pt,Ot=vt.length,Ut=Ot,Lt;Ot--;)q=vt[Ot],Lt=1-q,Mt=Lt*Lt*Lt*D+3*Lt*Lt*q*j+3*Lt*q*q*V+q*q*q*O,Q[0][Ot]=Mt,Pt=Lt*Lt*Lt*G+3*Lt*Lt*q*B+3*Lt*q*q*R+q*q*q*N,Q[1][Ot]=Pt;Q[0][Ut]=D,Q[1][Ut]=G,Q[0][Ut+1]=O,Q[1][Ut+1]=N;var yt=[{x:$.apply(null,Q[0]),y:$.apply(null,Q[1])},{x:st.apply(null,Q[0]),y:st.apply(null,Q[1])}];return u.cachesBoundsOfCurve&&(u.boundsOfCurveCache[U]=yt),yt}function o(D,G,j){for(var B=j[1],V=j[2],R=j[3],O=j[4],N=j[5],U=j[6],Z=j[7],$=n(U-D,Z-G,B,V,O,N,R),st=0,gt=$.length;st<gt;st++)$[st][1]+=D,$[st][2]+=G,$[st][3]+=D,$[st][4]+=G,$[st][5]+=D,$[st][6]+=G;return $}function f(D){var G=0,j=0,B=D.length,V=0,R=0,O,N,U,Z=[],$,st,gt;for(N=0;N<B;++N){switch(U=!1,O=D[N].slice(0),O[0]){case"l":O[0]="L",O[1]+=G,O[2]+=j;case"L":G=O[1],j=O[2];break;case"h":O[1]+=G;case"H":O[0]="L",O[2]=j,G=O[1];break;case"v":O[1]+=j;case"V":O[0]="L",j=O[1],O[1]=G,O[2]=j;break;case"m":O[0]="M",O[1]+=G,O[2]+=j;case"M":G=O[1],j=O[2],V=O[1],R=O[2];break;case"c":O[0]="C",O[1]+=G,O[2]+=j,O[3]+=G,O[4]+=j,O[5]+=G,O[6]+=j;case"C":st=O[3],gt=O[4],G=O[5],j=O[6];break;case"s":O[0]="S",O[1]+=G,O[2]+=j,O[3]+=G,O[4]+=j;case"S":$==="C"?(st=2*G-st,gt=2*j-gt):(st=G,gt=j),G=O[3],j=O[4],O[0]="C",O[5]=O[3],O[6]=O[4],O[3]=O[1],O[4]=O[2],O[1]=st,O[2]=gt,st=O[3],gt=O[4];break;case"q":O[0]="Q",O[1]+=G,O[2]+=j,O[3]+=G,O[4]+=j;case"Q":st=O[1],gt=O[2],G=O[3],j=O[4];break;case"t":O[0]="T",O[1]+=G,O[2]+=j;case"T":$==="Q"?(st=2*G-st,gt=2*j-gt):(st=G,gt=j),O[0]="Q",G=O[1],j=O[2],O[1]=st,O[2]=gt,O[3]=G,O[4]=j;break;case"a":O[0]="A",O[6]+=G,O[7]+=j;case"A":U=!0,Z=Z.concat(o(G,j,O)),G=O[6],j=O[7];break;case"z":case"Z":G=V,j=R;break}U||Z.push(O),$=O[0]}return Z}function r(D,G,j,B){return Math.sqrt((j-D)*(j-D)+(B-G)*(B-G))}function _(D){return D*D*D}function p(D){return 3*D*D*(1-D)}function S(D){return 3*D*(1-D)*(1-D)}function C(D){return(1-D)*(1-D)*(1-D)}function x(D,G,j,B,V,R,O,N){return function(U){var Z=_(U),$=p(U),st=S(U),gt=C(U);return{x:O*Z+V*$+j*st+D*gt,y:N*Z+R*$+B*st+G*gt}}}function P(D,G,j,B,V,R,O,N){return function(U){var Z=1-U,$=3*Z*Z*(j-D)+6*Z*U*(V-j)+3*U*U*(O-V),st=3*Z*Z*(B-G)+6*Z*U*(R-B)+3*U*U*(N-R);return Math.atan2(st,$)}}function F(D){return D*D}function z(D){return 2*D*(1-D)}function K(D){return(1-D)*(1-D)}function at(D,G,j,B,V,R){return function(O){var N=F(O),U=z(O),Z=K(O);return{x:V*N+j*U+D*Z,y:R*N+B*U+G*Z}}}function _t(D,G,j,B,V,R){return function(O){var N=1-O,U=2*N*(j-D)+2*O*(V-j),Z=2*N*(B-G)+2*O*(R-B);return Math.atan2(Z,U)}}function dt(D,G,j){var B={x:G,y:j},V,R=0,O;for(O=1;O<=100;O+=1)V=D(O/100),R+=r(B.x,B.y,V.x,V.y),B=V;return R}function ct(D,G){for(var j=0,B=0,V=D.iterator,R={x:D.x,y:D.y},O,N,U=.01,Z=D.angleFinder,$;B<G&&U>1e-4;)O=V(j),$=j,N=r(R.x,R.y,O.x,O.y),N+B>G?(j-=U,U/=2):(R=O,j+=U,B+=N);return O.angle=Z($),O}function ut(D){for(var G=0,j=D.length,B,V=0,R=0,O=0,N=0,U=[],Z,$,st,gt=0;gt<j;gt++){switch(B=D[gt],$={x:V,y:R,command:B[0]},B[0]){case"M":$.length=0,O=V=B[1],N=R=B[2];break;case"L":$.length=r(V,R,B[1],B[2]),V=B[1],R=B[2];break;case"C":Z=x(V,R,B[1],B[2],B[3],B[4],B[5],B[6]),st=P(V,R,B[1],B[2],B[3],B[4],B[5],B[6]),$.iterator=Z,$.angleFinder=st,$.length=dt(Z,V,R),V=B[5],R=B[6];break;case"Q":Z=at(V,R,B[1],B[2],B[3],B[4]),st=_t(V,R,B[1],B[2],B[3],B[4]),$.iterator=Z,$.angleFinder=st,$.length=dt(Z,V,R),V=B[3],R=B[4];break;case"Z":case"z":$.destX=O,$.destY=N,$.length=r(V,R,O,N),V=O,R=N;break}G+=$.length,U.push($)}return U.push({length:G,x:V,y:R}),U}function ht(D,G,j){j||(j=ut(D));for(var B=0;G-j[B].length>0&&B<j.length-2;)G-=j[B].length,B++;var V=j[B],R=G/V.length,O=V.command,N=D[B],U;switch(O){case"M":return{x:V.x,y:V.y,angle:0};case"Z":case"z":return U=new u.Point(V.x,V.y).lerp(new u.Point(V.destX,V.destY),R),U.angle=Math.atan2(V.destY-V.y,V.destX-V.x),U;case"L":return U=new u.Point(V.x,V.y).lerp(new u.Point(N[1],N[2]),R),U.angle=Math.atan2(N[2]-V.y,N[1]-V.x),U;case"C":return ct(V,G);case"Q":return ct(V,G)}}function kt(D){var G=[],j=[],B,V,R=u.rePathCommand,O="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",N="("+O+")"+u.commaWsp,U="([01])"+u.commaWsp+"?",Z=N+"?"+N+"?"+N+U+U+N+"?("+O+")",$=new RegExp(Z,"g"),st,gt,vt;if(!D||!D.match)return G;vt=D.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var Q=0,X,tt=vt.length;Q<tt;Q++){B=vt[Q],gt=B.slice(1).trim(),j.length=0;var nt=B.charAt(0);if(X=[nt],nt.toLowerCase()==="a")for(var q;q=$.exec(gt);)for(var it=1;it<q.length;it++)j.push(q[it]);else for(;st=R.exec(gt);)j.push(st[0]);for(var it=0,St=j.length;it<St;it++)V=parseFloat(j[it]),isNaN(V)||X.push(V);var It=s[nt.toLowerCase()],bt=h[nt]||nt;if(X.length-1>It)for(var J=1,Mt=X.length;J<Mt;J+=It)G.push([nt].concat(X.slice(J,J+It))),nt=bt;else G.push(X)}return G}function Y(D,G){var j=[],B,V=new u.Point(D[0].x,D[0].y),R=new u.Point(D[1].x,D[1].y),O=D.length,N=1,U=0,Z=O>2;for(G=G||0,Z&&(N=D[2].x<R.x?-1:D[2].x===R.x?0:1,U=D[2].y<R.y?-1:D[2].y===R.y?0:1),j.push(["M",V.x-N*G,V.y-U*G]),B=1;B<O;B++){if(!V.eq(R)){var $=V.midPointFrom(R);j.push(["Q",V.x,V.y,$.x,$.y])}V=D[B],B+1<D.length&&(R=D[B+1])}return Z&&(N=V.x>D[B-2].x?1:V.x===D[B-2].x?0:-1,U=V.y>D[B-2].y?1:V.y===D[B-2].y?0:-1),j.push(["L",V.x+N*G,V.y+U*G]),j}function rt(D,G,j){return j&&(G=u.util.multiplyTransformMatrices(G,[1,0,0,1,-j.x,-j.y])),D.map(function(B){for(var V=B.slice(0),R={},O=1;O<B.length-1;O+=2)R.x=B[O],R.y=B[O+1],R=u.util.transformPoint(R,G),V[O]=R.x,V[O+1]=R.y;return V})}u.util.joinPath=function(D){return D.map(function(G){return G.join(" ")}).join(" ")},u.util.parsePath=kt,u.util.makePathSimpler=f,u.util.getSmoothPathFromPoints=Y,u.util.getPathSegmentsInfo=ut,u.util.getBoundsOfCurve=e,u.util.getPointOnPath=ht,u.util.transformPath=rt}(),function(){var g=Array.prototype.slice;function s(e,o){for(var f=g.call(arguments,2),r=[],_=0,p=e.length;_<p;_++)r[_]=f.length?e[_][o].apply(e[_],f):e[_][o].call(e[_]);return r}function h(e,o){return a(e,o,function(f,r){return f>=r})}function c(e,o){return a(e,o,function(f,r){return f<r})}function n(e,o){for(var f=e.length;f--;)e[f]=o;return e}function a(e,o,f){if(!(!e||e.length===0)){var r=e.length-1,_=o?e[r][o]:e[r];if(o)for(;r--;)f(e[r][o],_)&&(_=e[r][o]);else for(;r--;)f(e[r],_)&&(_=e[r]);return _}}u.util.array={fill:n,invoke:s,min:c,max:h}}(),function(){function g(h,c,n){if(n)if(!u.isLikelyNode&&c instanceof Element)h=c;else if(c instanceof Array){h=[];for(var a=0,e=c.length;a<e;a++)h[a]=g({},c[a],n)}else if(c&&typeof c=="object")for(var o in c)o==="canvas"||o==="group"?h[o]=null:c.hasOwnProperty(o)&&(h[o]=g({},c[o],n));else h=c;else for(var o in c)h[o]=c[o];return h}function s(h,c){return g({},h,c)}u.util.object={extend:g,clone:s},u.util.object.extend(u.util,u.Observable)}(),function(){function g(a){return a.replace(/-+(.)?/g,function(e,o){return o?o.toUpperCase():""})}function s(a,e){return a.charAt(0).toUpperCase()+(e?a.slice(1):a.slice(1).toLowerCase())}function h(a){return a.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(a){var e=0,o,f=[];for(e=0,o;e<a.length;e++)(o=n(a,e))!==!1&&f.push(o);return f}function n(a,e){var o=a.charCodeAt(e);if(isNaN(o))return"";if(o<55296||o>57343)return a.charAt(e);if(55296<=o&&o<=56319){if(a.length<=e+1)throw"High surrogate without following low surrogate";var f=a.charCodeAt(e+1);if(56320>f||f>57343)throw"High surrogate without following low surrogate";return a.charAt(e)+a.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";var r=a.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}u.util.string={camelize:g,capitalize:s,escapeXml:h,graphemeSplit:c}}(),function(){var g=Array.prototype.slice,s=function(){},h=function(){for(var o in{toString:1})if(o==="toString")return!1;return!0}(),c=function(o,f,r){for(var _ in f)_ in o.prototype&&typeof o.prototype[_]=="function"&&(f[_]+"").indexOf("callSuper")>-1?o.prototype[_]=function(p){return function(){var S=this.constructor.superclass;this.constructor.superclass=r;var C=f[p].apply(this,arguments);if(this.constructor.superclass=S,p!=="initialize")return C}}(_):o.prototype[_]=f[_],h&&(f.toString!==Object.prototype.toString&&(o.prototype.toString=f.toString),f.valueOf!==Object.prototype.valueOf&&(o.prototype.valueOf=f.valueOf))};function n(){}function a(o){for(var f=null,r=this;r.constructor.superclass;){var _=r.constructor.superclass.prototype[o];if(r[o]!==_){f=_;break}r=r.constructor.superclass.prototype}return f?arguments.length>1?f.apply(this,g.call(arguments,1)):f.call(this):console.log("tried to callSuper "+o+", method not found in prototype chain",this)}function e(){var o=null,f=g.call(arguments,0);typeof f[0]=="function"&&(o=f.shift());function r(){this.initialize.apply(this,arguments)}r.superclass=o,r.subclasses=[],o&&(n.prototype=o.prototype,r.prototype=new n,o.subclasses.push(r));for(var _=0,p=f.length;_<p;_++)c(r,f[_],o);return r.prototype.initialize||(r.prototype.initialize=s),r.prototype.constructor=r,r.prototype.callSuper=a,r}u.util.createClass=e}(),function(){var g=!!u.document.createElement("div").attachEvent,s=["touchstart","touchmove","touchend"];u.util.addListener=function(c,n,a,e){c&&c.addEventListener(n,a,g?!1:e)},u.util.removeListener=function(c,n,a,e){c&&c.removeEventListener(n,a,g?!1:e)};function h(c){var n=c.changedTouches;return n&&n[0]?n[0]:c}u.util.getPointer=function(c){var n=c.target,a=u.util.getScrollLeftTop(n),e=h(c);return{x:e.clientX+a.left,y:e.clientY+a.top}},u.util.isTouchEvent=function(c){return s.indexOf(c.type)>-1||c.pointerType==="touch"}}(),function(){function g(e,o){var f=e.style;if(!f)return e;if(typeof o=="string")return e.style.cssText+=";"+o,o.indexOf("opacity")>-1?a(e,o.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var r in o)if(r==="opacity")a(e,o[r]);else{var _=r==="float"||r==="cssFloat"?typeof f.styleFloat>"u"?"cssFloat":"styleFloat":r;f.setProperty(_,o[r])}return e}var s=u.document.createElement("div"),h=typeof s.style.opacity=="string",c=typeof s.style.filter=="string",n=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,a=function(e){return e};h?a=function(e,o){return e.style.opacity=o,e}:c&&(a=function(e,o){var f=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(f.zoom=1),n.test(f.filter)?(o=o>=.9999?"":"alpha(opacity="+o*100+")",f.filter=f.filter.replace(n,o)):f.filter+=" alpha(opacity="+o*100+")",e}),u.util.setStyle=g}(),function(){var g=Array.prototype.slice;function s(C){return typeof C=="string"?u.document.getElementById(C):C}var h,c=function(C){return g.call(C,0)};try{h=c(u.document.childNodes)instanceof Array}catch{}h||(c=function(C){for(var x=new Array(C.length),P=C.length;P--;)x[P]=C[P];return x});function n(C,x){var P=u.document.createElement(C);for(var F in x)F==="class"?P.className=x[F]:F==="for"?P.htmlFor=x[F]:P.setAttribute(F,x[F]);return P}function a(C,x){C&&(" "+C.className+" ").indexOf(" "+x+" ")===-1&&(C.className+=(C.className?" ":"")+x)}function e(C,x,P){return typeof x=="string"&&(x=n(x,P)),C.parentNode&&C.parentNode.replaceChild(x,C),x.appendChild(C),x}function o(C){for(var x=0,P=0,F=u.document.documentElement,z=u.document.body||{scrollLeft:0,scrollTop:0};C&&(C.parentNode||C.host)&&(C=C.parentNode||C.host,C===u.document?(x=z.scrollLeft||F.scrollLeft||0,P=z.scrollTop||F.scrollTop||0):(x+=C.scrollLeft||0,P+=C.scrollTop||0),!(C.nodeType===1&&C.style.position==="fixed")););return{left:x,top:P}}function f(C){var x,P=C&&C.ownerDocument,F={left:0,top:0},z={left:0,top:0},K,at={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!P)return z;for(var _t in at)z[at[_t]]+=parseInt(r(C,_t),10)||0;return x=P.documentElement,typeof C.getBoundingClientRect<"u"&&(F=C.getBoundingClientRect()),K=o(C),{left:F.left+K.left-(x.clientLeft||0)+z.left,top:F.top+K.top-(x.clientTop||0)+z.top}}var r;u.document.defaultView&&u.document.defaultView.getComputedStyle?r=function(C,x){var P=u.document.defaultView.getComputedStyle(C,null);return P?P[x]:void 0}:r=function(C,x){var P=C.style[x];return!P&&C.currentStyle&&(P=C.currentStyle[x]),P},function(){var C=u.document.documentElement.style,x="userSelect"in C?"userSelect":"MozUserSelect"in C?"MozUserSelect":"WebkitUserSelect"in C?"WebkitUserSelect":"KhtmlUserSelect"in C?"KhtmlUserSelect":"";function P(z){return typeof z.onselectstart<"u"&&(z.onselectstart=u.util.falseFunction),x?z.style[x]="none":typeof z.unselectable=="string"&&(z.unselectable="on"),z}function F(z){return typeof z.onselectstart<"u"&&(z.onselectstart=null),x?z.style[x]="":typeof z.unselectable=="string"&&(z.unselectable=""),z}u.util.makeElementUnselectable=P,u.util.makeElementSelectable=F}();function _(C){var x=u.jsdomImplForWrapper(C);return x._canvas||x._image}function p(C){if(u.isLikelyNode){var x=u.jsdomImplForWrapper(C);x&&(x._image=null,x._canvas=null,x._currentSrc=null,x._attributes=null,x._classList=null)}}function S(C,x){C.imageSmoothingEnabled=C.imageSmoothingEnabled||C.webkitImageSmoothingEnabled||C.mozImageSmoothingEnabled||C.msImageSmoothingEnabled||C.oImageSmoothingEnabled,C.imageSmoothingEnabled=x}u.util.setImageSmoothing=S,u.util.getById=s,u.util.toArray=c,u.util.addClass=a,u.util.makeElement=n,u.util.wrapElement=e,u.util.getScrollLeftTop=o,u.util.getElementOffset=f,u.util.getNodeCanvas=_,u.util.cleanUpJsdomNode=p}(),function(){function g(c,n){return c+(/\?/.test(c)?"&":"?")+n}function s(){}function h(c,n){n||(n={});var a=n.method?n.method.toUpperCase():"GET",e=n.onComplete||function(){},o=new u.window.XMLHttpRequest,f=n.body||n.parameters;return o.onreadystatechange=function(){o.readyState===4&&(e(o),o.onreadystatechange=s)},a==="GET"&&(f=null,typeof n.parameters=="string"&&(c=g(c,n.parameters))),o.open(a,c,!0),(a==="POST"||a==="PUT")&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(f),o}u.util.request=h}(),u.log=console.log,u.warn=console.warn,function(){var g=u.util.object.extend,s=u.util.object.clone,h=[];u.util.object.extend(h,{cancelAll:function(){var _=this.splice(0);return _.forEach(function(p){p.cancel()}),_},cancelByCanvas:function(_){if(!_)return[];var p=this.filter(function(S){return typeof S.target=="object"&&S.target.canvas===_});return p.forEach(function(S){S.cancel()}),p},cancelByTarget:function(_){var p=this.findAnimationsByTarget(_);return p.forEach(function(S){S.cancel()}),p},findAnimationIndex:function(_){return this.indexOf(this.findAnimation(_))},findAnimation:function(_){return this.find(function(p){return p.cancel===_})},findAnimationsByTarget:function(_){return _?this.filter(function(p){return p.target===_}):[]}});function c(){return!1}function n(_,p,S,C){return-S*Math.cos(_/C*(Math.PI/2))+S+p}function a(_){_||(_={});var p=!1,S,C=function(){var x=u.runningAnimations.indexOf(S);return x>-1&&u.runningAnimations.splice(x,1)[0]};return S=g(s(_),{cancel:function(){return p=!0,C()},currentValue:"startValue"in _?_.startValue:0,completionRate:0,durationRate:0}),u.runningAnimations.push(S),f(function(x){var P=x||+new Date,F=_.duration||500,z=P+F,K,at=_.onChange||c,_t=_.abort||c,dt=_.onComplete||c,ct=_.easing||n,ut="startValue"in _?_.startValue.length>0:!1,ht="startValue"in _?_.startValue:0,kt="endValue"in _?_.endValue:100,Y=_.byValue||(ut?ht.map(function(rt,D){return kt[D]-ht[D]}):kt-ht);_.onStart&&_.onStart(),function rt(D){K=D||+new Date;var G=K>z?F:K-P,j=G/F,B=ut?ht.map(function(R,O){return ct(G,ht[O],Y[O],F)}):ct(G,ht,Y,F),V=Math.abs(ut?(B[0]-ht[0])/Y[0]:(B-ht)/Y);if(S.currentValue=ut?B.slice():B,S.completionRate=V,S.durationRate=j,!p){if(_t(B,V,j)){C();return}if(K>z){S.currentValue=ut?kt.slice():kt,S.completionRate=1,S.durationRate=1,at(ut?kt.slice():kt,1,1),dt(kt,1,1),C();return}else at(B,V,j),f(rt)}}(P)}),S.cancel}var e=u.window.requestAnimationFrame||u.window.webkitRequestAnimationFrame||u.window.mozRequestAnimationFrame||u.window.oRequestAnimationFrame||u.window.msRequestAnimationFrame||function(_){return u.window.setTimeout(_,1e3/60)},o=u.window.cancelAnimationFrame||u.window.clearTimeout;function f(){return e.apply(u.window,arguments)}function r(){return o.apply(u.window,arguments)}u.util.animate=a,u.util.requestAnimFrame=f,u.util.cancelAnimFrame=r,u.runningAnimations=h}(),function(){function g(h,c,n){var a="rgba("+parseInt(h[0]+n*(c[0]-h[0]),10)+","+parseInt(h[1]+n*(c[1]-h[1]),10)+","+parseInt(h[2]+n*(c[2]-h[2]),10);return a+=","+(h&&c?parseFloat(h[3]+n*(c[3]-h[3])):1),a+=")",a}function s(h,c,n,a){var e=new u.Color(h).getSource(),o=new u.Color(c).getSource(),f=a.onComplete,r=a.onChange;return a=a||{},u.util.animate(u.util.object.extend(a,{duration:n||500,startValue:e,endValue:o,byValue:o,easing:function(_,p,S,C){var x=a.colorEasing?a.colorEasing(_,C):1-Math.cos(_/C*(Math.PI/2));return g(p,S,x)},onComplete:function(_,p,S){if(f)return f(g(o,o,0),p,S)},onChange:function(_,p,S){if(r){if(Array.isArray(_))return r(g(_,_,0),p,S);r(_,p,S)}}}))}u.util.animateColor=s}(),function(){function g(D,G,j,B){return D<Math.abs(G)?(D=G,B=j/4):G===0&&D===0?B=j/(2*Math.PI)*Math.asin(1):B=j/(2*Math.PI)*Math.asin(G/D),{a:D,c:G,p:j,s:B}}function s(D,G,j){return D.a*Math.pow(2,10*(G-=1))*Math.sin((G*j-D.s)*(2*Math.PI)/D.p)}function h(D,G,j,B){return j*((D=D/B-1)*D*D+1)+G}function c(D,G,j,B){return D/=B/2,D<1?j/2*D*D*D+G:j/2*((D-=2)*D*D+2)+G}function n(D,G,j,B){return j*(D/=B)*D*D*D+G}function a(D,G,j,B){return-j*((D=D/B-1)*D*D*D-1)+G}function e(D,G,j,B){return D/=B/2,D<1?j/2*D*D*D*D+G:-j/2*((D-=2)*D*D*D-2)+G}function o(D,G,j,B){return j*(D/=B)*D*D*D*D+G}function f(D,G,j,B){return j*((D=D/B-1)*D*D*D*D+1)+G}function r(D,G,j,B){return D/=B/2,D<1?j/2*D*D*D*D*D+G:j/2*((D-=2)*D*D*D*D+2)+G}function _(D,G,j,B){return-j*Math.cos(D/B*(Math.PI/2))+j+G}function p(D,G,j,B){return j*Math.sin(D/B*(Math.PI/2))+G}function S(D,G,j,B){return-j/2*(Math.cos(Math.PI*D/B)-1)+G}function C(D,G,j,B){return D===0?G:j*Math.pow(2,10*(D/B-1))+G}function x(D,G,j,B){return D===B?G+j:j*(-Math.pow(2,-10*D/B)+1)+G}function P(D,G,j,B){return D===0?G:D===B?G+j:(D/=B/2,D<1?j/2*Math.pow(2,10*(D-1))+G:j/2*(-Math.pow(2,-10*--D)+2)+G)}function F(D,G,j,B){return-j*(Math.sqrt(1-(D/=B)*D)-1)+G}function z(D,G,j,B){return j*Math.sqrt(1-(D=D/B-1)*D)+G}function K(D,G,j,B){return D/=B/2,D<1?-j/2*(Math.sqrt(1-D*D)-1)+G:j/2*(Math.sqrt(1-(D-=2)*D)+1)+G}function at(D,G,j,B){var V=1.70158,R=0,O=j;if(D===0)return G;if(D/=B,D===1)return G+j;R||(R=B*.3);var N=g(O,j,R,V);return-s(N,D,B)+G}function _t(D,G,j,B){var V=1.70158,R=0,O=j;if(D===0)return G;if(D/=B,D===1)return G+j;R||(R=B*.3);var N=g(O,j,R,V);return N.a*Math.pow(2,-10*D)*Math.sin((D*B-N.s)*(2*Math.PI)/N.p)+N.c+G}function dt(D,G,j,B){var V=1.70158,R=0,O=j;if(D===0)return G;if(D/=B/2,D===2)return G+j;R||(R=B*(.3*1.5));var N=g(O,j,R,V);return D<1?-.5*s(N,D,B)+G:N.a*Math.pow(2,-10*(D-=1))*Math.sin((D*B-N.s)*(2*Math.PI)/N.p)*.5+N.c+G}function ct(D,G,j,B,V){return V===void 0&&(V=1.70158),j*(D/=B)*D*((V+1)*D-V)+G}function ut(D,G,j,B,V){return V===void 0&&(V=1.70158),j*((D=D/B-1)*D*((V+1)*D+V)+1)+G}function ht(D,G,j,B,V){return V===void 0&&(V=1.70158),D/=B/2,D<1?j/2*(D*D*(((V*=1.525)+1)*D-V))+G:j/2*((D-=2)*D*(((V*=1.525)+1)*D+V)+2)+G}function kt(D,G,j,B){return j-Y(B-D,0,j,B)+G}function Y(D,G,j,B){return(D/=B)<1/2.75?j*(7.5625*D*D)+G:D<2/2.75?j*(7.5625*(D-=1.5/2.75)*D+.75)+G:D<2.5/2.75?j*(7.5625*(D-=2.25/2.75)*D+.9375)+G:j*(7.5625*(D-=2.625/2.75)*D+.984375)+G}function rt(D,G,j,B){return D<B/2?kt(D*2,0,j,B)*.5+G:Y(D*2-B,0,j,B)*.5+j*.5+G}u.util.ease={easeInQuad:function(D,G,j,B){return j*(D/=B)*D+G},easeOutQuad:function(D,G,j,B){return-j*(D/=B)*(D-2)+G},easeInOutQuad:function(D,G,j,B){return D/=B/2,D<1?j/2*D*D+G:-j/2*(--D*(D-2)-1)+G},easeInCubic:function(D,G,j,B){return j*(D/=B)*D*D+G},easeOutCubic:h,easeInOutCubic:c,easeInQuart:n,easeOutQuart:a,easeInOutQuart:e,easeInQuint:o,easeOutQuint:f,easeInOutQuint:r,easeInSine:_,easeOutSine:p,easeInOutSine:S,easeInExpo:C,easeOutExpo:x,easeInOutExpo:P,easeInCirc:F,easeOutCirc:z,easeInOutCirc:K,easeInElastic:at,easeOutElastic:_t,easeInOutElastic:dt,easeInBack:ct,easeOutBack:ut,easeInOutBack:ht,easeInBounce:kt,easeOutBounce:Y,easeInOutBounce:rt}}(),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.util.object.clone,n=s.util.toFixed,a=s.util.parseUnit,e=s.util.multiplyTransformMatrices,o=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],f=["symbol","image","marker","pattern","view","svg"],r=["pattern","defs","symbol","metadata","clipPath","mask","desc"],_=["symbol","g","a","svg","clipPath","defs"],p={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},S={stroke:"strokeOpacity",fill:"fillOpacity"},C="font-size",x="clip-path";s.svgValidTagNamesRegEx=z(o),s.svgViewBoxElementsRegEx=z(f),s.svgInvalidAncestorsRegEx=z(r),s.svgValidParentsRegEx=z(_),s.cssRules={},s.gradientDefs={},s.clipPaths={};function P(R){return R in p?p[R]:R}function F(R,O,N,U){var Z=Array.isArray(O),$;if((R==="fill"||R==="stroke")&&O==="none")O="";else{if(R==="strokeUniform")return O==="non-scaling-stroke";if(R==="strokeDashArray")O==="none"?O=null:O=O.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(R==="transformMatrix")N&&N.transformMatrix?O=e(N.transformMatrix,s.parseTransformAttribute(O)):O=s.parseTransformAttribute(O);else if(R==="visible")O=O!=="none"&&O!=="hidden",N&&N.visible===!1&&(O=!1);else if(R==="opacity")O=parseFloat(O),N&&typeof N.opacity<"u"&&(O*=N.opacity);else if(R==="textAnchor")O=O==="start"?"left":O==="end"?"right":"center";else if(R==="charSpacing")$=a(O,U)/U*1e3;else if(R==="paintFirst"){var st=O.indexOf("fill"),gt=O.indexOf("stroke"),O="fill";(st>-1&&gt>-1&&gt<st||st===-1&&gt>-1)&&(O="stroke")}else{if(R==="href"||R==="xlink:href"||R==="font")return O;if(R==="imageSmoothing")return O==="optimizeQuality";$=Z?O.map(a):a(O,U)}}return!Z&&isNaN($)?O:$}function z(R){return new RegExp("^("+R.join("|")+")\\b","i")}function K(R){for(var O in S)if(!(typeof R[S[O]]>"u"||R[O]==="")){if(typeof R[O]>"u"){if(!s.Object.prototype[O])continue;R[O]=s.Object.prototype[O]}if(R[O].indexOf("url(")!==0){var N=new s.Color(R[O]);R[O]=N.setAlpha(n(N.getAlpha()*R[S[O]],2)).toRgba()}}return R}function at(R,O){var N,U=[],Z,$,st;for($=0,st=O.length;$<st;$++)N=O[$],Z=R.getElementsByTagName(N),U=U.concat(Array.prototype.slice.call(Z));return U}s.parseTransformAttribute=function(){function R(J,Mt){var Pt=s.util.cos(Mt[0]),Ot=s.util.sin(Mt[0]),Ut=0,Lt=0;Mt.length===3&&(Ut=Mt[1],Lt=Mt[2]),J[0]=Pt,J[1]=Ot,J[2]=-Ot,J[3]=Pt,J[4]=Ut-(Pt*Ut-Ot*Lt),J[5]=Lt-(Ot*Ut+Pt*Lt)}function O(J,Mt){var Pt=Mt[0],Ot=Mt.length===2?Mt[1]:Mt[0];J[0]=Pt,J[3]=Ot}function N(J,Mt,Pt){J[Pt]=Math.tan(s.util.degreesToRadians(Mt[0]))}function U(J,Mt){J[4]=Mt[0],Mt.length===2&&(J[5]=Mt[1])}var Z=s.iMatrix,$=s.reNum,st=s.commaWsp,gt="(?:(skewX)\\s*\\(\\s*("+$+")\\s*\\))",vt="(?:(skewY)\\s*\\(\\s*("+$+")\\s*\\))",Q="(?:(rotate)\\s*\\(\\s*("+$+")(?:"+st+"("+$+")"+st+"("+$+"))?\\s*\\))",X="(?:(scale)\\s*\\(\\s*("+$+")(?:"+st+"("+$+"))?\\s*\\))",tt="(?:(translate)\\s*\\(\\s*("+$+")(?:"+st+"("+$+"))?\\s*\\))",nt="(?:(matrix)\\s*\\(\\s*("+$+")"+st+"("+$+")"+st+"("+$+")"+st+"("+$+")"+st+"("+$+")"+st+"("+$+")\\s*\\))",q="(?:"+nt+"|"+tt+"|"+X+"|"+Q+"|"+gt+"|"+vt+")",it="(?:"+q+"(?:"+st+"*"+q+")*)",St="^\\s*(?:"+it+"?)\\s*$",It=new RegExp(St),bt=new RegExp(q,"g");return function(J){var Mt=Z.concat(),Pt=[];if(!J||J&&!It.test(J))return Mt;J.replace(bt,function(Ut){var Lt=new RegExp(q).exec(Ut).filter(function(le){return!!le}),yt=Lt[1],xt=Lt.slice(2).map(parseFloat);switch(yt){case"translate":U(Mt,xt);break;case"rotate":xt[0]=s.util.degreesToRadians(xt[0]),R(Mt,xt);break;case"scale":O(Mt,xt);break;case"skewX":N(Mt,xt,2);break;case"skewY":N(Mt,xt,1);break;case"matrix":Mt=xt;break}Pt.push(Mt.concat()),Mt=Z.concat()});for(var Ot=Pt[0];Pt.length>1;)Pt.shift(),Ot=s.util.multiplyTransformMatrices(Ot,Pt[0]);return Ot}}();function _t(R,O){var N,U;R.replace(/;\s*$/,"").split(";").forEach(function(Z){var $=Z.split(":");N=$[0].trim().toLowerCase(),U=$[1].trim(),O[N]=U})}function dt(R,O){var N,U;for(var Z in R)typeof R[Z]>"u"||(N=Z.toLowerCase(),U=R[Z],O[N]=U)}function ct(R,O){var N={};for(var U in s.cssRules[O])if(ut(R,U.split(" ")))for(var Z in s.cssRules[O][U])N[Z]=s.cssRules[O][U][Z];return N}function ut(R,O){var N,U=!0;return N=kt(R,O.pop()),N&&O.length&&(U=ht(R,O)),N&&U&&O.length===0}function ht(R,O){for(var N,U=!0;R.parentNode&&R.parentNode.nodeType===1&&O.length;)U&&(N=O.pop()),R=R.parentNode,U=kt(R,N);return O.length===0}function kt(R,O){var N=R.nodeName,U=R.getAttribute("class"),Z=R.getAttribute("id"),$,st;if($=new RegExp("^"+N,"i"),O=O.replace($,""),Z&&O.length&&($=new RegExp("#"+Z+"(?![a-zA-Z\\-]+)","i"),O=O.replace($,"")),U&&O.length)for(U=U.split(" "),st=U.length;st--;)$=new RegExp("\\."+U[st]+"(?![a-zA-Z\\-]+)","i"),O=O.replace($,"");return O.length===0}function Y(R,O){var N;if(R.getElementById&&(N=R.getElementById(O)),N)return N;var U,Z,$,st=R.getElementsByTagName("*");for(Z=0,$=st.length;Z<$;Z++)if(U=st[Z],O===U.getAttribute("id"))return U}function rt(R){for(var O=at(R,["use","svg:use"]),N=0;O.length&&N<O.length;){var U=O[N],Z=U.getAttribute("xlink:href")||U.getAttribute("href");if(Z===null)return;var $=Z.slice(1),st=U.getAttribute("x")||0,gt=U.getAttribute("y")||0,vt=Y(R,$).cloneNode(!0),Q=(vt.getAttribute("transform")||"")+" translate("+st+", "+gt+")",X,tt=O.length,nt,q,it,St,It=s.svgNS;if(G(vt),/^svg$/i.test(vt.nodeName)){var bt=vt.ownerDocument.createElementNS(It,"g");for(q=0,it=vt.attributes,St=it.length;q<St;q++)nt=it.item(q),bt.setAttributeNS(It,nt.nodeName,nt.nodeValue);for(;vt.firstChild;)bt.appendChild(vt.firstChild);vt=bt}for(q=0,it=U.attributes,St=it.length;q<St;q++)nt=it.item(q),!(nt.nodeName==="x"||nt.nodeName==="y"||nt.nodeName==="xlink:href"||nt.nodeName==="href")&&(nt.nodeName==="transform"?Q=nt.nodeValue+" "+Q:vt.setAttribute(nt.nodeName,nt.nodeValue));vt.setAttribute("transform",Q),vt.setAttribute("instantiated_by_use","1"),vt.removeAttribute("id"),X=U.parentNode,X.replaceChild(vt,U),O.length===tt&&N++}}var D=new RegExp("^\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*$");function G(R){if(!s.svgViewBoxElementsRegEx.test(R.nodeName))return{};var O=R.getAttribute("viewBox"),N=1,U=1,Z=0,$=0,st,gt,vt,Q,X=R.getAttribute("width"),tt=R.getAttribute("height"),nt=R.getAttribute("x")||0,q=R.getAttribute("y")||0,it=R.getAttribute("preserveAspectRatio")||"",St=!O||!(O=O.match(D)),It=!X||!tt||X==="100%"||tt==="100%",bt=St&&It,J={},Mt="",Pt=0,Ot=0;if(J.width=0,J.height=0,J.toBeParsed=bt,St&&(nt||q)&&R.parentNode&&R.parentNode.nodeName!=="#document"&&(Mt=" translate("+a(nt)+" "+a(q)+") ",vt=(R.getAttribute("transform")||"")+Mt,R.setAttribute("transform",vt),R.removeAttribute("x"),R.removeAttribute("y")),bt)return J;if(St)return J.width=a(X),J.height=a(tt),J;if(Z=-parseFloat(O[1]),$=-parseFloat(O[2]),st=parseFloat(O[3]),gt=parseFloat(O[4]),J.minX=Z,J.minY=$,J.viewBoxWidth=st,J.viewBoxHeight=gt,It?(J.width=st,J.height=gt):(J.width=a(X),J.height=a(tt),N=J.width/st,U=J.height/gt),it=s.util.parsePreserveAspectRatioAttribute(it),it.alignX!=="none"&&(it.meetOrSlice==="meet"&&(U=N=N>U?U:N),it.meetOrSlice==="slice"&&(U=N=N>U?N:U),Pt=J.width-st*N,Ot=J.height-gt*N,it.alignX==="Mid"&&(Pt/=2),it.alignY==="Mid"&&(Ot/=2),it.alignX==="Min"&&(Pt=0),it.alignY==="Min"&&(Ot=0)),N===1&&U===1&&Z===0&&$===0&&nt===0&&q===0)return J;if((nt||q)&&R.parentNode.nodeName!=="#document"&&(Mt=" translate("+a(nt)+" "+a(q)+") "),vt=Mt+" matrix("+N+" 0 0 "+U+" "+(Z*N+Pt)+" "+($*U+Ot)+") ",R.nodeName==="svg"){for(Q=R.ownerDocument.createElementNS(s.svgNS,"g");R.firstChild;)Q.appendChild(R.firstChild);R.appendChild(Q)}else Q=R,Q.removeAttribute("x"),Q.removeAttribute("y"),vt=Q.getAttribute("transform")+vt;return Q.setAttribute("transform",vt),J}function j(R,O){for(;R&&(R=R.parentNode);)if(R.nodeName&&O.test(R.nodeName.replace("svg:",""))&&!R.getAttribute("instantiated_by_use"))return!0;return!1}s.parseSVGDocument=function(R,O,N,U){if(R){rt(R);var Z=s.Object.__uid++,$,st,gt=G(R),vt=s.util.toArray(R.getElementsByTagName("*"));if(gt.crossOrigin=U&&U.crossOrigin,gt.svgUid=Z,vt.length===0&&s.isLikelyNode){vt=R.selectNodes('//*[name(.)!="svg"]');var Q=[];for($=0,st=vt.length;$<st;$++)Q[$]=vt[$];vt=Q}var X=vt.filter(function(nt){return G(nt),s.svgValidTagNamesRegEx.test(nt.nodeName.replace("svg:",""))&&!j(nt,s.svgInvalidAncestorsRegEx)});if(!X||X&&!X.length){O&&O([],{});return}var tt={};vt.filter(function(nt){return nt.nodeName.replace("svg:","")==="clipPath"}).forEach(function(nt){var q=nt.getAttribute("id");tt[q]=s.util.toArray(nt.getElementsByTagName("*")).filter(function(it){return s.svgValidTagNamesRegEx.test(it.nodeName.replace("svg:",""))})}),s.gradientDefs[Z]=s.getGradientDefs(R),s.cssRules[Z]=s.getCSSRules(R),s.clipPaths[Z]=tt,s.parseElements(X,function(nt,q){O&&(O(nt,gt,q,vt),delete s.gradientDefs[Z],delete s.cssRules[Z],delete s.clipPaths[Z])},c(gt),N,U)}};function B(R,O){var N=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],U="xlink:href",Z=O.getAttribute(U).slice(1),$=Y(R,Z);if($&&$.getAttribute(U)&&B(R,$),N.forEach(function(gt){$&&!O.hasAttribute(gt)&&$.hasAttribute(gt)&&O.setAttribute(gt,$.getAttribute(gt))}),!O.children.length)for(var st=$.cloneNode(!0);st.firstChild;)O.appendChild(st.firstChild);O.removeAttribute(U)}var V=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+s.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+s.reNum+"))?\\s+(.*)");h(s,{parseFontDeclaration:function(R,O){var N=R.match(V);if(N){var U=N[1],Z=N[3],$=N[4],st=N[5],gt=N[6];U&&(O.fontStyle=U),Z&&(O.fontWeight=isNaN(parseFloat(Z))?Z:parseFloat(Z)),$&&(O.fontSize=a($)),gt&&(O.fontFamily=gt),st&&(O.lineHeight=st==="normal"?1:st)}},getGradientDefs:function(R){var O=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],N=at(R,O),U,Z=0,$={};for(Z=N.length;Z--;)U=N[Z],U.getAttribute("xlink:href")&&B(R,U),$[U.getAttribute("id")]=U;return $},parseAttributes:function(R,O,N){if(R){var U,Z={},$,st;typeof N>"u"&&(N=R.getAttribute("svgUid")),R.parentNode&&s.svgValidParentsRegEx.test(R.parentNode.nodeName)&&(Z=s.parseAttributes(R.parentNode,O,N));var gt=O.reduce(function(it,St){return U=R.getAttribute(St),U&&(it[St]=U),it},{}),vt=h(ct(R,N),s.parseStyleAttribute(R));gt=h(gt,vt),vt[x]&&R.setAttribute(x,vt[x]),$=st=Z.fontSize||s.Text.DEFAULT_SVG_FONT_SIZE,gt[C]&&(gt[C]=$=a(gt[C],st));var Q,X,tt={};for(var nt in gt)Q=P(nt),X=F(Q,gt[nt],Z,$),tt[Q]=X;tt&&tt.font&&s.parseFontDeclaration(tt.font,tt);var q=h(Z,tt);return s.svgValidParentsRegEx.test(R.nodeName)?q:K(q)}},parseElements:function(R,O,N,U,Z){new s.ElementsParser(R,O,N,U,Z).parse()},parseStyleAttribute:function(R){var O={},N=R.getAttribute("style");return N&&(typeof N=="string"?_t(N,O):dt(N,O)),O},parsePointsAttribute:function(R){if(!R)return null;R=R.replace(/,/g," ").trim(),R=R.split(/\s+/);var O=[],N,U;for(N=0,U=R.length;N<U;N+=2)O.push({x:parseFloat(R[N]),y:parseFloat(R[N+1])});return O},getCSSRules:function(R){var O=R.getElementsByTagName("style"),N,U,Z={},$;for(N=0,U=O.length;N<U;N++){var st=O[N].textContent;st=st.replace(/\/\*[\s\S]*?\*\//g,""),st.trim()!==""&&($=st.split("}"),$=$.filter(function(gt){return gt.trim()}),$.forEach(function(gt){var vt=gt.split("{"),Q={},X=vt[1].trim(),tt=X.split(";").filter(function(St){return St.trim()});for(N=0,U=tt.length;N<U;N++){var nt=tt[N].split(":"),q=nt[0].trim(),it=nt[1].trim();Q[q]=it}gt=vt[0].trim(),gt.split(",").forEach(function(St){St=St.replace(/^svg/i,"").trim(),St!==""&&(Z[St]?s.util.object.extend(Z[St],Q):Z[St]=s.util.object.clone(Q))})}))}return Z},loadSVGFromURL:function(R,O,N,U){R=R.replace(/^\n\s*/,"").trim(),new s.util.request(R,{method:"get",onComplete:Z});function Z($){var st=$.responseXML;if(!st||!st.documentElement)return O&&O(null),!1;s.parseSVGDocument(st.documentElement,function(gt,vt,Q,X){O&&O(gt,vt,Q,X)},N,U)}},loadSVGFromString:function(R,O,N,U){var Z=new s.window.DOMParser,$=Z.parseFromString(R.trim(),"text/xml");s.parseSVGDocument($.documentElement,function(st,gt,vt,Q){O(st,gt,vt,Q)},N,U)}})}(m),u.ElementsParser=function(g,s,h,c,n,a){this.elements=g,this.callback=s,this.options=h,this.reviver=c,this.svgUid=h&&h.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},function(g){g.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},g.createObjects=function(){var s=this;this.elements.forEach(function(h,c){h.setAttribute("svgUid",s.svgUid),s.createObject(h,c)})},g.findTag=function(s){return u[u.util.string.capitalize(s.tagName.replace("svg:",""))]},g.createObject=function(s,h){var c=this.findTag(s);if(c&&c.fromElement)try{c.fromElement(s,this.createCallback(h,s),this.options)}catch(n){u.log(n)}else this.checkIfDone()},g.createCallback=function(s,h){var c=this;return function(n){var a;c.resolveGradient(n,h,"fill"),c.resolveGradient(n,h,"stroke"),n instanceof u.Image&&n._originalElement&&(a=n.parsePreserveAspectRatioAttribute(h)),n._removeTransformMatrix(a),c.resolveClipPath(n,h),c.reviver&&c.reviver(h,n),c.instances[s]=n,c.checkIfDone()}},g.extractPropertyDefinition=function(s,h,c){var n=s[h],a=this.regexUrl;if(a.test(n)){a.lastIndex=0;var e=a.exec(n)[1];return a.lastIndex=0,u[c][this.svgUid][e]}},g.resolveGradient=function(s,h,c){var n=this.extractPropertyDefinition(s,c,"gradientDefs");if(n){var a=h.getAttribute(c+"-opacity"),e=u.Gradient.fromElement(n,s,a,this.options);s.set(c,e)}},g.createClipPathCallback=function(s,h){return function(c){c._removeTransformMatrix(),c.fillRule=c.clipRule,h.push(c)}},g.resolveClipPath=function(s,h){var c=this.extractPropertyDefinition(s,"clipPath","clipPaths"),n,a,e,o,f,r;if(c){o=[],e=u.util.invertTransform(s.calcTransformMatrix());for(var _=c[0].parentNode,p=h;p.parentNode&&p.getAttribute("clip-path")!==s.clipPath;)p=p.parentNode;p.parentNode.appendChild(_);for(var S=0;S<c.length;S++)n=c[S],a=this.findTag(n),a.fromElement(n,this.createClipPathCallback(s,o),this.options);o.length===1?c=o[0]:c=new u.Group(o),f=u.util.multiplyTransformMatrices(e,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,p);var r=u.util.qrDecompose(f);c.flipX=!1,c.flipY=!1,c.set("scaleX",r.scaleX),c.set("scaleY",r.scaleY),c.angle=r.angle,c.skewX=r.skewX,c.skewY=0,c.setPositionByOrigin({x:r.translateX,y:r.translateY},"center","center"),s.clipPath=c}else delete s.clipPath},g.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(s){return s!=null}),this.callback(this.instances,this.elements))}}(u.ElementsParser.prototype),function(g){var s=g.fabric||(g.fabric={});if(s.Point){s.warn("fabric.Point is already defined");return}s.Point=h;function h(c,n){this.x=c,this.y=n}h.prototype={type:"point",constructor:h,add:function(c){return new h(this.x+c.x,this.y+c.y)},addEquals:function(c){return this.x+=c.x,this.y+=c.y,this},scalarAdd:function(c){return new h(this.x+c,this.y+c)},scalarAddEquals:function(c){return this.x+=c,this.y+=c,this},subtract:function(c){return new h(this.x-c.x,this.y-c.y)},subtractEquals:function(c){return this.x-=c.x,this.y-=c.y,this},scalarSubtract:function(c){return new h(this.x-c,this.y-c)},scalarSubtractEquals:function(c){return this.x-=c,this.y-=c,this},multiply:function(c){return new h(this.x*c,this.y*c)},multiplyEquals:function(c){return this.x*=c,this.y*=c,this},divide:function(c){return new h(this.x/c,this.y/c)},divideEquals:function(c){return this.x/=c,this.y/=c,this},eq:function(c){return this.x===c.x&&this.y===c.y},lt:function(c){return this.x<c.x&&this.y<c.y},lte:function(c){return this.x<=c.x&&this.y<=c.y},gt:function(c){return this.x>c.x&&this.y>c.y},gte:function(c){return this.x>=c.x&&this.y>=c.y},lerp:function(c,n){return typeof n>"u"&&(n=.5),n=Math.max(Math.min(1,n),0),new h(this.x+(c.x-this.x)*n,this.y+(c.y-this.y)*n)},distanceFrom:function(c){var n=this.x-c.x,a=this.y-c.y;return Math.sqrt(n*n+a*a)},midPointFrom:function(c){return this.lerp(c)},min:function(c){return new h(Math.min(this.x,c.x),Math.min(this.y,c.y))},max:function(c){return new h(Math.max(this.x,c.x),Math.max(this.y,c.y))},toString:function(){return this.x+","+this.y},setXY:function(c,n){return this.x=c,this.y=n,this},setX:function(c){return this.x=c,this},setY:function(c){return this.y=c,this},setFromPoint:function(c){return this.x=c.x,this.y=c.y,this},swap:function(c){var n=this.x,a=this.y;this.x=c.x,this.y=c.y,c.x=n,c.y=a},clone:function(){return new h(this.x,this.y)}}}(m),function(g){var s=g.fabric||(g.fabric={});if(s.Intersection){s.warn("fabric.Intersection is already defined");return}function h(c){this.status=c,this.points=[]}s.Intersection=h,s.Intersection.prototype={constructor:h,appendPoint:function(c){return this.points.push(c),this},appendPoints:function(c){return this.points=this.points.concat(c),this}},s.Intersection.intersectLineLine=function(c,n,a,e){var o,f=(e.x-a.x)*(c.y-a.y)-(e.y-a.y)*(c.x-a.x),r=(n.x-c.x)*(c.y-a.y)-(n.y-c.y)*(c.x-a.x),_=(e.y-a.y)*(n.x-c.x)-(e.x-a.x)*(n.y-c.y);if(_!==0){var p=f/_,S=r/_;0<=p&&p<=1&&0<=S&&S<=1?(o=new h("Intersection"),o.appendPoint(new s.Point(c.x+p*(n.x-c.x),c.y+p*(n.y-c.y)))):o=new h}else f===0||r===0?o=new h("Coincident"):o=new h("Parallel");return o},s.Intersection.intersectLinePolygon=function(c,n,a){var e=new h,o=a.length,f,r,_,p;for(p=0;p<o;p++)f=a[p],r=a[(p+1)%o],_=h.intersectLineLine(c,n,f,r),e.appendPoints(_.points);return e.points.length>0&&(e.status="Intersection"),e},s.Intersection.intersectPolygonPolygon=function(c,n){var a=new h,e=c.length,o;for(o=0;o<e;o++){var f=c[o],r=c[(o+1)%e],_=h.intersectLinePolygon(f,r,n);a.appendPoints(_.points)}return a.points.length>0&&(a.status="Intersection"),a},s.Intersection.intersectPolygonRectangle=function(c,n,a){var e=n.min(a),o=n.max(a),f=new s.Point(o.x,e.y),r=new s.Point(e.x,o.y),_=h.intersectLinePolygon(e,f,c),p=h.intersectLinePolygon(f,o,c),S=h.intersectLinePolygon(o,r,c),C=h.intersectLinePolygon(r,e,c),x=new h;return x.appendPoints(_.points),x.appendPoints(p.points),x.appendPoints(S.points),x.appendPoints(C.points),x.points.length>0&&(x.status="Intersection"),x}}(m),function(g){var s=g.fabric||(g.fabric={});if(s.Color){s.warn("fabric.Color is already defined.");return}function h(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}s.Color=h,s.Color.prototype={_tryParsingColor:function(n){var a;n in h.colorNameMap&&(n=h.colorNameMap[n]),n==="transparent"&&(a=[255,255,255,0]),a||(a=h.sourceFromHex(n)),a||(a=h.sourceFromRgb(n)),a||(a=h.sourceFromHsl(n)),a||(a=[0,0,0,1]),a&&this.setSource(a)},_rgbToHsl:function(n,a,e){n/=255,a/=255,e/=255;var o,f,r,_=s.util.array.max([n,a,e]),p=s.util.array.min([n,a,e]);if(r=(_+p)/2,_===p)o=f=0;else{var S=_-p;switch(f=r>.5?S/(2-_-p):S/(_+p),_){case n:o=(a-e)/S+(a<e?6:0);break;case a:o=(e-n)/S+2;break;case e:o=(n-a)/S+4;break}o/=6}return[Math.round(o*360),Math.round(f*100),Math.round(r*100)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+a[0]+","+a[1]+"%,"+a[2]+"%)"},toHsla:function(){var n=this.getSource(),a=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+n[3]+")"},toHex:function(){var n=this.getSource(),a,e,o;return a=n[0].toString(16),a=a.length===1?"0"+a:a,e=n[1].toString(16),e=e.length===1?"0"+e:e,o=n[2].toString(16),o=o.length===1?"0"+o:o,a.toUpperCase()+e.toUpperCase()+o.toUpperCase()},toHexa:function(){var n=this.getSource(),a;return a=Math.round(n[3]*255),a=a.toString(16),a=a.length===1?"0"+a:a,this.toHex()+a.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var a=this.getSource();return a[3]=n,this.setSource(a),this},toGrayscale:function(){var n=this.getSource(),a=parseInt((n[0]*.3+n[1]*.59+n[2]*.11).toFixed(0),10),e=n[3];return this.setSource([a,a,a,e]),this},toBlackWhite:function(n){var a=this.getSource(),e=(a[0]*.3+a[1]*.59+a[2]*.11).toFixed(0),o=a[3];return n=n||127,e=Number(e)<Number(n)?0:255,this.setSource([e,e,e,o]),this},overlayWith:function(n){n instanceof h||(n=new h(n));var a=[],e=this.getAlpha(),o=.5,f=this.getSource(),r=n.getSource(),_;for(_=0;_<3;_++)a.push(Math.round(f[_]*(1-o)+r[_]*o));return a[3]=e,this.setSource(a),this}},s.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,s.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,s.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,s.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function c(n,a,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(a-n)*6*e:e<1/2?a:e<2/3?n+(a-n)*(2/3-e)*6:n}s.Color.fromRgb=function(n){return h.fromSource(h.sourceFromRgb(n))},s.Color.sourceFromRgb=function(n){var a=n.match(h.reRGBa);if(a){var e=parseInt(a[1],10)/(/%$/.test(a[1])?100:1)*(/%$/.test(a[1])?255:1),o=parseInt(a[2],10)/(/%$/.test(a[2])?100:1)*(/%$/.test(a[2])?255:1),f=parseInt(a[3],10)/(/%$/.test(a[3])?100:1)*(/%$/.test(a[3])?255:1);return[parseInt(e,10),parseInt(o,10),parseInt(f,10),a[4]?parseFloat(a[4]):1]}},s.Color.fromRgba=h.fromRgb,s.Color.fromHsl=function(n){return h.fromSource(h.sourceFromHsl(n))},s.Color.sourceFromHsl=function(n){var a=n.match(h.reHSLa);if(a){var e=(parseFloat(a[1])%360+360)%360/360,o=parseFloat(a[2])/(/%$/.test(a[2])?100:1),f=parseFloat(a[3])/(/%$/.test(a[3])?100:1),r,_,p;if(o===0)r=_=p=f;else{var S=f<=.5?f*(o+1):f+o-f*o,C=f*2-S;r=c(C,S,e+1/3),_=c(C,S,e),p=c(C,S,e-1/3)}return[Math.round(r*255),Math.round(_*255),Math.round(p*255),a[4]?parseFloat(a[4]):1]}},s.Color.fromHsla=h.fromHsl,s.Color.fromHex=function(n){return h.fromSource(h.sourceFromHex(n))},s.Color.sourceFromHex=function(n){if(n.match(h.reHex)){var a=n.slice(n.indexOf("#")+1),e=a.length===3||a.length===4,o=a.length===8||a.length===4,f=e?a.charAt(0)+a.charAt(0):a.substring(0,2),r=e?a.charAt(1)+a.charAt(1):a.substring(2,4),_=e?a.charAt(2)+a.charAt(2):a.substring(4,6),p=o?e?a.charAt(3)+a.charAt(3):a.substring(6,8):"FF";return[parseInt(f,16),parseInt(r,16),parseInt(_,16),parseFloat((parseInt(p,16)/255).toFixed(2))]}},s.Color.fromSource=function(n){var a=new h;return a.setSource(n),a}}(m),function(g){var s=g.fabric||(g.fabric={}),h=["e","se","s","sw","w","nw","n","ne","e"],c=["ns","nesw","ew","nwse"],n={},a="left",e="top",o="right",f="bottom",r="center",_={top:f,bottom:e,left:o,right:a,center:r},p=s.util.radiansToDegrees,S=Math.sign||function(Q){return(Q>0)-(Q<0)||+Q};function C(Q,X){var tt=Q.angle+p(Math.atan2(X.y,X.x))+360;return Math.round(tt%360/45)}function x(Q,X){var tt=X.transform.target,nt=tt.canvas,q=s.util.object.clone(X);q.target=tt,nt&&nt.fire("object:"+Q,q),tt.fire(Q,X)}function P(Q,X){var tt=X.canvas,nt=tt.uniScaleKey,q=Q[nt];return tt.uniformScaling&&!q||!tt.uniformScaling&&q}function F(Q){return Q.originX===r&&Q.originY===r}function z(Q,X,tt){var nt=Q.lockScalingX,q=Q.lockScalingY;return!!(nt&&q||!X&&(nt||q)&&tt||nt&&X==="x"||q&&X==="y")}function K(Q,X,tt){var nt="not-allowed",q=P(Q,tt),it="";if(X.x!==0&&X.y===0?it="x":X.x===0&&X.y!==0&&(it="y"),z(tt,it,q))return nt;var St=C(tt,X);return h[St]+"-resize"}function at(Q,X,tt){var nt="not-allowed";if(X.x!==0&&tt.lockSkewingY||X.y!==0&&tt.lockSkewingX)return nt;var q=C(tt,X)%4;return c[q]+"-resize"}function _t(Q,X,tt){return Q[tt.canvas.altActionKey]?n.skewCursorStyleHandler(Q,X,tt):n.scaleCursorStyleHandler(Q,X,tt)}function dt(Q,X,tt){var nt=Q[tt.canvas.altActionKey];if(X.x===0)return nt?"skewX":"scaleY";if(X.y===0)return nt?"skewY":"scaleX"}function ct(Q,X,tt){return tt.lockRotation?"not-allowed":X.cursorStyle}function ut(Q,X,tt,nt){return{e:Q,transform:X,pointer:{x:tt,y:nt}}}function ht(Q){return function(X,tt,nt,q){var it=tt.target,St=it.getCenterPoint(),It=it.translateToOriginPoint(St,tt.originX,tt.originY),bt=Q(X,tt,nt,q);return it.setPositionByOrigin(It,tt.originX,tt.originY),bt}}function kt(Q,X){return function(tt,nt,q,it){var St=X(tt,nt,q,it);return St&&x(Q,ut(tt,nt,q,it)),St}}function Y(Q,X,tt,nt,q){var it=Q.target,St=it.controls[Q.corner],It=it.canvas.getZoom(),bt=it.padding/It,J=it.toLocalPoint(new s.Point(nt,q),X,tt);return J.x>=bt&&(J.x-=bt),J.x<=-bt&&(J.x+=bt),J.y>=bt&&(J.y-=bt),J.y<=bt&&(J.y+=bt),J.x-=St.offsetX,J.y-=St.offsetY,J}function rt(Q){return Q.flipX!==Q.flipY}function D(Q,X,tt,nt,q){if(Q[X]!==0){var it=Q._getTransformedDimensions()[nt],St=q/it*Q[tt];Q.set(tt,St)}}function G(Q,X,tt,nt){var q=X.target,it=q._getTransformedDimensions(0,q.skewY),St=Y(X,X.originX,X.originY,tt,nt),It=Math.abs(St.x*2)-it.x,bt=q.skewX,J;It<2?J=0:(J=p(Math.atan2(It/q.scaleX,it.y/q.scaleY)),X.originX===a&&X.originY===f&&(J=-J),X.originX===o&&X.originY===e&&(J=-J),rt(q)&&(J=-J));var Mt=bt!==J;if(Mt){var Pt=q._getTransformedDimensions().y;q.set("skewX",J),D(q,"skewY","scaleY","y",Pt)}return Mt}function j(Q,X,tt,nt){var q=X.target,it=q._getTransformedDimensions(q.skewX,0),St=Y(X,X.originX,X.originY,tt,nt),It=Math.abs(St.y*2)-it.y,bt=q.skewY,J;It<2?J=0:(J=p(Math.atan2(It/q.scaleY,it.x/q.scaleX)),X.originX===a&&X.originY===f&&(J=-J),X.originX===o&&X.originY===e&&(J=-J),rt(q)&&(J=-J));var Mt=bt!==J;if(Mt){var Pt=q._getTransformedDimensions().x;q.set("skewY",J),D(q,"skewX","scaleX","x",Pt)}return Mt}function B(Q,X,tt,nt){var q=X.target,it=q.skewX,St,It=X.originY;if(q.lockSkewingX)return!1;if(it===0){var bt=Y(X,r,r,tt,nt);bt.x>0?St=a:St=o}else it>0&&(St=It===e?a:o),it<0&&(St=It===e?o:a),rt(q)&&(St=St===a?o:a);X.originX=St;var J=kt("skewing",ht(G));return J(Q,X,tt,nt)}function V(Q,X,tt,nt){var q=X.target,it=q.skewY,St,It=X.originX;if(q.lockSkewingY)return!1;if(it===0){var bt=Y(X,r,r,tt,nt);bt.y>0?St=e:St=f}else it>0&&(St=It===a?e:f),it<0&&(St=It===a?f:e),rt(q)&&(St=St===e?f:e);X.originY=St;var J=kt("skewing",ht(j));return J(Q,X,tt,nt)}function R(Q,X,tt,nt){var q=X,it=q.target,St=it.translateToOriginPoint(it.getCenterPoint(),q.originX,q.originY);if(it.lockRotation)return!1;var It=Math.atan2(q.ey-St.y,q.ex-St.x),bt=Math.atan2(nt-St.y,tt-St.x),J=p(bt-It+q.theta),Mt=!0;if(it.snapAngle>0){var Pt=it.snapAngle,Ot=it.snapThreshold||Pt,Ut=Math.ceil(J/Pt)*Pt,Lt=Math.floor(J/Pt)*Pt;Math.abs(J-Lt)<Ot?J=Lt:Math.abs(J-Ut)<Ot&&(J=Ut)}return J<0&&(J=360+J),J%=360,Mt=it.angle!==J,it.angle=J,Mt}function O(Q,X,tt,nt,q){q=q||{};var it=X.target,St=it.lockScalingX,It=it.lockScalingY,bt=q.by,J,Mt,Pt,Ot,Ut=P(Q,it),Lt=z(it,bt,Ut),yt,xt,le=X.gestureScale;if(Lt)return!1;if(le)Mt=X.scaleX*le,Pt=X.scaleY*le;else{if(J=Y(X,X.originX,X.originY,tt,nt),yt=bt!=="y"?S(J.x):1,xt=bt!=="x"?S(J.y):1,X.signX||(X.signX=yt),X.signY||(X.signY=xt),it.lockScalingFlip&&(X.signX!==yt||X.signY!==xt))return!1;if(Ot=it._getTransformedDimensions(),Ut&&!bt){var me=Math.abs(J.x)+Math.abs(J.y),ne=X.original,Bn=Math.abs(Ot.x*ne.scaleX/it.scaleX)+Math.abs(Ot.y*ne.scaleY/it.scaleY),Te=me/Bn;Mt=ne.scaleX*Te,Pt=ne.scaleY*Te}else Mt=Math.abs(J.x*it.scaleX/Ot.x),Pt=Math.abs(J.y*it.scaleY/Ot.y);F(X)&&(Mt*=2,Pt*=2),X.signX!==yt&&bt!=="y"&&(X.originX=_[X.originX],Mt*=-1,X.signX=yt),X.signY!==xt&&bt!=="x"&&(X.originY=_[X.originY],Pt*=-1,X.signY=xt)}var Ht=it.scaleX,jn=it.scaleY;return bt?(bt==="x"&&it.set("scaleX",Mt),bt==="y"&&it.set("scaleY",Pt)):(!St&&it.set("scaleX",Mt),!It&&it.set("scaleY",Pt)),Ht!==it.scaleX||jn!==it.scaleY}function N(Q,X,tt,nt){return O(Q,X,tt,nt)}function U(Q,X,tt,nt){return O(Q,X,tt,nt,{by:"x"})}function Z(Q,X,tt,nt){return O(Q,X,tt,nt,{by:"y"})}function $(Q,X,tt,nt){return Q[X.target.canvas.altActionKey]?n.skewHandlerX(Q,X,tt,nt):n.scalingY(Q,X,tt,nt)}function st(Q,X,tt,nt){return Q[X.target.canvas.altActionKey]?n.skewHandlerY(Q,X,tt,nt):n.scalingX(Q,X,tt,nt)}function gt(Q,X,tt,nt){var q=X.target,it=Y(X,X.originX,X.originY,tt,nt),St=q.strokeWidth/(q.strokeUniform?q.scaleX:1),It=F(X)?2:1,bt=q.width,J=Math.abs(it.x*It/q.scaleX)-St;return q.set("width",Math.max(J,0)),bt!==J}function vt(Q,X,tt,nt){var q=X.target,it=tt-X.offsetX,St=nt-X.offsetY,It=!q.get("lockMovementX")&&q.left!==it,bt=!q.get("lockMovementY")&&q.top!==St;return It&&q.set("left",it),bt&&q.set("top",St),(It||bt)&&x("moving",ut(Q,X,tt,nt)),It||bt}n.scaleCursorStyleHandler=K,n.skewCursorStyleHandler=at,n.scaleSkewCursorStyleHandler=_t,n.rotationWithSnapping=kt("rotating",ht(R)),n.scalingEqually=kt("scaling",ht(N)),n.scalingX=kt("scaling",ht(U)),n.scalingY=kt("scaling",ht(Z)),n.scalingYOrSkewingX=$,n.scalingXOrSkewingY=st,n.changeWidth=kt("resizing",ht(gt)),n.skewHandlerX=B,n.skewHandlerY=V,n.dragHandler=vt,n.scaleOrSkewActionName=dt,n.rotationStyleHandler=ct,n.fireEvent=x,n.wrapWithFixedAnchor=ht,n.wrapWithFireEvent=kt,n.getLocalPoint=Y,s.controlsUtils=n}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.degreesToRadians,c=s.controlsUtils;function n(e,o,f,r,_){r=r||{};var p=this.sizeX||r.cornerSize||_.cornerSize,S=this.sizeY||r.cornerSize||_.cornerSize,C=typeof r.transparentCorners<"u"?r.transparentCorners:_.transparentCorners,x=C?"stroke":"fill",P=!C&&(r.cornerStrokeColor||_.cornerStrokeColor),F=o,z=f,K;e.save(),e.fillStyle=r.cornerColor||_.cornerColor,e.strokeStyle=r.cornerStrokeColor||_.cornerStrokeColor,p>S?(K=p,e.scale(1,S/p),z=f*p/S):S>p?(K=S,e.scale(p/S,1),F=o*S/p):K=p,e.lineWidth=1,e.beginPath(),e.arc(F,z,K/2,0,2*Math.PI,!1),e[x](),P&&e.stroke(),e.restore()}function a(e,o,f,r,_){r=r||{};var p=this.sizeX||r.cornerSize||_.cornerSize,S=this.sizeY||r.cornerSize||_.cornerSize,C=typeof r.transparentCorners<"u"?r.transparentCorners:_.transparentCorners,x=C?"stroke":"fill",P=!C&&(r.cornerStrokeColor||_.cornerStrokeColor),F=p/2,z=S/2;e.save(),e.fillStyle=r.cornerColor||_.cornerColor,e.strokeStyle=r.cornerStrokeColor||_.cornerStrokeColor,e.lineWidth=1,e.translate(o,f),e.rotate(h(_.angle)),e[x+"Rect"](-F,-z,p,S),P&&e.strokeRect(-F,-z,p,S),e.restore()}c.renderCircleControl=n,c.renderSquareControl=a}(m),function(g){var s=g.fabric||(g.fabric={});function h(c){for(var n in c)this[n]=c[n]}s.Control=h,s.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(c,n){return n.cursorStyle},getActionName:function(c,n){return n.actionName},getVisibility:function(c,n){var a=c._controlsVisibility;return a&&typeof a[n]<"u"?a[n]:this.visible},setVisibility:function(c){this.visible=c},positionHandler:function(c,n){var a=s.util.transformPoint({x:this.x*c.x+this.offsetX,y:this.y*c.y+this.offsetY},n);return a},calcCornerCoords:function(c,n,a,e,o){var f,r,_,p,S=o?this.touchSizeX:this.sizeX,C=o?this.touchSizeY:this.sizeY;if(S&&C&&S!==C){var x=Math.atan2(C,S),P=Math.sqrt(S*S+C*C)/2,F=x-s.util.degreesToRadians(c),z=Math.PI/2-x-s.util.degreesToRadians(c);f=P*s.util.cos(F),r=P*s.util.sin(F),_=P*s.util.cos(z),p=P*s.util.sin(z)}else{var K=S&&C?S:n;P=K*.7071067812;var F=s.util.degreesToRadians(45-c);f=_=P*s.util.cos(F),r=p=P*s.util.sin(F)}return{tl:{x:a-p,y:e-_},tr:{x:a+f,y:e-r},bl:{x:a-f,y:e+r},br:{x:a+p,y:e+_}}},render:function(c,n,a,e,o){switch(e=e||{},e.cornerStyle||o.cornerStyle){case"circle":s.controlsUtils.renderCircleControl.call(this,c,n,a,e,o);break;default:s.controlsUtils.renderSquareControl.call(this,c,n,a,e,o)}}}}(m),function(){function g(a,e){var o=a.getAttribute("style"),f=a.getAttribute("offset")||0,r,_,p,S;if(f=parseFloat(f)/(/%$/.test(f)?100:1),f=f<0?0:f>1?1:f,o){var C=o.split(/\s*;\s*/);for(C[C.length-1]===""&&C.pop(),S=C.length;S--;){var x=C[S].split(/\s*:\s*/),P=x[0].trim(),F=x[1].trim();P==="stop-color"?r=F:P==="stop-opacity"&&(p=F)}}return r||(r=a.getAttribute("stop-color")||"rgb(0,0,0)"),p||(p=a.getAttribute("stop-opacity")),r=new u.Color(r),_=r.getAlpha(),p=isNaN(parseFloat(p))?1:parseFloat(p),p*=_*e,{offset:f,color:r.toRgb(),opacity:p}}function s(a){return{x1:a.getAttribute("x1")||0,y1:a.getAttribute("y1")||0,x2:a.getAttribute("x2")||"100%",y2:a.getAttribute("y2")||0}}function h(a){return{x1:a.getAttribute("fx")||a.getAttribute("cx")||"50%",y1:a.getAttribute("fy")||a.getAttribute("cy")||"50%",r1:0,x2:a.getAttribute("cx")||"50%",y2:a.getAttribute("cy")||"50%",r2:a.getAttribute("r")||"50%"}}var c=u.util.object.clone;u.Gradient=u.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(a){a||(a={}),a.coords||(a.coords={});var e,o=this;Object.keys(a).forEach(function(f){o[f]=a[f]}),this.id?this.id+="_"+u.Object.__uid++:this.id=u.Object.__uid++,e={x1:a.coords.x1||0,y1:a.coords.y1||0,x2:a.coords.x2||0,y2:a.coords.y2||0},this.type==="radial"&&(e.r1=a.coords.r1||0,e.r2=a.coords.r2||0),this.coords=e,this.colorStops=a.colorStops.slice()},addColorStop:function(a){for(var e in a){var o=new u.Color(a[e]);this.colorStops.push({offset:parseFloat(e),color:o.toRgb(),opacity:o.getAlpha()})}return this},toObject:function(a){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return u.util.populateWithProperties(this,e,a),e},toSVG:function(a,_){var o=c(this.coords,!0),f,r,_=_||{},p,S,C=c(this.colorStops,!0),x=o.r1>o.r2,P=this.gradientTransform?this.gradientTransform.concat():u.iMatrix.concat(),F=-this.offsetX,z=-this.offsetY,K=!!_.additionalTransform,at=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(C.sort(function(ht,kt){return ht.offset-kt.offset}),at==="objectBoundingBox"?(F/=a.width,z/=a.height):(F+=a.width/2,z+=a.height/2),a.type==="path"&&this.gradientUnits!=="percentage"&&(F-=a.pathOffset.x,z-=a.pathOffset.y),P[4]-=F,P[5]-=z,S='id="SVGID_'+this.id+'" gradientUnits="'+at+'"',S+=' gradientTransform="'+(K?_.additionalTransform+" ":"")+u.util.matrixToSVG(P)+'" ',this.type==="linear"?p=["<linearGradient ",S,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,`">
`]:this.type==="radial"&&(p=["<radialGradient ",S,' cx="',x?o.x1:o.x2,'" cy="',x?o.y1:o.y2,'" r="',x?o.r1:o.r2,'" fx="',x?o.x2:o.x1,'" fy="',x?o.y2:o.y1,`">
`]),this.type==="radial"){if(x)for(C=C.concat(),C.reverse(),f=0,r=C.length;f<r;f++)C[f].offset=1-C[f].offset;var _t=Math.min(o.r1,o.r2);if(_t>0){var dt=Math.max(o.r1,o.r2),ct=_t/dt;for(f=0,r=C.length;f<r;f++)C[f].offset+=ct*(1-C[f].offset)}}for(f=0,r=C.length;f<r;f++){var ut=C[f];p.push("<stop ",'offset="',ut.offset*100+"%",'" style="stop-color:',ut.color,typeof ut.opacity<"u"?";stop-opacity: "+ut.opacity:";",`"/>
`)}return p.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),p.join("")},toLive:function(a){var e,o=u.util.object.clone(this.coords),f,r;if(this.type){for(this.type==="linear"?e=a.createLinearGradient(o.x1,o.y1,o.x2,o.y2):this.type==="radial"&&(e=a.createRadialGradient(o.x1,o.y1,o.r1,o.x2,o.y2,o.r2)),f=0,r=this.colorStops.length;f<r;f++){var _=this.colorStops[f].color,p=this.colorStops[f].opacity,S=this.colorStops[f].offset;typeof p<"u"&&(_=new u.Color(_).setAlpha(p).toRgba()),e.addColorStop(S,_)}return e}}}),u.util.object.extend(u.Gradient,{fromElement:function(a,e,o,f){var r=parseFloat(o)/(/%$/.test(o)?100:1);r=r<0?0:r>1?1:r,isNaN(r)&&(r=1);var _=a.getElementsByTagName("stop"),p,S=a.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",C=a.getAttribute("gradientTransform")||"",x=[],P,F,z=0,K=0,at;for(a.nodeName==="linearGradient"||a.nodeName==="LINEARGRADIENT"?(p="linear",P=s(a)):(p="radial",P=h(a)),F=_.length;F--;)x.push(g(_[F],r));at=u.parseTransformAttribute(C),n(e,P,f,S),S==="pixels"&&(z=-e.left,K=-e.top);var _t=new u.Gradient({id:a.getAttribute("id"),type:p,coords:P,colorStops:x,gradientUnits:S,gradientTransform:at,offsetX:z,offsetY:K});return _t}});function n(a,e,o,f){var r,_;Object.keys(e).forEach(function(p){r=e[p],r==="Infinity"?_=1:r==="-Infinity"?_=0:(_=parseFloat(e[p],10),typeof r=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(r)&&(_*=.01,f==="pixels"&&((p==="x1"||p==="x2"||p==="r2")&&(_*=o.viewBoxWidth||o.width),(p==="y1"||p==="y2")&&(_*=o.viewBoxHeight||o.height)))),e[p]=_})}}(),function(){var g=u.util.toFixed;u.Pattern=u.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(s,h){if(s||(s={}),this.id=u.Object.__uid++,this.setOptions(s),!s.source||s.source&&typeof s.source!="string"){h&&h(this);return}else{var c=this;this.source=u.util.createImage(),u.util.loadImage(s.source,function(n,a){c.source=n,h&&h(c,a)},null,this.crossOrigin)}},toObject:function(s){var h=u.Object.NUM_FRACTION_DIGITS,c,n;return typeof this.source.src=="string"?c=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(c=this.source.toDataURL()),n={type:"pattern",source:c,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:g(this.offsetX,h),offsetY:g(this.offsetY,h),patternTransform:this.patternTransform?this.patternTransform.concat():null},u.util.populateWithProperties(this,n,s),n},toSVG:function(s){var h=typeof this.source=="function"?this.source():this.source,c=h.width/s.width,n=h.height/s.height,a=this.offsetX/s.width,e=this.offsetY/s.height,o="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(n=1,e&&(n+=Math.abs(e))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(c=1,a&&(c+=Math.abs(a))),h.src?o=h.src:h.toDataURL&&(o=h.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+a+'" y="'+e+'" width="'+c+'" height="'+n+`">
<image x="0" y="0" width="`+h.width+'" height="'+h.height+'" xlink:href="'+o+`"></image>
</pattern>
`},setOptions:function(s){for(var h in s)this[h]=s[h]},toLive:function(s){var h=this.source;return!h||typeof h.src<"u"&&(!h.complete||h.naturalWidth===0||h.naturalHeight===0)?"":s.createPattern(h,this.repeat)}})}(),function(g){var s=g.fabric||(g.fabric={}),h=s.util.toFixed;if(s.Shadow){s.warn("fabric.Shadow is already defined.");return}s.Shadow=s.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(c){typeof c=="string"&&(c=this._parseShadow(c));for(var n in c)this[n]=c[n];this.id=s.Object.__uid++},_parseShadow:function(c){var n=c.trim(),a=s.Shadow.reOffsetsAndBlur.exec(n)||[],e=n.replace(s.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:e.trim(),offsetX:parseFloat(a[1],10)||0,offsetY:parseFloat(a[2],10)||0,blur:parseFloat(a[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(c){var n=40,a=40,e=s.Object.NUM_FRACTION_DIGITS,o=s.util.rotateVector({x:this.offsetX,y:this.offsetY},s.util.degreesToRadians(-c.angle)),f=20,r=new s.Color(this.color);return c.width&&c.height&&(n=h((Math.abs(o.x)+this.blur)/c.width,e)*100+f,a=h((Math.abs(o.y)+this.blur)/c.height,e)*100+f),c.flipX&&(o.x*=-1),c.flipY&&(o.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+a+'%" height="'+(100+2*a)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+h(this.blur?this.blur/2:0,e)+`"></feGaussianBlur>
	<feOffset dx="`+h(o.x,e)+'" dy="'+h(o.y,e)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+r.toRgb()+'" flood-opacity="'+r.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var c={},n=s.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(a){this[a]!==n[a]&&(c[a]=this[a])},this),c}}),s.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(m),function(){if(u.StaticCanvas){u.warn("fabric.StaticCanvas is already defined.");return}var g=u.util.object.extend,s=u.util.getElementOffset,h=u.util.removeFromArray,c=u.util.toFixed,n=u.util.transformPoint,a=u.util.invertTransform,e=u.util.getNodeCanvas,o=u.util.createCanvasElement,f=new Error("Could not initialize `canvas` element");u.StaticCanvas=u.util.createClass(u.CommonMethods,{initialize:function(r,_){_||(_={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,_)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:u.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(r,_){var p=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(r),this._initOptions(_),this.interactive||this._initRetinaScaling(),_.overlayImage&&this.setOverlayImage(_.overlayImage,p),_.backgroundImage&&this.setBackgroundImage(_.backgroundImage,p),_.backgroundColor&&this.setBackgroundColor(_.backgroundColor,p),_.overlayColor&&this.setOverlayColor(_.overlayColor,p),this.calcOffset()},_isRetinaScaling:function(){return u.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,u.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var r=u.devicePixelRatio;this.__initRetinaScaling(r,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(r,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(r,_,p){_.setAttribute("width",this.width*r),_.setAttribute("height",this.height*r),p.scale(r,r)},calcOffset:function(){return this._offset=s(this.lowerCanvasEl),this},setOverlayImage:function(r,_,p){return this.__setBgOverlayImage("overlayImage",r,_,p)},setBackgroundImage:function(r,_,p){return this.__setBgOverlayImage("backgroundImage",r,_,p)},setOverlayColor:function(r,_){return this.__setBgOverlayColor("overlayColor",r,_)},setBackgroundColor:function(r,_){return this.__setBgOverlayColor("backgroundColor",r,_)},__setBgOverlayImage:function(r,_,p,S){return typeof _=="string"?u.util.loadImage(_,function(C,x){if(C){var P=new u.Image(C,S);this[r]=P,P.canvas=this}p&&p(C,x)},this,S&&S.crossOrigin):(S&&_.setOptions(S),this[r]=_,_&&(_.canvas=this),p&&p(_,!1)),this},__setBgOverlayColor:function(r,_,p){return this[r]=_,this._initGradient(_,r),this._initPattern(_,r,p),this},_createCanvasElement:function(){var r=o();if(!r||(r.style||(r.style={}),typeof r.getContext>"u"))throw f;return r},_initOptions:function(r){var _=this.lowerCanvasEl;this._setOptions(r),this.width=this.width||parseInt(_.width,10)||0,this.height=this.height||parseInt(_.height,10)||0,this.lowerCanvasEl.style&&(_.width=this.width,_.height=this.height,_.style.width=this.width+"px",_.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(r){r&&r.getContext?this.lowerCanvasEl=r:this.lowerCanvasEl=u.util.getById(r)||this._createCanvasElement(),u.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(r,_){return this.setDimensions({width:r},_)},setHeight:function(r,_){return this.setDimensions({height:r},_)},setDimensions:function(r,_){var p;_=_||{};for(var S in r)p=r[S],_.cssOnly||(this._setBackstoreDimension(S,r[S]),p+="px",this.hasLostContext=!0),_.backstoreOnly||this._setCssDimension(S,p);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),_.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(r,_){return this.lowerCanvasEl[r]=_,this.upperCanvasEl&&(this.upperCanvasEl[r]=_),this.cacheCanvasEl&&(this.cacheCanvasEl[r]=_),this[r]=_,this},_setCssDimension:function(r,_){return this.lowerCanvasEl.style[r]=_,this.upperCanvasEl&&(this.upperCanvasEl.style[r]=_),this.wrapperEl&&(this.wrapperEl.style[r]=_),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(r){var _=this._activeObject,p=this.backgroundImage,S=this.overlayImage,C,x,P;for(this.viewportTransform=r,x=0,P=this._objects.length;x<P;x++)C=this._objects[x],C.group||C.setCoords(!0);return _&&_.setCoords(),p&&p.setCoords(!0),S&&S.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(r,_){var p=r,S=this.viewportTransform.slice(0);r=n(r,a(this.viewportTransform)),S[0]=_,S[3]=_;var C=n(r,S);return S[4]+=p.x-C.x,S[5]+=p.y-C.y,this.setViewportTransform(S)},setZoom:function(r){return this.zoomToPoint(new u.Point(0,0),r),this},absolutePan:function(r){var _=this.viewportTransform.slice(0);return _[4]=-r.x,_[5]=-r.y,this.setViewportTransform(_)},relativePan:function(r){return this.absolutePan(new u.Point(-r.x-this.viewportTransform[4],-r.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(r){this.stateful&&r.setupState(),r._set("canvas",this),r.setCoords(),this.fire("object:added",{target:r}),r.fire("added")},_onObjectRemoved:function(r){this.fire("object:removed",{target:r}),r.fire("removed"),delete r.canvas},clearContext:function(r){return r.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var r=this.contextContainer;return this.renderCanvas(r,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=u.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var r={},_=this.width,p=this.height,S=a(this.viewportTransform);return r.tl=n({x:0,y:0},S),r.br=n({x:_,y:p},S),r.tr=new u.Point(r.br.x,r.tl.y),r.bl=new u.Point(r.tl.x,r.br.y),this.vptCoords=r,r},cancelRequestedRender:function(){this.isRendering&&(u.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(r,_){var p=this.viewportTransform,S=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(r),u.util.setImageSmoothing(r,this.imageSmoothingEnabled),this.fire("before:render",{ctx:r}),this._renderBackground(r),r.save(),r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._renderObjects(r,_),r.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(r),S&&(S.canvas=this,S.shouldCache(),S._transformDone=!0,S.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(r)),this._renderOverlay(r),this.controlsAboveOverlay&&this.interactive&&this.drawControls(r),this.fire("after:render",{ctx:r})},drawClipPathOnCanvas:function(r){var _=this.viewportTransform,p=this.clipPath;r.save(),r.transform(_[0],_[1],_[2],_[3],_[4],_[5]),r.globalCompositeOperation="destination-in",p.transform(r),r.scale(1/p.zoomX,1/p.zoomY),r.drawImage(p._cacheCanvas,-p.cacheTranslationX,-p.cacheTranslationY),r.restore()},_renderObjects:function(r,_){var p,S;for(p=0,S=_.length;p<S;++p)_[p]&&_[p].render(r)},_renderBackgroundOrOverlay:function(r,_){var p=this[_+"Color"],S=this[_+"Image"],C=this.viewportTransform,x=this[_+"Vpt"];if(!(!p&&!S)){if(p){r.save(),r.beginPath(),r.moveTo(0,0),r.lineTo(this.width,0),r.lineTo(this.width,this.height),r.lineTo(0,this.height),r.closePath(),r.fillStyle=p.toLive?p.toLive(r,this):p,x&&r.transform(C[0],C[1],C[2],C[3],C[4],C[5]),r.transform(1,0,0,1,p.offsetX||0,p.offsetY||0);var P=p.gradientTransform||p.patternTransform;P&&r.transform(P[0],P[1],P[2],P[3],P[4],P[5]),r.fill(),r.restore()}S&&(r.save(),x&&r.transform(C[0],C[1],C[2],C[3],C[4],C[5]),S.render(r),r.restore())}},_renderBackground:function(r){this._renderBackgroundOrOverlay(r,"background")},_renderOverlay:function(r){this._renderBackgroundOrOverlay(r,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new u.Point(this.width/2,this.height/2)},centerObjectH:function(r){return this._centerObject(r,new u.Point(this.getCenterPoint().x,r.getCenterPoint().y))},centerObjectV:function(r){return this._centerObject(r,new u.Point(r.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(r){var _=this.getCenterPoint();return this._centerObject(r,_)},viewportCenterObject:function(r){var _=this.getVpCenter();return this._centerObject(r,_)},viewportCenterObjectH:function(r){var _=this.getVpCenter();return this._centerObject(r,new u.Point(_.x,r.getCenterPoint().y)),this},viewportCenterObjectV:function(r){var _=this.getVpCenter();return this._centerObject(r,new u.Point(r.getCenterPoint().x,_.y))},getVpCenter:function(){var r=this.getCenterPoint(),_=a(this.viewportTransform);return n(r,_)},_centerObject:function(r,_){return r.setPositionByOrigin(_,"center","center"),r.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(r){return this.toDatalessObject(r)},toObject:function(r){return this._toObjectMethod("toObject",r)},toDatalessObject:function(r){return this._toObjectMethod("toDatalessObject",r)},_toObjectMethod:function(r,_){var p=this.clipPath,S={version:u.version,objects:this._toObjects(r,_)};return p&&!p.excludeFromExport&&(S.clipPath=this._toObject(this.clipPath,r,_)),g(S,this.__serializeBgOverlay(r,_)),u.util.populateWithProperties(this,S,_),S},_toObjects:function(r,_){return this._objects.filter(function(p){return!p.excludeFromExport}).map(function(p){return this._toObject(p,r,_)},this)},_toObject:function(r,_,p){var S;this.includeDefaultValues||(S=r.includeDefaultValues,r.includeDefaultValues=!1);var C=r[_](p);return this.includeDefaultValues||(r.includeDefaultValues=S),C},__serializeBgOverlay:function(r,_){var p={},S=this.backgroundImage,C=this.overlayImage,x=this.backgroundColor,P=this.overlayColor;return x&&x.toObject?x.excludeFromExport||(p.background=x.toObject(_)):x&&(p.background=x),P&&P.toObject?P.excludeFromExport||(p.overlay=P.toObject(_)):P&&(p.overlay=P),S&&!S.excludeFromExport&&(p.backgroundImage=this._toObject(S,r,_)),C&&!C.excludeFromExport&&(p.overlayImage=this._toObject(C,r,_)),p},svgViewportTransformation:!0,toSVG:function(r,_){r||(r={}),r.reviver=_;var p=[];return this._setSVGPreamble(p,r),this._setSVGHeader(p,r),this.clipPath&&p.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(p,"background"),this._setSVGBgOverlayImage(p,"backgroundImage",_),this._setSVGObjects(p,_),this.clipPath&&p.push(`</g>
`),this._setSVGBgOverlayColor(p,"overlay"),this._setSVGBgOverlayImage(p,"overlayImage",_),p.push("</svg>"),p.join("")},_setSVGPreamble:function(r,_){_.suppressPreamble||r.push('<?xml version="1.0" encoding="',_.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(r,_){var p=_.width||this.width,S=_.height||this.height,C,x='viewBox="0 0 '+this.width+" "+this.height+'" ',P=u.Object.NUM_FRACTION_DIGITS;_.viewBox?x='viewBox="'+_.viewBox.x+" "+_.viewBox.y+" "+_.viewBox.width+" "+_.viewBox.height+'" ':this.svgViewportTransformation&&(C=this.viewportTransform,x='viewBox="'+c(-C[4]/C[0],P)+" "+c(-C[5]/C[3],P)+" "+c(this.width/C[0],P)+" "+c(this.height/C[3],P)+'" '),r.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',p,'" ','height="',S,'" ',x,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",u.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(_),`</defs>
`)},createSVGClipPathMarkup:function(r){var _=this.clipPath;return _?(_.clipPathId="CLIPPATH_"+u.Object.__uid++,'<clipPath id="'+_.clipPathId+`" >
`+this.clipPath.toClipPathSVG(r.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var r=this,_=["background","overlay"].map(function(p){var S=r[p+"Color"];if(S&&S.toLive){var C=r[p+"Vpt"],x=r.viewportTransform,P={width:r.width/(C?x[0]:1),height:r.height/(C?x[3]:1)};return S.toSVG(P,{additionalTransform:C?u.util.matrixToSVG(x):""})}});return _.join("")},createSVGFontFacesMarkup:function(){var r="",_={},p,S,C,x,P,F,z,K,at,_t=u.fontPaths,dt=[];for(this._objects.forEach(function ut(ht){dt.push(ht),ht._objects&&ht._objects.forEach(ut)}),K=0,at=dt.length;K<at;K++)if(p=dt[K],S=p.fontFamily,!(p.type.indexOf("text")===-1||_[S]||!_t[S])&&(_[S]=!0,!!p.styles)){C=p.styles;for(P in C){x=C[P];for(z in x)F=x[z],S=F.fontFamily,!_[S]&&_t[S]&&(_[S]=!0)}}for(var ct in _)r+=[`		@font-face {
`,"			font-family: '",ct,`';
`,"			src: url('",_t[ct],`');
`,`		}
`].join("");return r&&(r=['	<style type="text/css">',`<![CDATA[
`,r,"]]>",`</style>
`].join("")),r},_setSVGObjects:function(r,_){var p,S,C,x=this._objects;for(S=0,C=x.length;S<C;S++)p=x[S],!p.excludeFromExport&&this._setSVGObject(r,p,_)},_setSVGObject:function(r,_,p){r.push(_.toSVG(p))},_setSVGBgOverlayImage:function(r,_,p){this[_]&&!this[_].excludeFromExport&&this[_].toSVG&&r.push(this[_].toSVG(p))},_setSVGBgOverlayColor:function(r,_){var p=this[_+"Color"],S=this.viewportTransform,C=this.width,x=this.height;if(p)if(p.toLive){var P=p.repeat,F=u.util.invertTransform(S),z=this[_+"Vpt"],K=z?u.util.matrixToSVG(F):"";r.push('<rect transform="'+K+" translate(",C/2,",",x/2,')"',' x="',p.offsetX-C/2,'" y="',p.offsetY-x/2,'" ','width="',P==="repeat-y"||P==="no-repeat"?p.source.width:C,'" height="',P==="repeat-x"||P==="no-repeat"?p.source.height:x,'" fill="url(#SVGID_'+p.id+')"',`></rect>
`)}else r.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',p,'"',`></rect>
`)},sendToBack:function(r){if(!r)return this;var _=this._activeObject,p,S,C;if(r===_&&r.type==="activeSelection")for(C=_._objects,p=C.length;p--;)S=C[p],h(this._objects,S),this._objects.unshift(S);else h(this._objects,r),this._objects.unshift(r);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(r){if(!r)return this;var _=this._activeObject,p,S,C;if(r===_&&r.type==="activeSelection")for(C=_._objects,p=0;p<C.length;p++)S=C[p],h(this._objects,S),this._objects.push(S);else h(this._objects,r),this._objects.push(r);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(r,_){if(!r)return this;var p=this._activeObject,S,C,x,P,F,z=0;if(r===p&&r.type==="activeSelection")for(F=p._objects,S=0;S<F.length;S++)C=F[S],x=this._objects.indexOf(C),x>0+z&&(P=x-1,h(this._objects,C),this._objects.splice(P,0,C)),z++;else x=this._objects.indexOf(r),x!==0&&(P=this._findNewLowerIndex(r,x,_),h(this._objects,r),this._objects.splice(P,0,r));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(r,_,p){var S,C;if(p)for(S=_,C=_-1;C>=0;--C){var x=r.intersectsWithObject(this._objects[C])||r.isContainedWithinObject(this._objects[C])||this._objects[C].isContainedWithinObject(r);if(x){S=C;break}}else S=_-1;return S},bringForward:function(r,_){if(!r)return this;var p=this._activeObject,S,C,x,P,F,z=0;if(r===p&&r.type==="activeSelection")for(F=p._objects,S=F.length;S--;)C=F[S],x=this._objects.indexOf(C),x<this._objects.length-1-z&&(P=x+1,h(this._objects,C),this._objects.splice(P,0,C)),z++;else x=this._objects.indexOf(r),x!==this._objects.length-1&&(P=this._findNewUpperIndex(r,x,_),h(this._objects,r),this._objects.splice(P,0,r));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(r,_,p){var S,C,x;if(p)for(S=_,C=_+1,x=this._objects.length;C<x;++C){var P=r.intersectsWithObject(this._objects[C])||r.isContainedWithinObject(this._objects[C])||this._objects[C].isContainedWithinObject(r);if(P){S=C;break}}else S=_+1;return S},moveTo:function(r,_){return h(this._objects,r),this._objects.splice(_,0,r),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(u.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),u.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),u.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),g(u.StaticCanvas.prototype,u.Observable),g(u.StaticCanvas.prototype,u.Collection),g(u.StaticCanvas.prototype,u.DataURLExporter),g(u.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(r){var _=o();if(!_||!_.getContext)return null;var p=_.getContext("2d");if(!p)return null;switch(r){case"setLineDash":return typeof p.setLineDash<"u";default:return null}}}),u.StaticCanvas.prototype.toJSON=u.StaticCanvas.prototype.toObject,u.isLikelyNode&&(u.StaticCanvas.prototype.createPNGStream=function(){var r=e(this.lowerCanvasEl);return r&&r.createPNGStream()},u.StaticCanvas.prototype.createJPEGStream=function(r){var _=e(this.lowerCanvasEl);return _&&_.createJPEGStream(r)})}(),u.BaseBrush=u.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(g){g.strokeStyle=this.color,g.lineWidth=this.width,g.lineCap=this.strokeLineCap,g.miterLimit=this.strokeMiterLimit,g.lineJoin=this.strokeLineJoin,g.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(g){var s=this.canvas.viewportTransform;g.save(),g.transform(s[0],s[1],s[2],s[3],s[4],s[5])},_setShadow:function(){if(this.shadow){var g=this.canvas,s=this.shadow,h=g.contextTop,c=g.getZoom();g&&g._isRetinaScaling()&&(c*=u.devicePixelRatio),h.shadowColor=s.color,h.shadowBlur=s.blur*c,h.shadowOffsetX=s.offsetX*c,h.shadowOffsetY=s.offsetY*c}},needsFullRender:function(){var g=new u.Color(this.color);return g.getAlpha()<1||!!this.shadow},_resetShadow:function(){var g=this.canvas.contextTop;g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0},_isOutSideCanvas:function(g){return g.x<0||g.x>this.canvas.getWidth()||g.y<0||g.y>this.canvas.getHeight()}}),function(){u.PencilBrush=u.util.createClass(u.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(g){this.canvas=g,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(g,s,h){var c=s.midPointFrom(h);return g.quadraticCurveTo(s.x,s.y,c.x,c.y),c},onMouseDown:function(g,s){this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],this._prepareForDrawing(g),this._captureDrawingPath(g),this._render())},onMouseMove:function(g,s){if(this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(g))&&this._captureDrawingPath(g)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var h=this._points,c=h.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,h[c-2],h[c-1],!0),n.stroke(),n.restore()}},onMouseUp:function(g){return this.canvas._isMainEvent(g.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(g){var s=new u.Point(g.x,g.y);this._reset(),this._addPoint(s),this.canvas.contextTop.moveTo(s.x,s.y)},_addPoint:function(g){return this._points.length>1&&g.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(g),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(g){var s=new u.Point(g.x,g.y);return this._addPoint(s)},_render:function(g){var s,h,c=this._points[0],n=this._points[1];if(g=g||this.canvas.contextTop,this._saveAndTransform(g),g.beginPath(),this._points.length===2&&c.x===n.x&&c.y===n.y){var a=this.width/1e3;c=new u.Point(c.x,c.y),n=new u.Point(n.x,n.y),c.x-=a,n.x+=a}for(g.moveTo(c.x,c.y),s=1,h=this._points.length;s<h;s++)this._drawSegment(g,c,n),c=this._points[s],n=this._points[s+1];g.lineTo(c.x,c.y),g.stroke(),g.restore()},convertPointsToSVGPath:function(g){var s=this.width/1e3;return u.util.getSmoothPathFromPoints(g,s)},_isEmptySVGPath:function(g){var s=u.util.joinPath(g);return s==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(g){var s=new u.Path(g,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,s.shadow=new u.Shadow(this.shadow)),s},decimatePoints:function(g,s){if(g.length<=2)return g;var h=this.canvas.getZoom(),c=Math.pow(s/h,2),n,a=g.length-1,e=g[0],o=[e],f;for(n=1;n<a-1;n++)f=Math.pow(e.x-g[n].x,2)+Math.pow(e.y-g[n].y,2),f>=c&&(e=g[n],o.push(e));return o.push(g[a]),o},_finalizeAndAddPath:function(){var g=this.canvas.contextTop;g.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var s=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(s)){this.canvas.requestRenderAll();return}var h=this.createPath(s);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.requestRenderAll(),h.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:h})}})}(),u.CircleBrush=u.util.createClass(u.BaseBrush,{width:10,initialize:function(g){this.canvas=g,this.points=[]},drawDot:function(g){var s=this.addPoint(g),h=this.canvas.contextTop;this._saveAndTransform(h),this.dot(h,s),h.restore()},dot:function(g,s){g.fillStyle=s.fill,g.beginPath(),g.arc(s.x,s.y,s.radius,0,Math.PI*2,!1),g.closePath(),g.fill()},onMouseDown:function(g){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(g)},_render:function(){var g=this.canvas.contextTop,s,h,c=this.points;for(this._saveAndTransform(g),s=0,h=c.length;s<h;s++)this.dot(g,c[s]);g.restore()},onMouseMove:function(g){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(g)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(g),this._render()):this.drawDot(g))},onMouseUp:function(){var g=this.canvas.renderOnAddRemove,s,h;this.canvas.renderOnAddRemove=!1;var c=[];for(s=0,h=this.points.length;s<h;s++){var n=this.points[s],a=new u.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(a.shadow=new u.Shadow(this.shadow)),c.push(a)}var e=new u.Group(c);e.canvas=this.canvas,this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.fire("path:created",{path:e}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=g,this.canvas.requestRenderAll()},addPoint:function(g){var s=new u.Point(g.x,g.y),h=u.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,c=new u.Color(this.color).setAlpha(u.util.getRandomInt(0,100)/100).toRgba();return s.radius=h,s.fill=c,this.points.push(s),s}}),u.SprayBrush=u.util.createClass(u.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(g){this.canvas=g,this.sprayChunks=[]},onMouseDown:function(g){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(g),this.render(this.sprayChunkPoints)},onMouseMove:function(g){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(g)||(this.addSprayChunk(g),this.render(this.sprayChunkPoints))},onMouseUp:function(){var g=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var s=[],h=0,c=this.sprayChunks.length;h<c;h++)for(var n=this.sprayChunks[h],a=0,e=n.length;a<e;a++){var o=new u.Rect({width:n[a].width,height:n[a].width,left:n[a].x+1,top:n[a].y+1,originX:"center",originY:"center",fill:this.color});s.push(o)}this.optimizeOverlapping&&(s=this._getOptimizedRects(s));var f=new u.Group(s);this.shadow&&f.set("shadow",new u.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:f}),this.canvas.add(f),this.canvas.fire("path:created",{path:f}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=g,this.canvas.requestRenderAll()},_getOptimizedRects:function(g){var s={},h,c,n;for(c=0,n=g.length;c<n;c++)h=g[c].left+""+g[c].top,s[h]||(s[h]=g[c]);var a=[];for(h in s)a.push(s[h]);return a},render:function(g){var s=this.canvas.contextTop,h,c;for(s.fillStyle=this.color,this._saveAndTransform(s),h=0,c=g.length;h<c;h++){var n=g[h];typeof n.opacity<"u"&&(s.globalAlpha=n.opacity),s.fillRect(n.x,n.y,n.width,n.width)}s.restore()},_render:function(){var g=this.canvas.contextTop,s,h;for(g.fillStyle=this.color,this._saveAndTransform(g),s=0,h=this.sprayChunks.length;s<h;s++)this.render(this.sprayChunks[s]);g.restore()},addSprayChunk:function(g){this.sprayChunkPoints=[];var s,h,c,n=this.width/2,a;for(a=0;a<this.density;a++){s=u.util.getRandomInt(g.x-n,g.x+n),h=u.util.getRandomInt(g.y-n,g.y+n),this.dotWidthVariance?c=u.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):c=this.dotWidth;var e=new u.Point(s,h);e.width=c,this.randomOpacity&&(e.opacity=u.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(e)}this.sprayChunks.push(this.sprayChunkPoints)}}),u.PatternBrush=u.util.createClass(u.PencilBrush,{getPatternSrc:function(){var g=20,s=5,h=u.util.createCanvasElement(),c=h.getContext("2d");return h.width=h.height=g+s,c.fillStyle=this.color,c.beginPath(),c.arc(g/2,g/2,g/2,0,Math.PI*2,!1),c.closePath(),c.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(g){return g.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(g){this.callSuper("_setBrushStyles",g),g.strokeStyle=this.getPattern(g)},createPath:function(g){var s=this.callSuper("createPath",g),h=s._getLeftTopCoords().scalarAdd(s.strokeWidth/2);return s.stroke=new u.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-h.x,offsetY:-h.y}),s}}),function(){var g=u.util.getPointer,s=u.util.degreesToRadians,h=u.util.isTouchEvent;u.Canvas=u.util.createClass(u.StaticCanvas,{initialize:function(n,a){a||(a={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,a),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=u.PencilBrush&&new u.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n=this.getActiveObjects(),a,e,o;if(n.length>0&&!this.preserveObjectStacking){e=[],o=[];for(var f=0,r=this._objects.length;f<r;f++)a=this._objects[f],n.indexOf(a)===-1?e.push(a):o.push(a);n.length>1&&(this._activeObject._objects=o),e.push.apply(e,o)}else e=this._objects;return e},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,a){var e=n.calcTransformMatrix(),o=u.util.invertTransform(e),f=this.restorePointerVpt(a);return u.util.transformPoint(f,o)},isTargetTransparent:function(n,a,e){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var o=this._normalizePointer(n,{x:a,y:e}),f=Math.max(n.cacheTranslationX+o.x*n.zoomX,0),r=Math.max(n.cacheTranslationY+o.y*n.zoomY,0),C=u.util.isTransparent(n._cacheContext,Math.round(f),Math.round(r),this.targetFindTolerance);return C}var _=this.contextCache,p=n.selectionBackgroundColor,S=this.viewportTransform;n.selectionBackgroundColor="",this.clearContext(_),_.save(),_.transform(S[0],S[1],S[2],S[3],S[4],S[5]),n.render(_),_.restore(),n.selectionBackgroundColor=p;var C=u.util.isTransparent(_,a,e,this.targetFindTolerance);return C},_isSelectionKeyPressed:function(n){var a=!1;return Array.isArray(this.selectionKey)?a=!!this.selectionKey.find(function(e){return n[e]===!0}):a=n[this.selectionKey],a},_shouldClearSelection:function(n,a){var e=this.getActiveObjects(),o=this._activeObject;return!a||a&&o&&e.length>1&&e.indexOf(a)===-1&&o!==a&&!this._isSelectionKeyPressed(n)||a&&!a.evented||a&&!a.selectable&&o&&o!==a},_shouldCenterTransform:function(n,a,e){if(n){var o;return a==="scale"||a==="scaleX"||a==="scaleY"||a==="resizing"?o=this.centeredScaling||n.centeredScaling:a==="rotate"&&(o=this.centeredRotation||n.centeredRotation),o?!e:e}},_getOriginFromCorner:function(n,a){var e={x:n.originX,y:n.originY};return a==="ml"||a==="tl"||a==="bl"?e.x="right":(a==="mr"||a==="tr"||a==="br")&&(e.x="left"),a==="tl"||a==="mt"||a==="tr"?e.y="bottom":(a==="bl"||a==="mb"||a==="br")&&(e.y="top"),e},_getActionFromCorner:function(n,a,e,o){if(!a||!n)return"drag";var f=o.controls[a];return f.getActionName(e,f,o)},_setupCurrentTransform:function(n,a,e){if(a){var o=this.getPointer(n),f=a.__corner,r=a.controls[f],_=e&&f?r.getActionHandler(n,a,r):u.controlsUtils.dragHandler,p=this._getActionFromCorner(e,f,n,a),S=this._getOriginFromCorner(a,f),C=n[this.centeredKey],x={target:a,action:p,actionHandler:_,corner:f,scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,offsetX:o.x-a.left,offsetY:o.y-a.top,originX:S.x,originY:S.y,ex:o.x,ey:o.y,lastX:o.x,lastY:o.y,theta:s(a.angle),width:a.width*a.scaleX,shiftKey:n.shiftKey,altKey:C,original:u.util.saveObjectTransform(a)};this._shouldCenterTransform(a,p,C)&&(x.originX="center",x.originY="center"),x.original.originX=S.x,x.original.originY=S.y,this._currentTransform=x,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var a=this._groupSelector,e=new u.Point(a.ex,a.ey),o=u.util.transformPoint(e,this.viewportTransform),f=new u.Point(a.ex+a.left,a.ey+a.top),r=u.util.transformPoint(f,this.viewportTransform),_=Math.min(o.x,r.x),p=Math.min(o.y,r.y),S=Math.max(o.x,r.x),C=Math.max(o.y,r.y),x=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(_,p,S-_,C-p)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,_+=x,p+=x,S-=x,C-=x,u.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(_,p,S-_,C-p))},findTarget:function(n,a){if(!this.skipTargetFind){var e=!0,o=this.getPointer(n,e),f=this._activeObject,r=this.getActiveObjects(),_,p,S=h(n),C=r.length>1&&!a||r.length===1;if(this.targets=[],C&&f._findTargetCorner(o,S)||r.length>1&&!a&&f===this._searchPossibleTargets([f],o))return f;if(r.length===1&&f===this._searchPossibleTargets([f],o))if(this.preserveObjectStacking)_=f,p=this.targets,this.targets=[];else return f;var x=this._searchPossibleTargets(this._objects,o);return n[this.altSelectionKey]&&x&&_&&x!==_&&(x=_,this.targets=p),x}},_checkTarget:function(n,a,e){if(a&&a.visible&&a.evented&&a.containsPoint(n))if((this.perPixelTargetFind||a.perPixelTargetFind)&&!a.isEditing){var o=this.isTargetTransparent(a,e.x,e.y);if(!o)return!0}else return!0},_searchPossibleTargets:function(n,a){for(var e,o=n.length,f;o--;){var r=n[o],_=r.group?this._normalizePointer(r.group,a):a;if(this._checkTarget(_,r,a)){e=n[o],e.subTargetCheck&&e instanceof u.Group&&(f=this._searchPossibleTargets(e._objects,a),f&&this.targets.push(f));break}}return e},restorePointerVpt:function(n){return u.util.transformPoint(n,u.util.invertTransform(this.viewportTransform))},getPointer:function(n,a){if(this._absolutePointer&&!a)return this._absolutePointer;if(this._pointer&&a)return this._pointer;var e=g(n),o=this.upperCanvasEl,f=o.getBoundingClientRect(),r=f.width||0,_=f.height||0,p;(!r||!_)&&("top"in f&&"bottom"in f&&(_=Math.abs(f.top-f.bottom)),"right"in f&&"left"in f&&(r=Math.abs(f.right-f.left))),this.calcOffset(),e.x=e.x-this._offset.left,e.y=e.y-this._offset.top,a||(e=this.restorePointerVpt(e));var S=this.getRetinaScaling();return S!==1&&(e.x/=S,e.y/=S),r===0||_===0?p={width:1,height:1}:p={width:o.width/r,height:o.height/_},{x:e.x*p.width,y:e.y*p.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),a=this.lowerCanvasEl,e=this.upperCanvasEl;e?e.className="":(e=this._createCanvasElement(),this.upperCanvasEl=e),u.util.addClass(e,"upper-canvas "+n),this.wrapperEl.appendChild(e),this._copyCanvasStyle(a,e),this._applyCanvasStyle(e),this.contextTop=e.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=u.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),u.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),u.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var a=this.width||n.width,e=this.height||n.height;u.util.setStyle(n,{position:"absolute",width:a+"px",height:e+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=a,n.height=e,u.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,a){a.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,a){var e=!1,o=this.getActiveObjects(),f=[],r=[];n.forEach(function(_){o.indexOf(_)===-1&&(e=!0,_.fire("deselected",{e:a,target:_}),r.push(_))}),o.forEach(function(_){n.indexOf(_)===-1&&(e=!0,_.fire("selected",{e:a,target:_}),f.push(_))}),n.length>0&&o.length>0?e&&this.fire("selection:updated",{e:a,selected:f,deselected:r}):o.length>0?this.fire("selection:created",{e:a,selected:f}):n.length>0&&this.fire("selection:cleared",{e:a,deselected:r})},setActiveObject:function(n,a){var e=this.getActiveObjects();return this._setActiveObject(n,a),this._fireSelectionEvents(e,a),this},_setActiveObject:function(n,a){return this._activeObject===n||!this._discardActiveObject(a,n)||n.onSelect({e:a})?!1:(this._activeObject=n,!0)},_discardActiveObject:function(n,a){var e=this._activeObject;if(e){if(e.onDeselect({e:n,object:a}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var a=this.getActiveObjects(),e=this.getActiveObject();return a.length&&this.fire("before:selection:cleared",{target:e,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(a,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(a){u.util.cleanUpJsdomNode(this[a]),this[a]=void 0}).bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,u.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var a=this._activeObject;a&&a._renderControls(n)},_toObject:function(n,a,e){var o=this._realizeGroupTransformOnObject(n),f=this.callSuper("_toObject",n,a,e);return this._unwindGroupTransformOnObject(n,o),f},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var a=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],e={};return a.forEach(function(o){e[o]=n[o]}),u.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),e}else return null},_unwindGroupTransformOnObject:function(n,a){a&&n.set(a)},_setSVGObject:function(n,a,e){var o=this._realizeGroupTransformOnObject(a);this.callSuper("_setSVGObject",n,a,e),this._unwindGroupTransformOnObject(a,o)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),u.StaticCanvas.prototype.setViewportTransform.call(this,n)}});for(var c in u.StaticCanvas)c!=="prototype"&&(u.Canvas[c]=u.StaticCanvas[c])}(),function(){var g=u.util.addListener,s=u.util.removeListener,h=3,c=2,n=1,a={passive:!1};function e(o,f){return o.button&&o.button===f-1}u.util.object.extend(u.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(g,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(o,f){var r=this.upperCanvasEl,_=this._getEventPrefix();o(u.window,"resize",this._onResize),o(r,_+"down",this._onMouseDown),o(r,_+"move",this._onMouseMove,a),o(r,_+"out",this._onMouseOut),o(r,_+"enter",this._onMouseEnter),o(r,"wheel",this._onMouseWheel),o(r,"contextmenu",this._onContextMenu),o(r,"dblclick",this._onDoubleClick),o(r,"dragover",this._onDragOver),o(r,"dragenter",this._onDragEnter),o(r,"dragleave",this._onDragLeave),o(r,"drop",this._onDrop),this.enablePointerEvents||o(r,"touchstart",this._onTouchStart,a),typeof eventjs<"u"&&f in eventjs&&(eventjs[f](r,"gesture",this._onGesture),eventjs[f](r,"drag",this._onDrag),eventjs[f](r,"orientation",this._onOrientationChange),eventjs[f](r,"shake",this._onShake),eventjs[f](r,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(s,"remove");var o=this._getEventPrefix();s(u.document,o+"up",this._onMouseUp),s(u.document,"touchend",this._onTouchEnd,a),s(u.document,o+"move",this._onMouseMove,a),s(u.document,"touchmove",this._onMouseMove,a)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(o,f){this.__onTransformGesture&&this.__onTransformGesture(o,f)},_onDrag:function(o,f){this.__onDrag&&this.__onDrag(o,f)},_onMouseWheel:function(o){this.__onMouseWheel(o)},_onMouseOut:function(o){var f=this._hoveredTarget;this.fire("mouse:out",{target:f,e:o}),this._hoveredTarget=null,f&&f.fire("mouseout",{e:o});var r=this;this._hoveredTargets.forEach(function(_){r.fire("mouse:out",{target:f,e:o}),_&&f.fire("mouseout",{e:o})}),this._hoveredTargets=[]},_onMouseEnter:function(o){!this._currentTransform&&!this.findTarget(o)&&(this.fire("mouse:over",{target:null,e:o}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(o,f){this.__onOrientationChange&&this.__onOrientationChange(o,f)},_onShake:function(o,f){this.__onShake&&this.__onShake(o,f)},_onLongPress:function(o,f){this.__onLongPress&&this.__onLongPress(o,f)},_onDragOver:function(o){o.preventDefault();var f=this._simpleEventHandler("dragover",o);this._fireEnterLeaveEvents(f,o)},_onDrop:function(o){return this._simpleEventHandler("drop:before",o),this._simpleEventHandler("drop",o)},_onContextMenu:function(o){return this.stopContextMenu&&(o.stopPropagation(),o.preventDefault()),!1},_onDoubleClick:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"dblclick"),this._resetTransformEventData(o)},getPointerId:function(o){var f=o.changedTouches;return f?f[0]&&f[0].identifier:this.enablePointerEvents?o.pointerId:-1},_isMainEvent:function(o){return o.isPrimary===!0?!0:o.isPrimary===!1?!1:o.type==="touchend"&&o.touches.length===0?!0:o.changedTouches?o.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(o){o.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(o)),this.__onMouseDown(o),this._resetTransformEventData();var f=this.upperCanvasEl,r=this._getEventPrefix();g(u.document,"touchend",this._onTouchEnd,a),g(u.document,"touchmove",this._onMouseMove,a),s(f,r+"down",this._onMouseDown)},_onMouseDown:function(o){this.__onMouseDown(o),this._resetTransformEventData();var f=this.upperCanvasEl,r=this._getEventPrefix();s(f,r+"move",this._onMouseMove,a),g(u.document,r+"up",this._onMouseUp),g(u.document,r+"move",this._onMouseMove,a)},_onTouchEnd:function(o){if(!(o.touches.length>0)){this.__onMouseUp(o),this._resetTransformEventData(),this.mainTouchId=null;var f=this._getEventPrefix();s(u.document,"touchend",this._onTouchEnd,a),s(u.document,"touchmove",this._onMouseMove,a);var r=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){g(r.upperCanvasEl,f+"down",r._onMouseDown),r._willAddMouseDown=0},400)}},_onMouseUp:function(o){this.__onMouseUp(o),this._resetTransformEventData();var f=this.upperCanvasEl,r=this._getEventPrefix();this._isMainEvent(o)&&(s(u.document,r+"up",this._onMouseUp),s(u.document,r+"move",this._onMouseMove,a),g(f,r+"move",this._onMouseMove,a))},_onMouseMove:function(o){!this.allowTouchScrolling&&o.preventDefault&&o.preventDefault(),this.__onMouseMove(o)},_onResize:function(){this.calcOffset()},_shouldRender:function(o){var f=this._activeObject;return!!f!=!!o||f&&o&&f!==o?!0:(f&&f.isEditing,!1)},__onMouseUp:function(o){var f,r=this._currentTransform,_=this._groupSelector,p=!1,S=!_||_.left===0&&_.top===0;if(this._cacheTransformEventData(o),f=this._target,this._handleEvent(o,"up:before"),e(o,h)){this.fireRightClick&&this._handleEvent(o,"up",h,S);return}if(e(o,c)){this.fireMiddleClick&&this._handleEvent(o,"up",c,S),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(o);return}if(this._isMainEvent(o)){if(r&&(this._finalizeCurrentTransform(o),p=r.actionPerformed),!S){var C=f===this._activeObject;this._maybeGroupObjects(o),p||(p=this._shouldRender(f)||!C&&f===this._activeObject)}var x,P;if(f){if(x=f._findTargetCorner(this.getPointer(o,!0),u.util.isTouchEvent(o)),f.selectable&&f!==this._activeObject&&f.activeOn==="up")this.setActiveObject(f,o),p=!0;else{var F=f.controls[x],z=F&&F.getMouseUpHandler(o,f,F);z&&(P=this.getPointer(o),z(o,r,P.x,P.y))}f.isMoving=!1}if(r&&(r.target!==f||r.corner!==x)){var K=r.target&&r.target.controls[r.corner],at=K&&K.getMouseUpHandler(o,f,F);P=P||this.getPointer(o),at&&at(o,r,P.x,P.y)}this._setCursorFromEvent(o,f),this._handleEvent(o,"up",n,S),this._groupSelector=null,this._currentTransform=null,f&&(f.__corner=0),p?this.requestRenderAll():S||this.renderTop()}},_simpleEventHandler:function(o,f){var r=this.findTarget(f),_=this.targets,p={e:f,target:r,subTargets:_};if(this.fire(o,p),r&&r.fire(o,p),!_)return r;for(var S=0;S<_.length;S++)_[S].fire(o,p);return r},_handleEvent:function(o,f,r,_){var p=this._target,S=this.targets||[],C={e:o,target:p,subTargets:S,button:r||n,isClick:_||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};f==="up"&&(C.currentTarget=this.findTarget(o),C.currentSubTargets=this.targets),this.fire("mouse:"+f,C),p&&p.fire("mouse"+f,C);for(var x=0;x<S.length;x++)S[x].fire("mouse"+f,C)},_finalizeCurrentTransform:function(o){var f=this._currentTransform,r=f.target,_={e:o,target:r,transform:f,action:f.action};r._scaling&&(r._scaling=!1),r.setCoords(),(f.actionPerformed||this.stateful&&r.hasStateChanged())&&this._fire("modified",_)},_onMouseDownInDrawingMode:function(o){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(o).requestRenderAll();var f=this.getPointer(o);this.freeDrawingBrush.onMouseDown(f,{e:o,pointer:f}),this._handleEvent(o,"down")},_onMouseMoveInDrawingMode:function(o){if(this._isCurrentlyDrawing){var f=this.getPointer(o);this.freeDrawingBrush.onMouseMove(f,{e:o,pointer:f})}this.setCursor(this.freeDrawingCursor),this._handleEvent(o,"move")},_onMouseUpInDrawingMode:function(o){var f=this.getPointer(o);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:o,pointer:f}),this._handleEvent(o,"up")},__onMouseDown:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"down:before");var f=this._target;if(e(o,h)){this.fireRightClick&&this._handleEvent(o,"down",h);return}if(e(o,c)){this.fireMiddleClick&&this._handleEvent(o,"down",c);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(o);return}if(this._isMainEvent(o)&&!this._currentTransform){var r=this._pointer;this._previousPointer=r;var _=this._shouldRender(f),p=this._shouldGroup(o,f);if(this._shouldClearSelection(o,f)?this.discardActiveObject(o):p&&(this._handleGrouping(o,f),f=this._activeObject),this.selection&&(!f||!f.selectable&&!f.isEditing&&f!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),f){var S=f===this._activeObject;f.selectable&&f.activeOn==="down"&&this.setActiveObject(f,o);var C=f._findTargetCorner(this.getPointer(o,!0),u.util.isTouchEvent(o));if(f.__corner=C,f===this._activeObject&&(C||!p)){this._setupCurrentTransform(o,f,S);var x=f.controls[C],r=this.getPointer(o),P=x&&x.getMouseDownHandler(o,f,x);P&&P(o,this._currentTransform,r.x,r.y)}}this._handleEvent(o,"down"),(_||p)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(o){this._resetTransformEventData(),this._pointer=this.getPointer(o,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(o)||null},_beforeTransform:function(o){var f=this._currentTransform;this.stateful&&f.target.saveState(),this.fire("before:transform",{e:o,transform:f})},__onMouseMove:function(o){this._handleEvent(o,"move:before"),this._cacheTransformEventData(o);var f,r;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(o);return}if(this._isMainEvent(o)){var _=this._groupSelector;_?(r=this._absolutePointer,_.left=r.x-_.ex,_.top=r.y-_.ey,this.renderTop()):this._currentTransform?this._transformObject(o):(f=this.findTarget(o)||null,this._setCursorFromEvent(o,f),this._fireOverOutEvents(f,o)),this._handleEvent(o,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(o,f){var r=this._hoveredTarget,_=this._hoveredTargets,p=this.targets,S=Math.max(_.length,p.length);this.fireSyntheticInOutEvents(o,f,{oldTarget:r,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var C=0;C<S;C++)this.fireSyntheticInOutEvents(p[C],f,{oldTarget:_[C],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=o,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(o,f){var r=this._draggedoverTarget,_=this._hoveredTargets,p=this.targets,S=Math.max(_.length,p.length);this.fireSyntheticInOutEvents(o,f,{oldTarget:r,evtOut:"dragleave",evtIn:"dragenter"});for(var C=0;C<S;C++)this.fireSyntheticInOutEvents(p[C],f,{oldTarget:_[C],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=o},fireSyntheticInOutEvents:function(o,f,r){var _,p,S=r.oldTarget,C,x,P=S!==o,F=r.canvasEvtIn,z=r.canvasEvtOut;P&&(_={e:f,target:o,previousTarget:S},p={e:f,target:S,nextTarget:o}),x=o&&P,C=S&&P,C&&(z&&this.fire(z,p),S.fire(r.evtOut,p)),x&&(F&&this.fire(F,_),o.fire(r.evtIn,_))},__onMouseWheel:function(o){this._cacheTransformEventData(o),this._handleEvent(o,"wheel"),this._resetTransformEventData()},_transformObject:function(o){var f=this.getPointer(o),r=this._currentTransform;r.reset=!1,r.shiftKey=o.shiftKey,r.altKey=o[this.centeredKey],this._performTransformAction(o,r,f),r.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(o,f,r){var _=r.x,p=r.y,S=f.action,C=!1,x=f.actionHandler;x&&(C=x(o,f,_,p)),S==="drag"&&C&&(f.target.isMoving=!0,this.setCursor(f.target.moveCursor||this.moveCursor)),f.actionPerformed=f.actionPerformed||C},_fire:u.controlsUtils.fireEvent,_setCursorFromEvent:function(o,f){if(!f)return this.setCursor(this.defaultCursor),!1;var r=f.hoverCursor||this.hoverCursor,_=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,p=(!_||!_.contains(f))&&f._findTargetCorner(this.getPointer(o,!0));p?this.setCursor(this.getCornerCursor(p,f,o)):(f.subTargetCheck&&this.targets.concat().reverse().map(function(S){r=S.hoverCursor||r}),this.setCursor(r))},getCornerCursor:function(o,f,r){var _=f.controls[o];return _.cursorStyleHandler(r,_,f)}})}(),function(){var g=Math.min,s=Math.max;u.util.object.extend(u.Canvas.prototype,{_shouldGroup:function(h,c){var n=this._activeObject;return n&&this._isSelectionKeyPressed(h)&&c&&c.selectable&&this.selection&&(n!==c||n.type==="activeSelection")&&!c.onSelect({e:h})},_handleGrouping:function(h,c){var n=this._activeObject;n.__corner||c===n&&(c=this.findTarget(h,!0),!c||!c.selectable)||(n&&n.type==="activeSelection"?this._updateActiveSelection(c,h):this._createActiveSelection(c,h))},_updateActiveSelection:function(h,c){var n=this._activeObject,a=n._objects.slice(0);n.contains(h)?(n.removeWithUpdate(h),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat(),n.size()===1&&this._setActiveObject(n.item(0),c)):(n.addWithUpdate(h),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(a,c)},_createActiveSelection:function(h,c){var n=this.getActiveObjects(),a=this._createGroup(h);this._hoveredTarget=a,this._setActiveObject(a,c),this._fireSelectionEvents(n,c)},_createGroup:function(h){var c=this._objects,n=c.indexOf(this._activeObject)<c.indexOf(h),a=n?[this._activeObject,h]:[h,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new u.ActiveSelection(a,{canvas:this})},_groupSelectedObjects:function(h){var c=this._collectObjects(h),n;c.length===1?this.setActiveObject(c[0],h):c.length>1&&(n=new u.ActiveSelection(c.reverse(),{canvas:this}),this.setActiveObject(n,h))},_collectObjects:function(h){for(var c=[],n,a=this._groupSelector.ex,e=this._groupSelector.ey,o=a+this._groupSelector.left,f=e+this._groupSelector.top,r=new u.Point(g(a,o),g(e,f)),_=new u.Point(s(a,o),s(e,f)),p=!this.selectionFullyContained,S=a===o&&e===f,C=this._objects.length;C--&&(n=this._objects[C],!(!(!n||!n.selectable||!n.visible)&&(p&&n.intersectsWithRect(r,_,!0)||n.isContainedWithinRect(r,_,!0)||p&&n.containsPoint(r,null,!0)||p&&n.containsPoint(_,null,!0))&&(c.push(n),S))););return c.length>1&&(c=c.filter(function(x){return!x.onSelect({e:h})})),c},_maybeGroupObjects:function(h){this.selection&&this._groupSelector&&this._groupSelectedObjects(h),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){u.util.object.extend(u.StaticCanvas.prototype,{toDataURL:function(g){g||(g={});var s=g.format||"png",h=g.quality||1,c=(g.multiplier||1)*(g.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(c,g);return u.util.toDataURL(n,s,h)},toCanvasElement:function(g,s){g=g||1,s=s||{};var h=(s.width||this.width)*g,c=(s.height||this.height)*g,n=this.getZoom(),a=this.width,e=this.height,o=n*g,f=this.viewportTransform,r=(f[4]-(s.left||0))*g,_=(f[5]-(s.top||0))*g,p=this.interactive,S=[o,0,0,o,r,_],C=this.enableRetinaScaling,x=u.util.createCanvasElement(),P=this.contextTop;return x.width=h,x.height=c,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=S,this.width=h,this.height=c,this.calcViewportBoundaries(),this.renderCanvas(x.getContext("2d"),this._objects),this.viewportTransform=f,this.width=a,this.height=e,this.calcViewportBoundaries(),this.interactive=p,this.enableRetinaScaling=C,this.contextTop=P,x}})}(),u.util.object.extend(u.StaticCanvas.prototype,{loadFromJSON:function(g,s,h){if(g){var c=typeof g=="string"?JSON.parse(g):u.util.object.clone(g),n=this,a=c.clipPath,e=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete c.clipPath,this._enlivenObjects(c.objects,function(o){n.clear(),n._setBgOverlay(c,function(){a?n._enlivenObjects([a],function(f){n.clipPath=f[0],n.__setupCanvas.call(n,c,o,e,s)}):n.__setupCanvas.call(n,c,o,e,s)})},h),this}},__setupCanvas:function(g,s,h,c){var n=this;s.forEach(function(a,e){n.insertAt(a,e)}),this.renderOnAddRemove=h,delete g.objects,delete g.backgroundImage,delete g.overlayImage,delete g.background,delete g.overlay,this._setOptions(g),this.renderAll(),c&&c()},_setBgOverlay:function(g,s){var h={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!g.backgroundImage&&!g.overlayImage&&!g.background&&!g.overlay){s&&s();return}var c=function(){h.backgroundImage&&h.overlayImage&&h.backgroundColor&&h.overlayColor&&s&&s()};this.__setBgOverlay("backgroundImage",g.backgroundImage,h,c),this.__setBgOverlay("overlayImage",g.overlayImage,h,c),this.__setBgOverlay("backgroundColor",g.background,h,c),this.__setBgOverlay("overlayColor",g.overlay,h,c)},__setBgOverlay:function(g,s,h,c){var n=this;if(!s){h[g]=!0,c&&c();return}g==="backgroundImage"||g==="overlayImage"?u.util.enlivenObjects([s],function(a){n[g]=a[0],h[g]=!0,c&&c()}):this["set"+u.util.string.capitalize(g,!0)](s,function(){h[g]=!0,c&&c()})},_enlivenObjects:function(g,s,h){if(!g||g.length===0){s&&s([]);return}u.util.enlivenObjects(g,function(c){s&&s(c)},null,h)},_toDataURL:function(g,s){this.clone(function(h){s(h.toDataURL(g))})},_toDataURLWithMultiplier:function(g,s,h){this.clone(function(c){h(c.toDataURLWithMultiplier(g,s))})},clone:function(g,s){var h=JSON.stringify(this.toJSON(s));this.cloneWithoutData(function(c){c.loadFromJSON(h,function(){g&&g(c)})})},cloneWithoutData:function(g){var s=u.util.createCanvasElement();s.width=this.width,s.height=this.height;var h=new u.Canvas(s);this.backgroundImage?(h.setBackgroundImage(this.backgroundImage.src,function(){h.renderAll(),g&&g(h)}),h.backgroundImageOpacity=this.backgroundImageOpacity,h.backgroundImageStretch=this.backgroundImageStretch):g&&g(h)}}),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.util.object.clone,n=s.util.toFixed,a=s.util.string.capitalize,e=s.util.degreesToRadians,o=!s.isLikelyNode,f=2;s.Object||(s.Object=s.util.createClass(s.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(r){r&&this.setOptions(r)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=s.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(r){var _=s.perfLimitSizeTotal,p=r.width,S=r.height,C=s.maxCacheSideLimit,x=s.minCacheSideLimit;if(p<=C&&S<=C&&p*S<=_)return p<x&&(r.width=x),S<x&&(r.height=x),r;var P=p/S,F=s.util.limitDimsByArea(P,_),z=s.util.capValue,K=z(x,F.x,C),at=z(x,F.y,C);return p>K&&(r.zoomX/=p/K,r.width=K,r.capped=!0),S>at&&(r.zoomY/=S/at,r.height=at,r.capped=!0),r},_getCacheCanvasDimensions:function(){var r=this.getTotalObjectScaling(),_=this._getTransformedDimensions(0,0),p=_.x*r.scaleX/this.scaleX,S=_.y*r.scaleY/this.scaleY;return{width:p+f,height:S+f,zoomX:r.scaleX,zoomY:r.scaleY,x:p,y:S}},_updateCacheCanvas:function(){var r=this.canvas;if(this.noScaleCache&&r&&r._currentTransform){var _=r._currentTransform.target,p=r._currentTransform.action;if(this===_&&p.slice&&p.slice(0,5)==="scale")return!1}var S=this._cacheCanvas,C=this._limitCacheSize(this._getCacheCanvasDimensions()),x=s.minCacheSideLimit,P=C.width,F=C.height,z,K,at=C.zoomX,_t=C.zoomY,dt=P!==this.cacheWidth||F!==this.cacheHeight,ct=this.zoomX!==at||this.zoomY!==_t,ut=dt||ct,ht=0,kt=0,Y=!1;if(dt){var rt=this._cacheCanvas.width,D=this._cacheCanvas.height,G=P>rt||F>D,j=(P<rt*.9||F<D*.9)&&rt>x&&D>x;Y=G||j,G&&!C.capped&&(P>x||F>x)&&(ht=P*.1,kt=F*.1)}return this instanceof s.Text&&this.path&&(ut=!0,Y=!0,ht+=this.getHeightOfLine(0)*this.zoomX,kt+=this.getHeightOfLine(0)*this.zoomY),ut?(Y?(S.width=Math.ceil(P+ht),S.height=Math.ceil(F+kt)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,S.width,S.height)),z=C.x/2,K=C.y/2,this.cacheTranslationX=Math.round(S.width/2-z)+z,this.cacheTranslationY=Math.round(S.height/2-K)+K,this.cacheWidth=P,this.cacheHeight=F,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(at,_t),this.zoomX=at,this.zoomY=_t,!0):!1},setOptions:function(r){this._setOptions(r),this._initGradient(r.fill,"fill"),this._initGradient(r.stroke,"stroke"),this._initPattern(r.fill,"fill"),this._initPattern(r.stroke,"stroke")},transform:function(r){var _=this.group&&!this.group._transformDone||this.group&&this.canvas&&r===this.canvas.contextTop,p=this.calcTransformMatrix(!_);r.transform(p[0],p[1],p[2],p[3],p[4],p[5])},toObject:function(r){var _=s.Object.NUM_FRACTION_DIGITS,p={type:this.type,version:s.version,originX:this.originX,originY:this.originY,left:n(this.left,_),top:n(this.top,_),width:n(this.width,_),height:n(this.height,_),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,_),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,_),scaleX:n(this.scaleX,_),scaleY:n(this.scaleY,_),angle:n(this.angle,_),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,_),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,_),skewY:n(this.skewY,_)};return this.clipPath&&!this.clipPath.excludeFromExport&&(p.clipPath=this.clipPath.toObject(r),p.clipPath.inverted=this.clipPath.inverted,p.clipPath.absolutePositioned=this.clipPath.absolutePositioned),s.util.populateWithProperties(this,p,r),this.includeDefaultValues||(p=this._removeDefaultValues(p)),p},toDatalessObject:function(r){return this.toObject(r)},_removeDefaultValues:function(r){var _=s.util.getKlass(r.type).prototype,p=_.stateProperties;return p.forEach(function(S){S==="left"||S==="top"||(r[S]===_[S]&&delete r[S],Array.isArray(r[S])&&Array.isArray(_[S])&&r[S].length===0&&_[S].length===0&&delete r[S])}),r},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var r=s.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(r.scaleX),scaleY:Math.abs(r.scaleY)}},getTotalObjectScaling:function(){var r=this.getObjectScaling(),_=r.scaleX,p=r.scaleY;if(this.canvas){var S=this.canvas.getZoom(),C=this.canvas.getRetinaScaling();_*=S*C,p*=S*C}return{scaleX:_,scaleY:p}},getObjectOpacity:function(){var r=this.opacity;return this.group&&(r*=this.group.getObjectOpacity()),r},_set:function(r,_){var p=r==="scaleX"||r==="scaleY",S=this[r]!==_,C=!1;return p&&(_=this._constrainScale(_)),r==="scaleX"&&_<0?(this.flipX=!this.flipX,_*=-1):r==="scaleY"&&_<0?(this.flipY=!this.flipY,_*=-1):r==="shadow"&&_&&!(_ instanceof s.Shadow)?_=new s.Shadow(_):r==="dirty"&&this.group&&this.group.set("dirty",_),this[r]=_,S&&(C=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(r)>-1?(this.dirty=!0,C&&this.group.set("dirty",!0)):C&&this.stateProperties.indexOf(r)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:s.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(r){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(r.save(),this._setupCompositeOperation(r),this.drawSelectionBackground(r),this.transform(r),this._setOpacity(r),this._setShadow(r,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(r)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(r),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),r.restore())},renderCache:function(r){r=r||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,r.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(r,_){if(r.save(),_.inverted?r.globalCompositeOperation="destination-out":r.globalCompositeOperation="destination-in",_.absolutePositioned){var p=s.util.invertTransform(this.calcTransformMatrix());r.transform(p[0],p[1],p[2],p[3],p[4],p[5])}_.transform(r),r.scale(1/_.zoomX,1/_.zoomY),r.drawImage(_._cacheCanvas,-_.cacheTranslationX,-_.cacheTranslationY),r.restore()},drawObject:function(r,_){var p=this.fill,S=this.stroke;_?(this.fill="black",this.stroke="",this._setClippingProperties(r)):this._renderBackground(r),this._render(r),this._drawClipPath(r,this.clipPath),this.fill=p,this.stroke=S},_drawClipPath:function(r,_){_&&(_.canvas=this.canvas,_.shouldCache(),_._transformDone=!0,_.renderCache({forClipping:!0}),this.drawClipPathOnCache(r,_))},drawCacheOnCanvas:function(r){r.scale(1/this.zoomX,1/this.zoomY),r.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(r){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!r&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!r){var _=this.cacheWidth/this.zoomX,p=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-_/2,-p/2,_,p)}return!0}return!1},_renderBackground:function(r){if(this.backgroundColor){var _=this._getNonTransformedDimensions();r.fillStyle=this.backgroundColor,r.fillRect(-_.x/2,-_.y/2,_.x,_.y),this._removeShadow(r)}},_setOpacity:function(r){this.group&&!this.group._transformDone?r.globalAlpha=this.getObjectOpacity():r.globalAlpha*=this.opacity},_setStrokeStyles:function(r,_){var p=_.stroke;p&&(r.lineWidth=_.strokeWidth,r.lineCap=_.strokeLineCap,r.lineDashOffset=_.strokeDashOffset,r.lineJoin=_.strokeLineJoin,r.miterLimit=_.strokeMiterLimit,p.toLive?p.gradientUnits==="percentage"||p.gradientTransform||p.patternTransform?this._applyPatternForTransformedGradient(r,p):(r.strokeStyle=p.toLive(r,this),this._applyPatternGradientTransform(r,p)):r.strokeStyle=_.stroke)},_setFillStyles:function(r,_){var p=_.fill;p&&(p.toLive?(r.fillStyle=p.toLive(r,this),this._applyPatternGradientTransform(r,_.fill)):r.fillStyle=p)},_setClippingProperties:function(r){r.globalAlpha=1,r.strokeStyle="transparent",r.fillStyle="#000000"},_setLineDash:function(r,_){!_||_.length===0||(1&_.length&&_.push.apply(_,_),r.setLineDash(_))},_renderControls:function(r,_){var p=this.getViewportTransform(),S=this.calcTransformMatrix(),C,x,P;_=_||{},x=typeof _.hasBorders<"u"?_.hasBorders:this.hasBorders,P=typeof _.hasControls<"u"?_.hasControls:this.hasControls,S=s.util.multiplyTransformMatrices(p,S),C=s.util.qrDecompose(S),r.save(),r.translate(C.translateX,C.translateY),r.lineWidth=1*this.borderScaleFactor,this.group||(r.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(C.angle-=180),r.rotate(e(this.group?C.angle:this.angle)),_.forActiveSelection||this.group?x&&this.drawBordersInGroup(r,C,_):x&&this.drawBorders(r,_),P&&this.drawControls(r,_),r.restore()},_setShadow:function(r){if(this.shadow){var _=this.shadow,p=this.canvas,S,C=p&&p.viewportTransform[0]||1,x=p&&p.viewportTransform[3]||1;_.nonScaling?S={scaleX:1,scaleY:1}:S=this.getObjectScaling(),p&&p._isRetinaScaling()&&(C*=s.devicePixelRatio,x*=s.devicePixelRatio),r.shadowColor=_.color,r.shadowBlur=_.blur*s.browserShadowBlurConstant*(C+x)*(S.scaleX+S.scaleY)/4,r.shadowOffsetX=_.offsetX*C*S.scaleX,r.shadowOffsetY=_.offsetY*x*S.scaleY}},_removeShadow:function(r){this.shadow&&(r.shadowColor="",r.shadowBlur=r.shadowOffsetX=r.shadowOffsetY=0)},_applyPatternGradientTransform:function(r,_){if(!_||!_.toLive)return{offsetX:0,offsetY:0};var p=_.gradientTransform||_.patternTransform,S=-this.width/2+_.offsetX||0,C=-this.height/2+_.offsetY||0;return _.gradientUnits==="percentage"?r.transform(this.width,0,0,this.height,S,C):r.transform(1,0,0,1,S,C),p&&r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),{offsetX:S,offsetY:C}},_renderPaintInOrder:function(r){this.paintFirst==="stroke"?(this._renderStroke(r),this._renderFill(r)):(this._renderFill(r),this._renderStroke(r))},_render:function(){},_renderFill:function(r){this.fill&&(r.save(),this._setFillStyles(r,this),this.fillRule==="evenodd"?r.fill("evenodd"):r.fill(),r.restore())},_renderStroke:function(r){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this.strokeUniform&&this.group){var _=this.getObjectScaling();r.scale(1/_.scaleX,1/_.scaleY)}else this.strokeUniform&&r.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(r,this.strokeDashArray),this._setStrokeStyles(r,this),r.stroke(),r.restore()}},_applyPatternForTransformedGradient:function(r,_){var p=this._limitCacheSize(this._getCacheCanvasDimensions()),S=s.util.createCanvasElement(),C,x=this.canvas.getRetinaScaling(),P=p.x/this.scaleX/x,F=p.y/this.scaleY/x;S.width=P,S.height=F,C=S.getContext("2d"),C.beginPath(),C.moveTo(0,0),C.lineTo(P,0),C.lineTo(P,F),C.lineTo(0,F),C.closePath(),C.translate(P/2,F/2),C.scale(p.zoomX/this.scaleX/x,p.zoomY/this.scaleY/x),this._applyPatternGradientTransform(C,_),C.fillStyle=_.toLive(r),C.fill(),r.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),r.scale(x*this.scaleX/p.zoomX,x*this.scaleY/p.zoomY),r.strokeStyle=C.createPattern(S,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var r=s.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",r.scaleX),this.set("scaleY",r.scaleY),this.angle=r.angle,this.skewX=r.skewX,this.skewY=0}},_removeTransformMatrix:function(r){var _=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),_=s.util.transformPoint(_,this.transformMatrix)),this.transformMatrix=null,r&&(this.scaleX*=r.scaleX,this.scaleY*=r.scaleY,this.cropX=r.cropX,this.cropY=r.cropY,_.x+=r.offsetLeft,_.y+=r.offsetTop,this.width=r.width,this.height=r.height),this.setPositionByOrigin(_,"center","center")},clone:function(r,_){var p=this.toObject(_);this.constructor.fromObject?this.constructor.fromObject(p,r):s.Object._fromObject("Object",p,r)},cloneAsImage:function(r,_){var p=this.toCanvasElement(_);return r&&r(new s.Image(p)),this},toCanvasElement:function(r){r||(r={});var _=s.util,p=_.saveObjectTransform(this),S=this.group,C=this.shadow,x=Math.abs,P=(r.multiplier||1)*(r.enableRetinaScaling?s.devicePixelRatio:1);delete this.group,r.withoutTransform&&_.resetObjectTransform(this),r.withoutShadow&&(this.shadow=null);var F=s.util.createCanvasElement(),z=this.getBoundingRect(!0,!0),K=this.shadow,at,_t={x:0,y:0},dt,ct,ut;K&&(dt=K.blur,K.nonScaling?at={scaleX:1,scaleY:1}:at=this.getObjectScaling(),_t.x=2*Math.round(x(K.offsetX)+dt)*x(at.scaleX),_t.y=2*Math.round(x(K.offsetY)+dt)*x(at.scaleY)),ct=z.width+_t.x,ut=z.height+_t.y,F.width=Math.ceil(ct),F.height=Math.ceil(ut);var ht=new s.StaticCanvas(F,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});r.format==="jpeg"&&(ht.backgroundColor="#fff"),this.setPositionByOrigin(new s.Point(ht.width/2,ht.height/2),"center","center");var kt=this.canvas;ht.add(this);var Y=ht.toCanvasElement(P||1,r);return this.shadow=C,this.set("canvas",kt),S&&(this.group=S),this.set(p).setCoords(),ht._objects=[],ht.dispose(),ht=null,Y},toDataURL:function(r){return r||(r={}),s.util.toDataURL(this.toCanvasElement(r),r.format||"png",r.quality||1)},isType:function(r){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===r},complexity:function(){return 1},toJSON:function(r){return this.toObject(r)},rotate:function(r){var _=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return _&&this._setOriginToCenter(),this.set("angle",r),_&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(r,_){_=_||this.canvas.getPointer(r);var p=new s.Point(_.x,_.y),S=this._getLeftTopCoords();return this.angle&&(p=s.util.rotatePoint(p,S,e(-this.angle))),{x:p.x-S.x,y:p.y-S.y}},_setupCompositeOperation:function(r){this.globalCompositeOperation&&(r.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){s.runningAnimations&&s.runningAnimations.cancelByTarget(this)}}),s.util.createAccessors&&s.util.createAccessors(s.Object),h(s.Object.prototype,s.Observable),s.Object.NUM_FRACTION_DIGITS=2,s.Object.ENLIVEN_PROPS=["clipPath"],s.Object._fromObject=function(r,_,p,S){var C=s[r];_=c(_,!0),s.util.enlivenPatterns([_.fill,_.stroke],function(x){typeof x[0]<"u"&&(_.fill=x[0]),typeof x[1]<"u"&&(_.stroke=x[1]),s.util.enlivenObjectEnlivables(_,_,function(){var P=S?new C(_[S],_):new C(_);p&&p(P)})})},s.Object.__uid=0)}(m),function(){var g=u.util.degreesToRadians,s={left:-.5,center:0,right:.5},h={top:-.5,center:0,bottom:.5};u.util.object.extend(u.Object.prototype,{translateToGivenOrigin:function(c,n,a,e,o){var f=c.x,r=c.y,_,p,S;return typeof n=="string"?n=s[n]:n-=.5,typeof e=="string"?e=s[e]:e-=.5,_=e-n,typeof a=="string"?a=h[a]:a-=.5,typeof o=="string"?o=h[o]:o-=.5,p=o-a,(_||p)&&(S=this._getTransformedDimensions(),f=c.x+_*S.x,r=c.y+p*S.y),new u.Point(f,r)},translateToCenterPoint:function(c,n,a){var e=this.translateToGivenOrigin(c,n,a,"center","center");return this.angle?u.util.rotatePoint(e,c,g(this.angle)):e},translateToOriginPoint:function(c,n,a){var e=this.translateToGivenOrigin(c,"center","center",n,a);return this.angle?u.util.rotatePoint(e,c,g(this.angle)):e},getCenterPoint:function(){var c=new u.Point(this.left,this.top);return this.translateToCenterPoint(c,this.originX,this.originY)},getPointByOrigin:function(c,n){var a=this.getCenterPoint();return this.translateToOriginPoint(a,c,n)},toLocalPoint:function(c,n,a){var e=this.getCenterPoint(),o,f;return typeof n<"u"&&typeof a<"u"?o=this.translateToGivenOrigin(e,"center","center",n,a):o=new u.Point(this.left,this.top),f=new u.Point(c.x,c.y),this.angle&&(f=u.util.rotatePoint(f,e,-g(this.angle))),f.subtractEquals(o)},setPositionByOrigin:function(c,n,a){var e=this.translateToCenterPoint(c,n,a),o=this.translateToOriginPoint(e,this.originX,this.originY);this.set("left",o.x),this.set("top",o.y)},adjustPosition:function(c){var n=g(this.angle),a=this.getScaledWidth(),e=u.util.cos(n)*a,o=u.util.sin(n)*a,f,r;typeof this.originX=="string"?f=s[this.originX]:f=this.originX-.5,typeof c=="string"?r=s[c]:r=c-.5,this.left+=e*(r-f),this.top+=o*(r-f),this.setCoords(),this.originX=c},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var c=this.getCenterPoint();this.originX="center",this.originY="center",this.left=c.x,this.top=c.y},_resetOrigin:function(){var c=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=c.x,this.top=c.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function g(a){return[new u.Point(a.tl.x,a.tl.y),new u.Point(a.tr.x,a.tr.y),new u.Point(a.br.x,a.br.y),new u.Point(a.bl.x,a.bl.y)]}var s=u.util,h=s.degreesToRadians,c=s.multiplyTransformMatrices,n=s.transformPoint;s.object.extend(u.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(a,e){return e?a?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),a?this.aCoords:this.lineCoords)},getCoords:function(a,e){return g(this._getCoords(a,e))},intersectsWithRect:function(a,e,o,f){var r=this.getCoords(o,f),_=u.Intersection.intersectPolygonRectangle(r,a,e);return _.status==="Intersection"},intersectsWithObject:function(a,e,o){var f=u.Intersection.intersectPolygonPolygon(this.getCoords(e,o),a.getCoords(e,o));return f.status==="Intersection"||a.isContainedWithinObject(this,e,o)||this.isContainedWithinObject(a,e,o)},isContainedWithinObject:function(a,e,o){for(var f=this.getCoords(e,o),r=e?a.aCoords:a.lineCoords,_=0,p=a._getImageLines(r);_<4;_++)if(!a.containsPoint(f[_],p))return!1;return!0},isContainedWithinRect:function(a,e,o,f){var r=this.getBoundingRect(o,f);return r.left>=a.x&&r.left+r.width<=e.x&&r.top>=a.y&&r.top+r.height<=e.y},containsPoint:function(a,_,o,f){var r=this._getCoords(o,f),_=_||this._getImageLines(r),p=this._findCrossPoints(a,_);return p!==0&&p%2===1},isOnScreen:function(a){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br,f=this.getCoords(!0,a);return f.some(function(r){return r.x<=o.x&&r.x>=e.x&&r.y<=o.y&&r.y>=e.y})||this.intersectsWithRect(e,o,!0,a)?!0:this._containsCenterOfCanvas(e,o,a)},_containsCenterOfCanvas:function(a,e,o){var f={x:(a.x+e.x)/2,y:(a.y+e.y)/2};return!!this.containsPoint(f,null,!0,o)},isPartiallyOnScreen:function(a){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,o=this.canvas.vptCoords.br;if(this.intersectsWithRect(e,o,!0,a))return!0;var f=this.getCoords(!0,a).every(function(r){return(r.x>=o.x||r.x<=e.x)&&(r.y>=o.y||r.y<=e.y)});return f&&this._containsCenterOfCanvas(e,o,a)},_getImageLines:function(a){var e={topline:{o:a.tl,d:a.tr},rightline:{o:a.tr,d:a.br},bottomline:{o:a.br,d:a.bl},leftline:{o:a.bl,d:a.tl}};return e},_findCrossPoints:function(a,e){var o,f,r,_,p,S=0,C;for(var x in e)if(C=e[x],!(C.o.y<a.y&&C.d.y<a.y)&&!(C.o.y>=a.y&&C.d.y>=a.y)&&(C.o.x===C.d.x&&C.o.x>=a.x?p=C.o.x:(o=0,f=(C.d.y-C.o.y)/(C.d.x-C.o.x),r=a.y-o*a.x,_=C.o.y-f*C.o.x,p=-(r-_)/(o-f)),p>=a.x&&(S+=1),S===2))break;return S},getBoundingRect:function(a,e){var o=this.getCoords(a,e);return s.makeBoundingBoxFromPoints(o)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(a){return Math.abs(a)<this.minScaleLimit?a<0?-this.minScaleLimit:this.minScaleLimit:a===0?1e-4:a},scale:function(a){return this._set("scaleX",a),this._set("scaleY",a),this.setCoords()},scaleToWidth:function(a,e){var o=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(a/this.width/o)},scaleToHeight:function(a,e){var o=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(a/this.height/o)},calcLineCoords:function(){var a=this.getViewportTransform(),e=this.padding,o=h(this.angle),f=s.cos(o),r=s.sin(o),_=f*e,p=r*e,S=_+p,C=_-p,x=this.calcACoords(),P={tl:n(x.tl,a),tr:n(x.tr,a),bl:n(x.bl,a),br:n(x.br,a)};return e&&(P.tl.x-=C,P.tl.y-=S,P.tr.x+=S,P.tr.y-=C,P.bl.x-=S,P.bl.y+=C,P.br.x+=C,P.br.y+=S),P},calcOCoords:function(){var a=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=this.getViewportTransform(),f=c(o,e),r=c(f,a),r=c(r,[1/o[0],0,0,1/o[3],0,0]),_=this._calculateCurrentDimensions(),p={};return this.forEachControl(function(S,C,x){p[C]=S.positionHandler(_,r,x)}),p},calcACoords:function(){var a=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),o=c(e,a),f=this._getTransformedDimensions(),r=f.x/2,_=f.y/2;return{tl:n({x:-r,y:-_},o),tr:n({x:r,y:-_},o),bl:n({x:-r,y:_},o),br:n({x:r,y:_},o)}},setCoords:function(a){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),a?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return s.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var a=this.getCenterPoint();return[1,0,0,1,a.x,a.y]},transformMatrixKey:function(a){var e="_",o="";return!a&&this.group&&(o=this.group.transformMatrixKey(a)+e),o+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(a){var e=this.calcOwnMatrix();if(a||!this.group)return e;var o=this.transformMatrixKey(a),f=this.matrixCache||(this.matrixCache={});return f.key===o?f.value:(this.group&&(e=c(this.group.calcTransformMatrix(!1),e)),f.key=o,f.value=e,e)},calcOwnMatrix:function(){var a=this.transformMatrixKey(!0),e=this.ownMatrixCache||(this.ownMatrixCache={});if(e.key===a)return e.value;var o=this._calcTranslateMatrix(),f={angle:this.angle,translateX:o[4],translateY:o[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return e.key=a,e.value=s.composeMatrix(f),e.value},_getNonTransformedDimensions:function(){var a=this.strokeWidth,e=this.width+a,o=this.height+a;return{x:e,y:o}},_getTransformedDimensions:function(a,e){typeof a>"u"&&(a=this.skewX),typeof e>"u"&&(e=this.skewY);var o,f,r,_=a===0&&e===0;if(this.strokeUniform?(f=this.width,r=this.height):(o=this._getNonTransformedDimensions(),f=o.x,r=o.y),_)return this._finalizeDimensions(f*this.scaleX,r*this.scaleY);var p=s.sizeAfterTransform(f,r,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:a,skewY:e});return this._finalizeDimensions(p.x,p.y)},_finalizeDimensions:function(a,e){return this.strokeUniform?{x:a+this.strokeWidth,y:e+this.strokeWidth}:{x:a,y:e}},_calculateCurrentDimensions:function(){var a=this.getViewportTransform(),e=this._getTransformedDimensions(),o=n(e,a,!0);return o.scalarAdd(2*this.padding)}})}(),u.util.object.extend(u.Object.prototype,{sendToBack:function(){return this.group?u.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?u.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(g){return this.group?u.StaticCanvas.prototype.sendBackwards.call(this.group,this,g):this.canvas&&this.canvas.sendBackwards(this,g),this},bringForward:function(g){return this.group?u.StaticCanvas.prototype.bringForward.call(this.group,this,g):this.canvas&&this.canvas.bringForward(this,g),this},moveTo:function(g){return this.group&&this.group.type!=="activeSelection"?u.StaticCanvas.prototype.moveTo.call(this.group,this,g):this.canvas&&this.canvas.moveTo(this,g),this}}),function(){function g(h,c){if(c){if(c.toLive)return h+": url(#SVGID_"+c.id+"); ";var n=new u.Color(c),a=h+": "+n.toRgb()+"; ",e=n.getAlpha();return e!==1&&(a+=h+"-opacity: "+e.toString()+"; "),a}else return h+": none; "}var s=u.util.toFixed;u.util.object.extend(u.Object.prototype,{getSvgStyles:function(h){var c=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",a=this.strokeDashArray?this.strokeDashArray.join(" "):"none",e=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",f=this.strokeLineJoin?this.strokeLineJoin:"miter",r=this.strokeMiterLimit?this.strokeMiterLimit:"4",_=typeof this.opacity<"u"?this.opacity:"1",p=this.visible?"":" visibility: hidden;",S=h?"":this.getSvgFilter(),C=g("fill",this.fill),x=g("stroke",this.stroke);return[x,"stroke-width: ",n,"; ","stroke-dasharray: ",a,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",e,"; ","stroke-linejoin: ",f,"; ","stroke-miterlimit: ",r,"; ",C,"fill-rule: ",c,"; ","opacity: ",_,";",S,p].join("")},getSvgSpanStyles:function(h,c){var n="; ",e=h.fontFamily?"font-family: "+(h.fontFamily.indexOf("'")===-1&&h.fontFamily.indexOf('"')===-1?"'"+h.fontFamily+"'":h.fontFamily)+n:"",a=h.strokeWidth?"stroke-width: "+h.strokeWidth+n:"",e=e,o=h.fontSize?"font-size: "+h.fontSize+"px"+n:"",f=h.fontStyle?"font-style: "+h.fontStyle+n:"",r=h.fontWeight?"font-weight: "+h.fontWeight+n:"",_=h.fill?g("fill",h.fill):"",p=h.stroke?g("stroke",h.stroke):"",S=this.getSvgTextDecoration(h),C=h.deltaY?"baseline-shift: "+-h.deltaY+"; ":"";return S&&(S="text-decoration: "+S+n),[p,a,e,o,f,r,S,_,C,c?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(h){return["overline","underline","line-through"].filter(function(c){return h[c.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(h,c){var n=h?this.calcTransformMatrix():this.calcOwnMatrix(),a='transform="'+u.util.matrixToSVG(n);return a+(c||"")+'" '},_setSVGBg:function(h){if(this.backgroundColor){var c=u.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,c),'" y="',s(-this.height/2,c),'" width="',s(this.width,c),'" height="',s(this.height,c),`"></rect>
`)}},toSVG:function(h){return this._createBaseSVGMarkup(this._toSVG(h),{reviver:h})},toClipPathSVG:function(h){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(h),{reviver:h})},_createBaseClipPathSVGMarkup:function(h,c){c=c||{};var n=c.reviver,a=c.additionalTransform||"",e=[this.getSvgTransform(!0,a),this.getSvgCommons()].join(""),o=h.indexOf("COMMON_PARTS");return h[o]=e,n?n(h.join("")):h.join("")},_createBaseSVGMarkup:function(h,c){c=c||{};var n=c.noStyle,a=c.reviver,e=n?"":'style="'+this.getSvgStyles()+'" ',o=c.withShadow?'style="'+this.getSvgFilter()+'" ':"",f=this.clipPath,r=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",_=f&&f.absolutePositioned,p=this.stroke,S=this.fill,C=this.shadow,x,P=[],F,z=h.indexOf("COMMON_PARTS"),K=c.additionalTransform;return f&&(f.clipPathId="CLIPPATH_"+u.Object.__uid++,F='<clipPath id="'+f.clipPathId+`" >
`+f.toClipPathSVG(a)+`</clipPath>
`),_&&P.push("<g ",o,this.getSvgCommons(),` >
`),P.push("<g ",this.getSvgTransform(!1),_?"":o+this.getSvgCommons(),` >
`),x=[e,r,n?"":this.addPaintOrder()," ",K?'transform="'+K+'" ':""].join(""),h[z]=x,S&&S.toLive&&P.push(S.toSVG(this)),p&&p.toLive&&P.push(p.toSVG(this)),C&&P.push(C.toSVG(this)),f&&P.push(F),P.push(h.join("")),P.push(`</g>
`),_&&P.push(`</g>
`),a?a(P.join("")):P.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var g=u.util.object.extend,s="stateProperties";function h(n,a,e){var o={},f=!0;e.forEach(function(r){o[r]=n[r]}),g(n[a],o,f)}function c(n,a,e){if(n===a)return!0;if(Array.isArray(n)){if(!Array.isArray(a)||n.length!==a.length)return!1;for(var o=0,f=n.length;o<f;o++)if(!c(n[o],a[o]))return!1;return!0}else if(n&&typeof n=="object"){var r=Object.keys(n),_;if(!a||typeof a!="object"||!e&&r.length!==Object.keys(a).length)return!1;for(var o=0,f=r.length;o<f;o++)if(_=r[o],!(_==="canvas"||_==="group")&&!c(n[_],a[_]))return!1;return!0}}u.util.object.extend(u.Object.prototype,{hasStateChanged:function(n){n=n||s;var a="_"+n;return Object.keys(this[a]).length<this[n].length?!0:!c(this[a],this,!0)},saveState:function(n){var a=n&&n.propertySet||s,e="_"+a;return this[e]?(h(this,e,this[a]),n&&n.stateProperties&&h(this,e,n.stateProperties),this):this.setupState(n)},setupState:function(n){n=n||{};var a=n.propertySet||s;return n.propertySet=a,this["_"+a]={},this.saveState(n),this}})}(),function(){var g=u.util.degreesToRadians;u.util.object.extend(u.Object.prototype,{_findTargetCorner:function(s,h){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var c=s.x,n=s.y,a,e,o=Object.keys(this.oCoords),f=o.length-1,r;for(this.__corner=0;f>=0;f--)if(r=o[f],!!this.isControlVisible(r)&&(e=this._getImageLines(h?this.oCoords[r].touchCorner:this.oCoords[r].corner),a=this._findCrossPoints({x:c,y:n},e),a!==0&&a%2===1))return this.__corner=r,r;return!1},forEachControl:function(s){for(var h in this.controls)s(this.controls[h],h,this)},_setCornerCoords:function(){var s=this.oCoords;for(var h in s){var c=this.controls[h];s[h].corner=c.calcCornerCoords(this.angle,this.cornerSize,s[h].x,s[h].y,!1),s[h].touchCorner=c.calcCornerCoords(this.angle,this.touchCornerSize,s[h].x,s[h].y,!0)}},drawSelectionBackground:function(s){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;s.save();var h=this.getCenterPoint(),c=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return s.translate(h.x,h.y),s.scale(1/n[0],1/n[3]),s.rotate(g(this.angle)),s.fillStyle=this.selectionBackgroundColor,s.fillRect(-c.x/2,-c.y/2,c.x,c.y),s.restore(),this},drawBorders:function(s,h){h=h||{};var c=this._calculateCurrentDimensions(),n=this.borderScaleFactor,a=c.x+n,e=c.y+n,o=typeof h.hasControls<"u"?h.hasControls:this.hasControls,f=!1;return s.save(),s.strokeStyle=h.borderColor||this.borderColor,this._setLineDash(s,h.borderDashArray||this.borderDashArray),s.strokeRect(-a/2,-e/2,a,e),o&&(s.beginPath(),this.forEachControl(function(r,_,p){r.withConnection&&r.getVisibility(p,_)&&(f=!0,s.moveTo(r.x*a,r.y*e),s.lineTo(r.x*a+r.offsetX,r.y*e+r.offsetY))}),f&&s.stroke()),s.restore(),this},drawBordersInGroup:function(s,h,c){c=c||{};var n=u.util.sizeAfterTransform(this.width,this.height,h),a=this.strokeWidth,e=this.strokeUniform,o=this.borderScaleFactor,f=n.x+a*(e?this.canvas.getZoom():h.scaleX)+o,r=n.y+a*(e?this.canvas.getZoom():h.scaleY)+o;return s.save(),this._setLineDash(s,c.borderDashArray||this.borderDashArray),s.strokeStyle=c.borderColor||this.borderColor,s.strokeRect(-f/2,-r/2,f,r),s.restore(),this},drawControls:function(s,h){h=h||{},s.save();var c=this.canvas.getRetinaScaling(),n,a;return s.setTransform(c,0,0,c,0,0),s.strokeStyle=s.fillStyle=h.cornerColor||this.cornerColor,this.transparentCorners||(s.strokeStyle=h.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(s,h.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl(function(e,o,f){a=f.oCoords[o],e.getVisibility(f,o)&&(n&&(a=u.util.transformPoint(a,n)),e.render(s,a.x,a.y,h,f))}),s.restore(),this},isControlVisible:function(s){return this.controls[s]&&this.controls[s].getVisibility(this,s)},setControlVisible:function(s,h){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[s]=h,this},setControlsVisibility:function(s){s||(s={});for(var h in s)this.setControlVisible(h,s[h]);return this},onDeselect:function(){},onSelect:function(){}})}(),u.util.object.extend(u.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(g,s){s=s||{};var h=function(){},c=s.onComplete||h,n=s.onChange||h,a=this;return u.util.animate({target:this,startValue:g.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(e){g.set("left",e),a.requestRenderAll(),n()},onComplete:function(){g.setCoords(),c()}})},fxCenterObjectV:function(g,s){s=s||{};var h=function(){},c=s.onComplete||h,n=s.onChange||h,a=this;return u.util.animate({target:this,startValue:g.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(e){g.set("top",e),a.requestRenderAll(),n()},onComplete:function(){g.setCoords(),c()}})},fxRemove:function(g,s){s=s||{};var h=function(){},c=s.onComplete||h,n=s.onChange||h,a=this;return u.util.animate({target:this,startValue:g.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){g.set("opacity",e),a.requestRenderAll(),n()},onComplete:function(){a.remove(g),c()}})}}),u.util.object.extend(u.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var g=[],s,h,c=[];for(s in arguments[0])g.push(s);for(var n=0,a=g.length;n<a;n++)s=g[n],h=n!==a-1,c.push(this._animate(s,arguments[0][s],arguments[1],h));return c}else return this._animate.apply(this,arguments)},_animate:function(g,s,h,c){var n=this,a;s=s.toString(),h?h=u.util.object.clone(h):h={},~g.indexOf(".")&&(a=g.split("."));var e=n.colorProperties.indexOf(g)>-1||a&&n.colorProperties.indexOf(a[1])>-1,o=a?this.get(a[0])[a[1]]:this.get(g);"from"in h||(h.from=o),e||(~s.indexOf("=")?s=o+parseFloat(s.replace("=","")):s=parseFloat(s));var f={target:this,startValue:h.from,endValue:s,byValue:h.by,easing:h.easing,duration:h.duration,abort:h.abort&&function(r,_,p){return h.abort.call(n,r,_,p)},onChange:function(r,_,p){a?n[a[0]][a[1]]=r:n.set(g,r),!c&&h.onChange&&h.onChange(r,_,p)},onComplete:function(r,_,p){c||(n.setCoords(),h.onComplete&&h.onComplete(r,_,p))}};return e?u.util.animateColor(f.startValue,f.endValue,f.duration,f):u.util.animate(f)}}),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};if(s.Line){s.warn("fabric.Line is already defined");return}s.Line=s.util.createClass(s.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:s.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,o){e||(e=[0,0,0,0]),this.callSuper("initialize",o),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(o)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,o){return this.callSuper("_set",e,o),typeof n[e]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){e.beginPath();var o=this.calcLinePoints();e.moveTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineWidth=this.strokeWidth;var f=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=f},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return h(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,o=this.y1<=this.y2?-1:1,f=e*this.width*.5,r=o*this.height*.5,_=e*this.width*-.5,p=o*this.height*-.5;return{x1:f,x2:_,y1:r,y2:p}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,`" />
`]}}),s.Line.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),s.Line.fromElement=function(e,o,f){f=f||{};var r=s.parseAttributes(e,s.Line.ATTRIBUTE_NAMES),_=[r.x1||0,r.y1||0,r.x2||0,r.y2||0];o(new s.Line(_,h(r,f)))},s.Line.fromObject=function(e,o){function f(_){delete _.points,o&&o(_)}var r=c(e,!0);r.points=[e.x1,e.y1,e.x2,e.y2],s.Object._fromObject("Line",r,f,"points")};function a(e,o){var f=e.origin,r=e.axis1,_=e.axis2,p=e.dimension,S=o.nearest,C=o.center,x=o.farthest;return function(){switch(this.get(f)){case S:return Math.min(this.get(r),this.get(_));case C:return Math.min(this.get(r),this.get(_))+.5*this.get(p);case x:return Math.max(this.get(r),this.get(_))}}}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.degreesToRadians;if(s.Circle){s.warn("fabric.Circle is already defined.");return}s.Circle=s.util.createClass(s.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:s.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(n,a){return this.callSuper("_set",n,a),n==="radius"&&this.setRadius(a),this},toObject:function(n){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(n))},_toSVG:function(){var n,a=0,e=0,o=(this.endAngle-this.startAngle)%360;if(o===0)n=["<circle ","COMMON_PARTS",'cx="'+a+'" cy="'+e+'" ','r="',this.radius,`" />
`];else{var f=h(this.startAngle),r=h(this.endAngle),_=this.radius,p=s.util.cos(f)*_,S=s.util.sin(f)*_,C=s.util.cos(r)*_,x=s.util.sin(r)*_,P=o>180?"1":"0";n=['<path d="M '+p+" "+S," A "+_+" "+_," 0 ",+P+" 1"," "+C+" "+x,'" ',"COMMON_PARTS",` />
`]}return n},_render:function(n){n.beginPath(),n.arc(0,0,this.radius,h(this.startAngle),h(this.endAngle),!1),this._renderPaintInOrder(n)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(n){return this.radius=n,this.set("width",n*2).set("height",n*2)}}),s.Circle.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),s.Circle.fromElement=function(n,a){var e=s.parseAttributes(n,s.Circle.ATTRIBUTE_NAMES);if(!c(e))throw new Error("value of `r` attribute is required and can not be negative");e.left=(e.left||0)-e.radius,e.top=(e.top||0)-e.radius,a(new s.Circle(e))};function c(n){return"radius"in n&&n.radius>=0}s.Circle.fromObject=function(n,a){s.Object._fromObject("Circle",n,a)}}(m),function(g){var s=g.fabric||(g.fabric={});if(s.Triangle){s.warn("fabric.Triangle is already defined");return}s.Triangle=s.util.createClass(s.Object,{type:"triangle",width:100,height:100,_render:function(h){var c=this.width/2,n=this.height/2;h.beginPath(),h.moveTo(-c,n),h.lineTo(0,-n),h.lineTo(c,n),h.closePath(),this._renderPaintInOrder(h)},_toSVG:function(){var h=this.width/2,c=this.height/2,n=[-h+" "+c,"0 "+-c,h+" "+c].join(",");return["<polygon ","COMMON_PARTS",'points="',n,'" />']}}),s.Triangle.fromObject=function(h,c){return s.Object._fromObject("Triangle",h,c)}}(m),function(g){var s=g.fabric||(g.fabric={}),h=Math.PI*2;if(s.Ellipse){s.warn("fabric.Ellipse is already defined.");return}s.Ellipse=s.util.createClass(s.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(c){this.callSuper("initialize",c),this.set("rx",c&&c.rx||0),this.set("ry",c&&c.ry||0)},_set:function(c,n){switch(this.callSuper("_set",c,n),c){case"rx":this.rx=n,this.set("width",n*2);break;case"ry":this.ry=n,this.set("height",n*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(c){return this.callSuper("toObject",["rx","ry"].concat(c))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(c){c.beginPath(),c.save(),c.transform(1,0,0,this.ry/this.rx,0,0),c.arc(0,0,this.rx,0,h,!1),c.restore(),this._renderPaintInOrder(c)}}),s.Ellipse.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),s.Ellipse.fromElement=function(c,n){var a=s.parseAttributes(c,s.Ellipse.ATTRIBUTE_NAMES);a.left=(a.left||0)-a.rx,a.top=(a.top||0)-a.ry,n(new s.Ellipse(a))},s.Ellipse.fromObject=function(c,n){s.Object._fromObject("Ellipse",c,n)}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend;if(s.Rect){s.warn("fabric.Rect is already defined");return}s.Rect=s.util.createClass(s.Object,{stateProperties:s.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(c){this.callSuper("initialize",c),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(c){var n=this.rx?Math.min(this.rx,this.width/2):0,a=this.ry?Math.min(this.ry,this.height/2):0,e=this.width,o=this.height,f=-this.width/2,r=-this.height/2,_=n!==0||a!==0,p=1-.5522847498;c.beginPath(),c.moveTo(f+n,r),c.lineTo(f+e-n,r),_&&c.bezierCurveTo(f+e-p*n,r,f+e,r+p*a,f+e,r+a),c.lineTo(f+e,r+o-a),_&&c.bezierCurveTo(f+e,r+o-p*a,f+e-p*n,r+o,f+e-n,r+o),c.lineTo(f+n,r+o),_&&c.bezierCurveTo(f+p*n,r+o,f,r+o-p*a,f,r+o-a),c.lineTo(f,r+a),_&&c.bezierCurveTo(f,r+p*a,f+p*n,r,f+n,r),c.closePath(),this._renderPaintInOrder(c)},toObject:function(c){return this.callSuper("toObject",["rx","ry"].concat(c))},_toSVG:function(){var c=-this.width/2,n=-this.height/2;return["<rect ","COMMON_PARTS",'x="',c,'" y="',n,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),s.Rect.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),s.Rect.fromElement=function(c,n,a){if(!c)return n(null);a=a||{};var e=s.parseAttributes(c,s.Rect.ATTRIBUTE_NAMES);e.left=e.left||0,e.top=e.top||0,e.height=e.height||0,e.width=e.width||0;var o=new s.Rect(h(a?s.util.object.clone(a):{},e));o.visible=o.visible&&o.width>0&&o.height>0,n(o)},s.Rect.fromObject=function(c,n){return s.Object._fromObject("Rect",c,n)}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.util.array.min,n=s.util.array.max,a=s.util.toFixed,e=s.util.projectStrokeOnPoints;if(s.Polyline){s.warn("fabric.Polyline is already defined");return}s.Polyline=s.util.createClass(s.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:s.Object.prototype.cacheProperties.concat("points"),initialize:function(o,f){f=f||{},this.points=o||[],this.callSuper("initialize",f),this._setPositionDimensions(f)},_projectStrokeOnPoints:function(){return e(this.points,this,!0)},_setPositionDimensions:function(o){var f=this._calcDimensions(o),r,_=this.exactBoundingBox?this.strokeWidth:0;this.width=f.width-_,this.height=f.height-_,o.fromSVG||(r=this.translateToGivenOrigin({x:f.left-this.strokeWidth/2+_/2,y:f.top-this.strokeWidth/2+_/2},"left","top",this.originX,this.originY)),typeof o.left>"u"&&(this.left=o.fromSVG?f.left:r.x),typeof o.top>"u"&&(this.top=o.fromSVG?f.top:r.y),this.pathOffset={x:f.left+this.width/2+_/2,y:f.top+this.height/2+_/2}},_calcDimensions:function(){var o=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,f=c(o,"x")||0,r=c(o,"y")||0,_=n(o,"x")||0,p=n(o,"y")||0,S=_-f,C=p-r;return{left:f,top:r,width:S,height:C}},toObject:function(o){return h(this.callSuper("toObject",o),{points:this.points.concat()})},_toSVG:function(){for(var o=[],f=this.pathOffset.x,r=this.pathOffset.y,_=s.Object.NUM_FRACTION_DIGITS,p=0,S=this.points.length;p<S;p++)o.push(a(this.points[p].x-f,_),",",a(this.points[p].y-r,_)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',o.join(""),`" />
`]},commonRender:function(o){var f,r=this.points.length,_=this.pathOffset.x,p=this.pathOffset.y;if(!r||isNaN(this.points[r-1].y))return!1;o.beginPath(),o.moveTo(this.points[0].x-_,this.points[0].y-p);for(var S=0;S<r;S++)f=this.points[S],o.lineTo(f.x-_,f.y-p);return!0},_render:function(o){this.commonRender(o)&&this._renderPaintInOrder(o)},complexity:function(){return this.get("points").length}}),s.Polyline.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polyline.fromElementGenerator=function(o){return function(f,r,_){if(!f)return r(null);_||(_={});var p=s.parsePointsAttribute(f.getAttribute("points")),S=s.parseAttributes(f,s[o].ATTRIBUTE_NAMES);S.fromSVG=!0,r(new s[o](p,h(S,_)))}},s.Polyline.fromElement=s.Polyline.fromElementGenerator("Polyline"),s.Polyline.fromObject=function(o,f){return s.Object._fromObject("Polyline",o,f,"points")}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.projectStrokeOnPoints;if(s.Polygon){s.warn("fabric.Polygon is already defined");return}s.Polygon=s.util.createClass(s.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return h(this.points,this)},_render:function(c){this.commonRender(c)&&(c.closePath(),this._renderPaintInOrder(c))}}),s.Polygon.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polygon.fromElement=s.Polyline.fromElementGenerator("Polygon"),s.Polygon.fromObject=function(c,n){s.Object._fromObject("Polygon",c,n,"points")}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.array.min,c=s.util.array.max,n=s.util.object.extend,a=s.util.object.clone,e=s.util.toFixed;if(s.Path){s.warn("fabric.Path is already defined");return}s.Path=s.util.createClass(s.Object,{type:"path",path:null,cacheProperties:s.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:s.Object.prototype.stateProperties.concat("path"),initialize:function(o,f){f=a(f||{}),delete f.path,this.callSuper("initialize",f),this._setPath(o||[],f)},_setPath:function(o,f){this.path=s.util.makePathSimpler(Array.isArray(o)?o:s.util.parsePath(o)),s.Polyline.prototype._setPositionDimensions.call(this,f||{})},_renderPathCommands:function(o){var f,r=0,_=0,p=0,S=0,C=0,x=0,P=-this.pathOffset.x,F=-this.pathOffset.y;o.beginPath();for(var z=0,K=this.path.length;z<K;++z)switch(f=this.path[z],f[0]){case"L":p=f[1],S=f[2],o.lineTo(p+P,S+F);break;case"M":p=f[1],S=f[2],r=p,_=S,o.moveTo(p+P,S+F);break;case"C":p=f[5],S=f[6],C=f[3],x=f[4],o.bezierCurveTo(f[1]+P,f[2]+F,C+P,x+F,p+P,S+F);break;case"Q":o.quadraticCurveTo(f[1]+P,f[2]+F,f[3]+P,f[4]+F),p=f[3],S=f[4],C=f[1],x=f[2];break;case"z":case"Z":p=r,S=_,o.closePath();break}},_render:function(o){this._renderPathCommands(o),this._renderPaintInOrder(o)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(o){return n(this.callSuper("toObject",o),{path:this.path.map(function(f){return f.slice()})})},toDatalessObject:function(o){var f=this.toObject(["sourcePath"].concat(o));return f.sourcePath&&delete f.path,f},_toSVG:function(){var o=s.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',o,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var o=s.Object.NUM_FRACTION_DIGITS;return" translate("+e(-this.pathOffset.x,o)+", "+e(-this.pathOffset.y,o)+")"},toClipPathSVG:function(o){var f=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:f})},toSVG:function(o){var f=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:o,additionalTransform:f})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var o=[],f=[],r,_=0,p=0,S=0,C=0,x,P=0,F=this.path.length;P<F;++P){switch(r=this.path[P],r[0]){case"L":S=r[1],C=r[2],x=[];break;case"M":S=r[1],C=r[2],_=S,p=C,x=[];break;case"C":x=s.util.getBoundsOfCurve(S,C,r[1],r[2],r[3],r[4],r[5],r[6]),S=r[5],C=r[6];break;case"Q":x=s.util.getBoundsOfCurve(S,C,r[1],r[2],r[1],r[2],r[3],r[4]),S=r[3],C=r[4];break;case"z":case"Z":S=_,C=p;break}x.forEach(function(ut){o.push(ut.x),f.push(ut.y)}),o.push(S),f.push(C)}var z=h(o)||0,K=h(f)||0,at=c(o)||0,_t=c(f)||0,dt=at-z,ct=_t-K;return{left:z,top:K,width:dt,height:ct}}}),s.Path.fromObject=function(o,f){if(typeof o.sourcePath=="string"){var r=o.sourcePath;s.loadSVGFromURL(r,function(_){var p=_[0];p.setOptions(o),o.clipPath?s.util.enlivenObjects([o.clipPath],function(S){p.clipPath=S[0],f&&f(p)}):f&&f(p)})}else s.Object._fromObject("Path",o,f,"path")},s.Path.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(["d"]),s.Path.fromElement=function(o,f,r){var _=s.parseAttributes(o,s.Path.ATTRIBUTE_NAMES);_.fromSVG=!0,f(new s.Path(_.d,n(_,r)))}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.array.min,c=s.util.array.max;s.Group||(s.Group=s.util.createClass(s.Object,s.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,a,e){a=a||{},this._objects=[],e&&this.callSuper("initialize",a),this._objects=n||[];for(var o=this._objects.length;o--;)this._objects[o].group=this;if(e)this._updateObjectsACoords();else{var f=a&&a.centerPoint;a.originX!==void 0&&(this.originX=a.originX),a.originY!==void 0&&(this.originY=a.originY),f||this._calcBounds(),this._updateObjectsCoords(f),delete a.centerPoint,this.callSuper("initialize",a)}this.setCoords()},_updateObjectsACoords:function(){for(var n=!0,a=this._objects.length;a--;)this._objects[a].setCoords(n)},_updateObjectsCoords:function(a){for(var a=a||this.getCenterPoint(),e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],a)},_updateObjectCoords:function(n,a){var e=n.left,o=n.top,f=!0;n.set({left:e-a.x,top:o-a.y}),n.group=this,n.setCoords(f)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var a=!!this.group;return this._restoreObjectsState(),s.util.resetObjectTransform(this),n&&(a&&s.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,a?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),s.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,a){var e=this._objects.length;if(this.useSetOnGroup)for(;e--;)this._objects[e].setOnGroup(n,a);if(n==="canvas")for(;e--;)this._objects[e]._set(n,a);s.Object.prototype._set.call(this,n,a)},toObject:function(n){var a=this.includeDefaultValues,e=this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){var r=f.includeDefaultValues;f.includeDefaultValues=a;var _=f.toObject(n);return f.includeDefaultValues=r,_}),o=s.Object.prototype.toObject.call(this,n);return o.objects=e,o},toDatalessObject:function(n){var a,e=this.sourcePath;if(e)a=e;else{var o=this.includeDefaultValues;a=this._objects.map(function(r){var _=r.includeDefaultValues;r.includeDefaultValues=o;var p=r.toDatalessObject(n);return r.includeDefaultValues=_,p})}var f=s.Object.prototype.toDatalessObject.call(this,n);return f.objects=a,f},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=s.Object.prototype.shouldCache.call(this);if(n){for(var a=0,e=this._objects.length;a<e;a++)if(this._objects[a].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(s.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,a=this._objects.length;n<a;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var a=0,e=this._objects.length;a<e;a++)this._objects[a].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var a=0,e=this._objects.length;a<e;a++)if(this._objects[a].isCacheDirty(!0)){if(this._cacheCanvas){var o=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-o/2,-f/2,o,f)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(a){s.util.addTransformToObject(a,n),delete a.group,a.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,a=this.canvas;this._objects=[];var e=this.toObject();delete e.objects;var o=new s.ActiveSelection([]);return o.set(e),o.type="activeSelection",a.remove(this),n.forEach(function(f){f.group=o,f.dirty=!0,a.add(f)}),o.canvas=a,o._objects=n,a._activeObject=o,o.setCoords(),o}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var n=!0;return this.forEachObject(function(a){a.setCoords(n)}),this},_calcBounds:function(n){for(var a=[],e=[],o,f,r,_=["tr","br","bl","tl"],p=0,S=this._objects.length,C,x=_.length;p<S;++p){for(o=this._objects[p],r=o.calcACoords(),C=0;C<x;C++)f=_[C],a.push(r[f].x),e.push(r[f].y);o.aCoords=r}this._getBounds(a,e,n)},_getBounds:function(n,a,e){var o=new s.Point(h(n),h(a)),f=new s.Point(c(n),c(a)),r=o.y||0,_=o.x||0,p=f.x-o.x||0,S=f.y-o.y||0;this.width=p,this.height=S,e||this.setPositionByOrigin({x:_,y:r},"left","top")},_toSVG:function(n){for(var a=["<g ","COMMON_PARTS",` >
`],e=0,o=this._objects.length;e<o;e++)a.push("		",this._objects[e].toSVG(n));return a.push(`</g>
`),a},getSvgStyles:function(){var n=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",a=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),a].join("")},toClipPathSVG:function(n){for(var a=[],e=0,o=this._objects.length;e<o;e++)a.push("	",this._objects[e].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(a,{reviver:n})}}),s.Group.fromObject=function(n,a){var e=n.objects,o=s.util.object.clone(n,!0);if(delete o.objects,typeof e=="string"){s.loadSVGFromURL(e,function(f){var r=s.util.groupSVGElements(f,n,e),_=o.clipPath;delete o.clipPath,r.set(o),_?s.util.enlivenObjects([_],function(p){r.clipPath=p[0],a&&a(r)}):a&&a(r)});return}s.util.enlivenObjects(e,function(f){s.util.enlivenObjectEnlivables(n,o,function(){a&&a(new s.Group(f,o,!0))})})})}(m),function(g){var s=g.fabric||(g.fabric={});s.ActiveSelection||(s.ActiveSelection=s.util.createClass(s.Group,{type:"activeSelection",initialize:function(h,c){c=c||{},this._objects=h||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;c.originX&&(this.originX=c.originX),c.originY&&(this.originY=c.originY),this._calcBounds(),this._updateObjectsCoords(),s.Object.prototype.initialize.call(this,c),this.setCoords()},toGroup:function(){var h=this._objects.concat();this._objects=[];var c=s.Object.prototype.toObject.call(this),n=new s.Group([]);if(delete c.type,n.set(c),h.forEach(function(e){e.canvas.remove(e),e.group=n}),n._objects=h,!this.canvas)return n;var a=this.canvas;return a.add(n),a._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(h,c,n){h.save(),h.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",h,c),n=n||{},typeof n.hasControls>"u"&&(n.hasControls=!1),n.forActiveSelection=!0;for(var a=0,e=this._objects.length;a<e;a++)this._objects[a]._renderControls(h,n);h.restore()}}),s.ActiveSelection.fromObject=function(h,c){s.util.enlivenObjects(h.objects,function(n){delete h.objects,c&&c(new s.ActiveSelection(n,h,!0))})})}(m),function(g){var s=u.util.object.extend;if(g.fabric||(g.fabric={}),g.fabric.Image){u.warn("fabric.Image is already defined.");return}u.Image=u.util.createClass(u.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:u.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:u.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(h,c){c||(c={}),this.filters=[],this.cacheKey="texture"+u.Object.__uid++,this.callSuper("initialize",c),this._initElement(h,c)},getElement:function(){return this._element||{}},setElement:function(h,c){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=h,this._originalElement=h,this._initConfig(c),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(h){var c=u.filterBackend;c&&c.evictCachesForKey&&c.evictCachesForKey(h)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(h){u.util.cleanUpJsdomNode(this[h]),this[h]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var h=this.getElement();return{width:h.naturalWidth||h.width,height:h.naturalHeight||h.height}},_stroke:function(h){if(!(!this.stroke||this.strokeWidth===0)){var c=this.width/2,n=this.height/2;h.beginPath(),h.moveTo(-c,-n),h.lineTo(c,-n),h.lineTo(c,n),h.lineTo(-c,n),h.lineTo(-c,-n),h.closePath()}},toObject:function(h){var c=[];this.filters.forEach(function(a){a&&c.push(a.toObject())});var n=s(this.callSuper("toObject",["cropX","cropY"].concat(h)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:c});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var h=[],c=[],n,a=this._element,e=-this.width/2,o=-this.height/2,f="",r="";if(!a)return[];if(this.hasCrop()){var _=u.Object.__uid++;h.push('<clipPath id="imageCrop_'+_+`">
`,'	<rect x="'+e+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),f=' clip-path="url(#imageCrop_'+_+')" '}if(this.imageSmoothing||(r='" image-rendering="optimizeSpeed'),c.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',e-this.cropX,'" y="',o-this.cropY,'" width="',a.width||a.naturalWidth,'" height="',a.height||a.height,r,'"',f,`></image>
`),this.stroke||this.strokeDashArray){var p=this.fill;this.fill=null,n=["	<rect ",'x="',e,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=p}return this.paintFirst!=="fill"?h=h.concat(n,c):h=h.concat(c,n),h},getSrc:function(h){var c=h?this._element:this._originalElement;return c?c.toDataURL?c.toDataURL():this.srcFromAttribute?c.getAttribute("src"):c.src:this.src||""},setSrc:function(h,c,n){return u.util.loadImage(h,function(a,e){this.setElement(a,n),this._setWidthHeight(),c&&c(this,e)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var h=this.resizeFilter,c=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),a=n.scaleX,e=n.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!h||a>c&&e>c){this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=a,this._lastScaleY=e;return}u.filterBackend||(u.filterBackend=u.initFilterBackend());var f=u.util.createCanvasElement(),r=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,_=o.width,p=o.height;f.width=_,f.height=p,this._element=f,this._lastScaleX=h.scaleX=a,this._lastScaleY=h.scaleY=e,u.filterBackend.applyFilters([h],o,_,p,this._element,r),this._filterScalingX=f.width/this._originalElement.width,this._filterScalingY=f.height/this._originalElement.height},applyFilters:function(h){if(h=h||this.filters||[],h=h.filter(function(o){return o&&!o.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),h.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var c=this._originalElement,n=c.naturalWidth||c.width,a=c.naturalHeight||c.height;if(this._element===this._originalElement){var e=u.util.createCanvasElement();e.width=n,e.height=a,this._element=e,this._filteredEl=e}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,a),this._lastScaleX=1,this._lastScaleY=1;return u.filterBackend||(u.filterBackend=u.initFilterBackend()),u.filterBackend.applyFilters(h,this._originalElement,n,a,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(h){u.util.setImageSmoothing(h,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(h),this._renderPaintInOrder(h)},drawCacheOnCanvas:function(h){u.util.setImageSmoothing(h,this.imageSmoothing),u.Object.prototype.drawCacheOnCanvas.call(this,h)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(h){var c=this._element;if(c){var n=this._filterScalingX,a=this._filterScalingY,e=this.width,o=this.height,f=Math.min,r=Math.max,_=r(this.cropX,0),p=r(this.cropY,0),S=c.naturalWidth||c.width,C=c.naturalHeight||c.height,x=_*n,P=p*a,F=f(e*n,S-x),z=f(o*a,C-P),K=-e/2,at=-o/2,_t=f(e,S/n-_),dt=f(o,C/a-p);c&&h.drawImage(c,x,P,F,z,K,at,_t,dt)}},_needsResize:function(){var h=this.getTotalObjectScaling();return h.scaleX!==this._lastScaleX||h.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(h,c){this.setElement(u.util.getById(h),c),u.util.addClass(this.getElement(),u.Image.CSS_CANVAS)},_initConfig:function(h){h||(h={}),this.setOptions(h),this._setWidthHeight(h)},_initFilters:function(h,c){h&&h.length?u.util.enlivenObjects(h,function(n){c&&c(n)},"fabric.Image.filters"):c&&c()},_setWidthHeight:function(h){h||(h={});var c=this.getElement();this.width=h.width||c.naturalWidth||c.width||0,this.height=h.height||c.naturalHeight||c.height||0},parsePreserveAspectRatioAttribute:function(){var h=u.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),c=this._element.width,n=this._element.height,a=1,e=1,o=0,f=0,r=0,_=0,p,S=this.width,C=this.height,x={width:S,height:C};return h&&(h.alignX!=="none"||h.alignY!=="none")?(h.meetOrSlice==="meet"&&(a=e=u.util.findScaleToFit(this._element,x),p=(S-c*a)/2,h.alignX==="Min"&&(o=-p),h.alignX==="Max"&&(o=p),p=(C-n*e)/2,h.alignY==="Min"&&(f=-p),h.alignY==="Max"&&(f=p)),h.meetOrSlice==="slice"&&(a=e=u.util.findScaleToCover(this._element,x),p=c-S/a,h.alignX==="Mid"&&(r=p/2),h.alignX==="Max"&&(r=p),p=n-C/e,h.alignY==="Mid"&&(_=p/2),h.alignY==="Max"&&(_=p),c=S/a,n=C/e)):(a=S/c,e=C/n),{width:c,height:n,scaleX:a,scaleY:e,offsetLeft:o,offsetTop:f,cropX:r,cropY:_}}}),u.Image.CSS_CANVAS="canvas-img",u.Image.prototype.getSvgSrc=u.Image.prototype.getSrc,u.Image.fromObject=function(h,c){var n=u.util.object.clone(h);u.util.loadImage(n.src,function(a,e){if(e){c&&c(null,!0);return}u.Image.prototype._initFilters.call(n,n.filters,function(o){n.filters=o||[],u.Image.prototype._initFilters.call(n,[n.resizeFilter],function(f){n.resizeFilter=f[0],u.util.enlivenObjectEnlivables(n,n,function(){var r=new u.Image(a,n);c(r,!1)})})})},null,n.crossOrigin)},u.Image.fromURL=function(h,c,n){u.util.loadImage(h,function(a,e){c&&c(new u.Image(a,n),e)},null,n&&n.crossOrigin)},u.Image.ATTRIBUTE_NAMES=u.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),u.Image.fromElement=function(h,c,n){var a=u.parseAttributes(h,u.Image.ATTRIBUTE_NAMES);u.Image.fromURL(a["xlink:href"],c,s(n?u.util.object.clone(n):{},a))}}(m),u.util.object.extend(u.Object.prototype,{_getAngleValueForStraighten:function(){var g=this.angle%360;return g>0?Math.round((g-1)/90)*90:Math.round(g/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(g){g=g||{};var s=function(){},h=g.onComplete||s,c=g.onChange||s,n=this;return u.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(a){n.rotate(a),c()},onComplete:function(){n.setCoords(),h()}})}}),u.util.object.extend(u.StaticCanvas.prototype,{straightenObject:function(g){return g.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(g){return g.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function g(h,c){var n="precision "+c+` float;
void main(){}`,a=h.createShader(h.FRAGMENT_SHADER);return h.shaderSource(a,n),h.compileShader(a),!!h.getShaderParameter(a,h.COMPILE_STATUS)}u.isWebglSupported=function(h){if(u.isLikelyNode)return!1;h=h||u.WebglFilterBackend.prototype.tileSize;var c=document.createElement("canvas"),n=c.getContext("webgl")||c.getContext("experimental-webgl"),a=!1;if(n){u.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),a=u.maxTextureSize>=h;for(var e=["highp","mediump","lowp"],o=0;o<3;o++)if(g(n,e[o])){u.webGlPrecision=e[o];break}}return this.isSupported=a,a},u.WebglFilterBackend=s;function s(h){h&&h.tileSize&&(this.tileSize=h.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}s.prototype={tileSize:2048,resources:{},setupGLContext:function(h,c){this.dispose(),this.createWebGLCanvas(h,c),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(h,c)},chooseFastestCopyGLTo2DMethod:function(h,c){var n=typeof window.performance<"u",a;try{new ImageData(1,1),a=!0}catch{a=!1}var e=typeof ArrayBuffer<"u",o=typeof Uint8ClampedArray<"u";if(n&&a&&e&&o){var f=u.util.createCanvasElement(),r=new ArrayBuffer(h*c*4);if(u.forceGLPutImageData){this.imageBuffer=r,this.copyGLTo2D=W;return}var _={imageBuffer:r,destinationWidth:h,destinationHeight:c,targetCanvas:f},p,S,C;f.width=h,f.height=c,p=window.performance.now(),t.call(_,this.gl,_),S=window.performance.now()-p,p=window.performance.now(),W.call(_,this.gl,_),C=window.performance.now()-p,S>C?(this.imageBuffer=r,this.copyGLTo2D=W):this.copyGLTo2D=t}},createWebGLCanvas:function(h,c){var n=u.util.createCanvasElement();n.width=h,n.height=c;var a={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},e=n.getContext("webgl",a);e||(e=n.getContext("experimental-webgl",a)),e&&(e.clearColor(0,0,0,0),this.canvas=n,this.gl=e)},applyFilters:function(h,c,n,a,e,o){var f=this.gl,r;o&&(r=this.getCachedTexture(o,c));var _={originalWidth:c.width||c.originalWidth,originalHeight:c.height||c.originalHeight,sourceWidth:n,sourceHeight:a,destinationWidth:n,destinationHeight:a,context:f,sourceTexture:this.createTexture(f,n,a,!r&&c),targetTexture:this.createTexture(f,n,a),originalTexture:r||this.createTexture(f,n,a,!r&&c),passes:h.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:e},p=f.createFramebuffer();return f.bindFramebuffer(f.FRAMEBUFFER,p),h.forEach(function(S){S&&S.applyTo(_)}),I(_),this.copyGLTo2D(f,_),f.bindTexture(f.TEXTURE_2D,null),f.deleteTexture(_.sourceTexture),f.deleteTexture(_.targetTexture),f.deleteFramebuffer(p),e.getContext("2d").setTransform(1,0,0,1,0,0),_},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(h,c,n,a,e){var o=h.createTexture();return h.bindTexture(h.TEXTURE_2D,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e||h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,e||h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),a?h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,a):h.texImage2D(h.TEXTURE_2D,0,h.RGBA,c,n,0,h.RGBA,h.UNSIGNED_BYTE,null),o},getCachedTexture:function(h,c){if(this.textureCache[h])return this.textureCache[h];var n=this.createTexture(this.gl,c.width,c.height,c);return this.textureCache[h]=n,n},evictCachesForKey:function(h){this.textureCache[h]&&(this.gl.deleteTexture(this.textureCache[h]),delete this.textureCache[h])},copyGLTo2D:t,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var h=this.gl,c={renderer:"",vendor:""};if(!h)return c;var n=h.getExtension("WEBGL_debug_renderer_info");if(n){var a=h.getParameter(n.UNMASKED_RENDERER_WEBGL),e=h.getParameter(n.UNMASKED_VENDOR_WEBGL);a&&(c.renderer=a.toLowerCase()),e&&(c.vendor=e.toLowerCase())}return this.gpuInfo=c,c}}}();function I(g){var s=g.targetCanvas,h=s.width,c=s.height,n=g.destinationWidth,a=g.destinationHeight;(h!==n||c!==a)&&(s.width=n,s.height=a)}function t(g,s){var h=g.canvas,c=s.targetCanvas,n=c.getContext("2d");n.translate(0,c.height),n.scale(1,-1);var a=h.height-c.height;n.drawImage(h,0,a,c.width,c.height,0,0,c.width,c.height)}function W(g,s){var h=s.targetCanvas,c=h.getContext("2d"),n=s.destinationWidth,a=s.destinationHeight,e=n*a*4,o=new Uint8Array(this.imageBuffer,0,e),f=new Uint8ClampedArray(this.imageBuffer,0,e);g.readPixels(0,0,n,a,g.RGBA,g.UNSIGNED_BYTE,o);var r=new ImageData(f,n,a);c.putImageData(r,0,0)}(function(){var g=function(){};u.Canvas2dFilterBackend=s;function s(){}s.prototype={evictCachesForKey:g,dispose:g,clearWebGLCaches:g,resources:{},applyFilters:function(h,c,n,a,e){var o=e.getContext("2d");o.drawImage(c,0,0,n,a);var f=o.getImageData(0,0,n,a),r=o.getImageData(0,0,n,a),_={sourceWidth:n,sourceHeight:a,imageData:f,originalEl:c,originalImageData:r,canvasEl:e,ctx:o,filterBackend:this};return h.forEach(function(p){p.applyTo(_)}),(_.imageData.width!==n||_.imageData.height!==a)&&(e.width=_.imageData.width,e.height=_.imageData.height),o.putImageData(_.imageData,0,0),_}}})(),u.Image=u.Image||{},u.Image.filters=u.Image.filters||{},u.Image.filters.BaseFilter=u.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(g){g&&this.setOptions(g)},setOptions:function(g){for(var s in g)this[s]=g[s]},createProgram:function(g,s,h){s=s||this.fragmentSource,h=h||this.vertexSource,u.webGlPrecision!=="highp"&&(s=s.replace(/precision highp float/g,"precision "+u.webGlPrecision+" float"));var c=g.createShader(g.VERTEX_SHADER);if(g.shaderSource(c,h),g.compileShader(c),!g.getShaderParameter(c,g.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+g.getShaderInfoLog(c));var n=g.createShader(g.FRAGMENT_SHADER);if(g.shaderSource(n,s),g.compileShader(n),!g.getShaderParameter(n,g.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+g.getShaderInfoLog(n));var a=g.createProgram();if(g.attachShader(a,c),g.attachShader(a,n),g.linkProgram(a),!g.getProgramParameter(a,g.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+g.getProgramInfoLog(a));var e=this.getAttributeLocations(g,a),o=this.getUniformLocations(g,a)||{};return o.uStepW=g.getUniformLocation(a,"uStepW"),o.uStepH=g.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:e,uniformLocations:o}},getAttributeLocations:function(g,s){return{aPosition:g.getAttribLocation(s,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(g,s,h){var c=s.aPosition,n=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,n),g.enableVertexAttribArray(c),g.vertexAttribPointer(c,2,g.FLOAT,!1,0,0),g.bufferData(g.ARRAY_BUFFER,h,g.STATIC_DRAW)},_setupFrameBuffer:function(g){var s=g.context,h,c;g.passes>1?(h=g.destinationWidth,c=g.destinationHeight,(g.sourceWidth!==h||g.sourceHeight!==c)&&(s.deleteTexture(g.targetTexture),g.targetTexture=g.filterBackend.createTexture(s,h,c)),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,g.targetTexture,0)):(s.bindFramebuffer(s.FRAMEBUFFER,null),s.finish())},_swapTextures:function(g){g.passes--,g.pass++;var s=g.targetTexture;g.targetTexture=g.sourceTexture,g.sourceTexture=s},isNeutralState:function(){var g=this.mainParameter,s=u.Image.filters[this.type].prototype;if(g)if(Array.isArray(s[g])){for(var h=s[g].length;h--;)if(this[g][h]!==s[g][h])return!1;return!0}else return s[g]===this[g];else return!1},applyTo:function(g){g.webgl?(this._setupFrameBuffer(g),this.applyToWebGL(g),this._swapTextures(g)):this.applyTo2d(g)},retrieveShader:function(g){return g.programCache.hasOwnProperty(this.type)||(g.programCache[this.type]=this.createProgram(g.context)),g.programCache[this.type]},applyToWebGL:function(g){var s=g.context,h=this.retrieveShader(g);g.pass===0&&g.originalTexture?s.bindTexture(s.TEXTURE_2D,g.originalTexture):s.bindTexture(s.TEXTURE_2D,g.sourceTexture),s.useProgram(h.program),this.sendAttributeData(s,h.attributeLocations,g.aPosition),s.uniform1f(h.uniformLocations.uStepW,1/g.sourceWidth),s.uniform1f(h.uniformLocations.uStepH,1/g.sourceHeight),this.sendUniformData(s,h.uniformLocations),s.viewport(0,0,g.destinationWidth,g.destinationHeight),s.drawArrays(s.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(g,s,h){g.activeTexture(h),g.bindTexture(g.TEXTURE_2D,s),g.activeTexture(g.TEXTURE0)},unbindAdditionalTexture:function(g,s){g.activeTexture(s),g.bindTexture(g.TEXTURE_2D,null),g.activeTexture(g.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(g){this[this.mainParameter]=g},sendUniformData:function(){},createHelpLayer:function(g){if(!g.helpLayer){var s=document.createElement("canvas");s.width=g.sourceWidth,s.height=g.sourceHeight,g.helpLayer=s}},toObject:function(){var g={type:this.type},s=this.mainParameter;return s&&(g[s]=this[s]),g},toJSON:function(){return this.toObject()}}),u.Image.filters.BaseFilter.fromObject=function(g,s){var h=new u.Image.filters[g.type](g);return s&&s(h),h},function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.ColorMatrix=c(h.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var a=n.imageData,e=a.data,o=e.length,f=this.matrix,r,_,p,S,C,x=this.colorsOnly;for(C=0;C<o;C+=4)r=e[C],_=e[C+1],p=e[C+2],x?(e[C]=r*f[0]+_*f[1]+p*f[2]+f[4]*255,e[C+1]=r*f[5]+_*f[6]+p*f[7]+f[9]*255,e[C+2]=r*f[10]+_*f[11]+p*f[12]+f[14]*255):(S=e[C+3],e[C]=r*f[0]+_*f[1]+p*f[2]+S*f[3]+f[4]*255,e[C+1]=r*f[5]+_*f[6]+p*f[7]+S*f[8]+f[9]*255,e[C+2]=r*f[10]+_*f[11]+p*f[12]+S*f[13]+f[14]*255,e[C+3]=r*f[15]+_*f[16]+p*f[17]+S*f[18]+f[19]*255)},getUniformLocations:function(n,a){return{uColorMatrix:n.getUniformLocation(a,"uColorMatrix"),uConstants:n.getUniformLocation(a,"uConstants")}},sendUniformData:function(n,a){var e=this.matrix,o=[e[0],e[1],e[2],e[3],e[5],e[6],e[7],e[8],e[10],e[11],e[12],e[13],e[15],e[16],e[17],e[18]],f=[e[4],e[9],e[14],e[19]];n.uniformMatrix4fv(a.uColorMatrix,!1,o),n.uniform4fv(a.uConstants,f)}}),s.Image.filters.ColorMatrix.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Brightness=c(h.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var a=n.imageData,e=a.data,o,f=e.length,r=Math.round(this.brightness*255);for(o=0;o<f;o+=4)e[o]=e[o]+r,e[o+1]=e[o+1]+r,e[o+2]=e[o+2]+r}},getUniformLocations:function(n,a){return{uBrightness:n.getUniformLocation(a,"uBrightness")}},sendUniformData:function(n,a){n.uniform1f(a.uBrightness,this.brightness)}}),s.Image.filters.Brightness.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.Image.filters,n=s.util.createClass;c.Convolute=n(c.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(a){var e=Math.sqrt(this.matrix.length),o=this.type+"_"+e+"_"+(this.opaque?1:0),f=this.fragmentSource[o];return a.programCache.hasOwnProperty(o)||(a.programCache[o]=this.createProgram(a.context,f)),a.programCache[o]},applyTo2d:function(a){var e=a.imageData,o=e.data,f=this.matrix,r=Math.round(Math.sqrt(f.length)),_=Math.floor(r/2),p=e.width,S=e.height,C=a.ctx.createImageData(p,S),x=C.data,P=this.opaque?1:0,F,z,K,at,_t,dt,ct,ut,ht,kt,Y,rt,D;for(Y=0;Y<S;Y++)for(kt=0;kt<p;kt++){for(_t=(Y*p+kt)*4,F=0,z=0,K=0,at=0,D=0;D<r;D++)for(rt=0;rt<r;rt++)ct=Y+D-_,dt=kt+rt-_,!(ct<0||ct>=S||dt<0||dt>=p)&&(ut=(ct*p+dt)*4,ht=f[D*r+rt],F+=o[ut]*ht,z+=o[ut+1]*ht,K+=o[ut+2]*ht,P||(at+=o[ut+3]*ht));x[_t]=F,x[_t+1]=z,x[_t+2]=K,P?x[_t+3]=o[_t+3]:x[_t+3]=at}a.imageData=C},getUniformLocations:function(a,e){return{uMatrix:a.getUniformLocation(e,"uMatrix"),uOpaque:a.getUniformLocation(e,"uOpaque"),uHalfSize:a.getUniformLocation(e,"uHalfSize"),uSize:a.getUniformLocation(e,"uSize")}},sendUniformData:function(a,e){a.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return h(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),s.Image.filters.Convolute.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Grayscale=c(h.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var a=n.imageData,e=a.data,o,f=e.length,r,_=this.mode;for(o=0;o<f;o+=4)_==="average"?r=(e[o]+e[o+1]+e[o+2])/3:_==="lightness"?r=(Math.min(e[o],e[o+1],e[o+2])+Math.max(e[o],e[o+1],e[o+2]))/2:_==="luminosity"&&(r=.21*e[o]+.72*e[o+1]+.07*e[o+2]),e[o]=r,e[o+1]=r,e[o+2]=r},retrieveShader:function(n){var a=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(a)){var e=this.fragmentSource[this.mode];n.programCache[a]=this.createProgram(n.context,e)}return n.programCache[a]},getUniformLocations:function(n,a){return{uMode:n.getUniformLocation(a,"uMode")}},sendUniformData:function(n,a){var e=1;n.uniform1i(a.uMode,e)},isNeutralState:function(){return!1}}),s.Image.filters.Grayscale.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Invert=c(h.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var a=n.imageData,e=a.data,o,f=e.length;for(o=0;o<f;o+=4)e[o]=255-e[o],e[o+1]=255-e[o+1],e[o+2]=255-e[o+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,a){return{uInvert:n.getUniformLocation(a,"uInvert")}},sendUniformData:function(n,a){n.uniform1i(a.uInvert,this.invert)}}),s.Image.filters.Invert.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.Image.filters,n=s.util.createClass;c.Noise=n(c.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(a){if(this.noise!==0){var e=a.imageData,o=e.data,f,r=o.length,_=this.noise,p;for(f=0,r=o.length;f<r;f+=4)p=(.5-Math.random())*_,o[f]+=p,o[f+1]+=p,o[f+2]+=p}},getUniformLocations:function(a,e){return{uNoise:a.getUniformLocation(e,"uNoise"),uSeed:a.getUniformLocation(e,"uSeed")}},sendUniformData:function(a,e){a.uniform1f(e.uNoise,this.noise/255),a.uniform1f(e.uSeed,Math.random())},toObject:function(){return h(this.callSuper("toObject"),{noise:this.noise})}}),s.Image.filters.Noise.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Pixelate=c(h.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var a=n.imageData,e=a.data,o=a.height,f=a.width,r,_,p,S,C,x,P,F,z,K,at;for(_=0;_<o;_+=this.blocksize)for(p=0;p<f;p+=this.blocksize)for(r=_*4*f+p*4,S=e[r],C=e[r+1],x=e[r+2],P=e[r+3],K=Math.min(_+this.blocksize,o),at=Math.min(p+this.blocksize,f),F=_;F<K;F++)for(z=p;z<at;z++)r=F*4*f+z*4,e[r]=S,e[r+1]=C,e[r+2]=x,e[r+3]=P},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,a){return{uBlocksize:n.getUniformLocation(a,"uBlocksize"),uStepW:n.getUniformLocation(a,"uStepW"),uStepH:n.getUniformLocation(a,"uStepH")}},sendUniformData:function(n,a){n.uniform1f(a.uBlocksize,this.blocksize)}}),s.Image.filters.Pixelate.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.extend,c=s.Image.filters,n=s.util.createClass;c.RemoveColor=n(c.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(a){var e=a.imageData,o=e.data,f,r=this.distance*255,_,p,S,C=new s.Color(this.color).getSource(),x=[C[0]-r,C[1]-r,C[2]-r],P=[C[0]+r,C[1]+r,C[2]+r];for(f=0;f<o.length;f+=4)_=o[f],p=o[f+1],S=o[f+2],_>x[0]&&p>x[1]&&S>x[2]&&_<P[0]&&p<P[1]&&S<P[2]&&(o[f+3]=0)},getUniformLocations:function(a,e){return{uLow:a.getUniformLocation(e,"uLow"),uHigh:a.getUniformLocation(e,"uHigh")}},sendUniformData:function(a,e){var o=new s.Color(this.color).getSource(),f=parseFloat(this.distance),r=[0+o[0]/255-f,0+o[1]/255-f,0+o[2]/255-f,1],_=[o[0]/255+f,o[1]/255+f,o[2]/255+f,1];a.uniform4fv(e.uLow,r),a.uniform4fv(e.uHigh,_)},toObject:function(){return h(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),s.Image.filters.RemoveColor.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in n)h[a]=c(h.ColorMatrix,{type:a,matrix:n[a],mainParameter:!1,colorsOnly:!0}),s.Image.filters[a].fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric,h=s.Image.filters,c=s.util.createClass;h.BlendColor=c(h.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var a=this.type+"_"+this.mode,e;return n.programCache.hasOwnProperty(a)||(e=this.buildSource(this.mode),n.programCache[a]=this.createProgram(n.context,e)),n.programCache[a]},applyTo2d:function(n){var a=n.imageData,e=a.data,o=e.length,f,r,_,p,S,C,x,P=1-this.alpha;x=new s.Color(this.color).getSource(),f=x[0]*this.alpha,r=x[1]*this.alpha,_=x[2]*this.alpha;for(var F=0;F<o;F+=4)switch(p=e[F],S=e[F+1],C=e[F+2],this.mode){case"multiply":e[F]=p*f/255,e[F+1]=S*r/255,e[F+2]=C*_/255;break;case"screen":e[F]=255-(255-p)*(255-f)/255,e[F+1]=255-(255-S)*(255-r)/255,e[F+2]=255-(255-C)*(255-_)/255;break;case"add":e[F]=p+f,e[F+1]=S+r,e[F+2]=C+_;break;case"diff":case"difference":e[F]=Math.abs(p-f),e[F+1]=Math.abs(S-r),e[F+2]=Math.abs(C-_);break;case"subtract":e[F]=p-f,e[F+1]=S-r,e[F+2]=C-_;break;case"darken":e[F]=Math.min(p,f),e[F+1]=Math.min(S,r),e[F+2]=Math.min(C,_);break;case"lighten":e[F]=Math.max(p,f),e[F+1]=Math.max(S,r),e[F+2]=Math.max(C,_);break;case"overlay":e[F]=f<128?2*p*f/255:255-2*(255-p)*(255-f)/255,e[F+1]=r<128?2*S*r/255:255-2*(255-S)*(255-r)/255,e[F+2]=_<128?2*C*_/255:255-2*(255-C)*(255-_)/255;break;case"exclusion":e[F]=f+p-2*f*p/255,e[F+1]=r+S-2*r*S/255,e[F+2]=_+C-2*_*C/255;break;case"tint":e[F]=f+p*P,e[F+1]=r+S*P,e[F+2]=_+C*P}},getUniformLocations:function(n,a){return{uColor:n.getUniformLocation(a,"uColor")}},sendUniformData:function(n,a){var e=new s.Color(this.color).getSource();e[0]=this.alpha*e[0]/255,e[1]=this.alpha*e[1]/255,e[2]=this.alpha*e[2]/255,e[3]=this.alpha,n.uniform4fv(a.uColor,e)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendColor.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric,h=s.Image.filters,c=s.util.createClass;h.BlendImage=c(h.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var a=this.type+"_"+this.mode,e=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(a)||(n.programCache[a]=this.createProgram(n.context,e)),n.programCache[a]},applyToWebGL:function(n){var a=n.context,e=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(a,e,a.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(a,a.TEXTURE1)},createTexture:function(n,a){return n.getCachedTexture(a.cacheKey,a._element)},calculateMatrix:function(){var n=this.image,a=n._element.width,e=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/a,-n.top/e,1]},applyTo2d:function(n){var a=n.imageData,e=n.filterBackend.resources,o=a.data,f=o.length,r=a.width,_=a.height,p,S,C,x,P,F,z,K,at,_t,dt=this.image,ct;e.blendImage||(e.blendImage=s.util.createCanvasElement()),at=e.blendImage,_t=at.getContext("2d"),at.width!==r||at.height!==_?(at.width=r,at.height=_):_t.clearRect(0,0,r,_),_t.setTransform(dt.scaleX,0,0,dt.scaleY,dt.left,dt.top),_t.drawImage(dt._element,0,0,r,_),ct=_t.getImageData(0,0,r,_).data;for(var ut=0;ut<f;ut+=4)switch(P=o[ut],F=o[ut+1],z=o[ut+2],K=o[ut+3],p=ct[ut],S=ct[ut+1],C=ct[ut+2],x=ct[ut+3],this.mode){case"multiply":o[ut]=P*p/255,o[ut+1]=F*S/255,o[ut+2]=z*C/255,o[ut+3]=K*x/255;break;case"mask":o[ut+3]=x;break}},getUniformLocations:function(n,a){return{uTransformMatrix:n.getUniformLocation(a,"uTransformMatrix"),uImage:n.getUniformLocation(a,"uImage")}},sendUniformData:function(n,a){var e=this.calculateMatrix();n.uniform1i(a.uImage,1),n.uniformMatrix3fv(a.uTransformMatrix,!1,e)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendImage.fromObject=function(n,a){s.Image.fromObject(n.image,function(e){var o=s.util.object.clone(n);o.image=e,a(new s.Image.filters.BlendImage(o))})}}(m),function(g){var s=g.fabric||(g.fabric={}),h=Math.pow,c=Math.floor,n=Math.sqrt,a=Math.abs,e=Math.round,o=Math.sin,f=Math.ceil,r=s.Image.filters,_=s.util.createClass;r.Resize=_(r.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(p,S){return{uDelta:p.getUniformLocation(S,"uDelta"),uTaps:p.getUniformLocation(S,"uTaps")}},sendUniformData:function(p,S){p.uniform2fv(S.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),p.uniform1fv(S.uTaps,this.taps)},retrieveShader:function(p){var S=this.getFilterWindow(),C=this.type+"_"+S;if(!p.programCache.hasOwnProperty(C)){var x=this.generateShader(S);p.programCache[C]=this.createProgram(p.context,x)}return p.programCache[C]},getFilterWindow:function(){var p=this.tempScale;return Math.ceil(this.lanczosLobes/p)},getTaps:function(){for(var p=this.lanczosCreate(this.lanczosLobes),S=this.tempScale,C=this.getFilterWindow(),x=new Array(C),P=1;P<=C;P++)x[P-1]=p(P*S);return x},generateShader:function(x){for(var S=new Array(x),C=this.fragmentSourceTOP,x,P=1;P<=x;P++)S[P-1]=P+".0 * uDelta";return C+="uniform float uTaps["+x+`];
`,C+=`void main() {
`,C+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,C+=`  float sum = 1.0;
`,S.forEach(function(F,z){C+="  color += texture2D(uTexture, vTexCoord + "+F+") * uTaps["+z+`];
`,C+="  color += texture2D(uTexture, vTexCoord - "+F+") * uTaps["+z+`];
`,C+="  sum += 2.0 * uTaps["+z+`];
`}),C+=`  gl_FragColor = color / sum;
`,C+="}",C},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(p){p.webgl?(p.passes++,this.width=p.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=p.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),p.destinationWidth=this.dW,this._setupFrameBuffer(p),this.applyToWebGL(p),this._swapTextures(p),p.sourceWidth=p.destinationWidth,this.height=p.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),p.destinationHeight=this.dH,this._setupFrameBuffer(p),this.applyToWebGL(p),this._swapTextures(p),p.sourceHeight=p.destinationHeight):this.applyTo2d(p)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(p){return function(S){if(S>=p||S<=-p)return 0;if(S<11920929e-14&&S>-11920929e-14)return 1;S*=Math.PI;var C=S/p;return o(S)/S*o(C)/C}},applyTo2d:function(p){var S=p.imageData,C=this.scaleX,x=this.scaleY;this.rcpScaleX=1/C,this.rcpScaleY=1/x;var P=S.width,F=S.height,z=e(P*C),K=e(F*x),at;this.resizeType==="sliceHack"?at=this.sliceByTwo(p,P,F,z,K):this.resizeType==="hermite"?at=this.hermiteFastResize(p,P,F,z,K):this.resizeType==="bilinear"?at=this.bilinearFiltering(p,P,F,z,K):this.resizeType==="lanczos"&&(at=this.lanczosResize(p,P,F,z,K)),p.imageData=at},sliceByTwo:function(p,S,C,x,P){var F=p.imageData,z=.5,K=!1,at=!1,_t=S*z,dt=C*z,ct=s.filterBackend.resources,ut,ht,kt=0,Y=0,rt=S,D=0;for(ct.sliceByTwo||(ct.sliceByTwo=document.createElement("canvas")),ut=ct.sliceByTwo,(ut.width<S*1.5||ut.height<C)&&(ut.width=S*1.5,ut.height=C),ht=ut.getContext("2d"),ht.clearRect(0,0,S*1.5,C),ht.putImageData(F,0,0),x=c(x),P=c(P);!K||!at;)S=_t,C=dt,x<c(_t*z)?_t=c(_t*z):(_t=x,K=!0),P<c(dt*z)?dt=c(dt*z):(dt=P,at=!0),ht.drawImage(ut,kt,Y,S,C,rt,D,_t,dt),kt=rt,Y=D,D+=dt;return ht.getImageData(kt,Y,x,P)},lanczosResize:function(p,S,C,x,P){function F(j){var B,V,R,O,N,U,Z,$,st,gt,vt;for(D.x=(j+.5)*dt,G.x=c(D.x),B=0;B<P;B++){for(D.y=(B+.5)*ct,G.y=c(D.y),N=0,U=0,Z=0,$=0,st=0,V=G.x-kt;V<=G.x+kt;V++)if(!(V<0||V>=S)){gt=c(1e3*a(V-D.x)),rt[gt]||(rt[gt]={});for(var Q=G.y-Y;Q<=G.y+Y;Q++)Q<0||Q>=C||(vt=c(1e3*a(Q-D.y)),rt[gt][vt]||(rt[gt][vt]=_t(n(h(gt*ut,2)+h(vt*ht,2))/1e3)),R=rt[gt][vt],R>0&&(O=(Q*S+V)*4,N+=R,U+=R*z[O],Z+=R*z[O+1],$+=R*z[O+2],st+=R*z[O+3]))}O=(B*x+j)*4,at[O]=U/N,at[O+1]=Z/N,at[O+2]=$/N,at[O+3]=st/N}return++j<x?F(j):K}var z=p.imageData.data,K=p.ctx.createImageData(x,P),at=K.data,_t=this.lanczosCreate(this.lanczosLobes),dt=this.rcpScaleX,ct=this.rcpScaleY,ut=2/this.rcpScaleX,ht=2/this.rcpScaleY,kt=f(dt*this.lanczosLobes/2),Y=f(ct*this.lanczosLobes/2),rt={},D={},G={};return F(0)},bilinearFiltering:function(p,S,C,x,P){var F,z,K,at,_t,dt,ct,ut,ht,kt,Y,rt,D=0,G,j=this.rcpScaleX,B=this.rcpScaleY,V=4*(S-1),R=p.imageData,O=R.data,N=p.ctx.createImageData(x,P),U=N.data;for(ct=0;ct<P;ct++)for(ut=0;ut<x;ut++)for(_t=c(j*ut),dt=c(B*ct),ht=j*ut-_t,kt=B*ct-dt,G=4*(dt*S+_t),Y=0;Y<4;Y++)F=O[G+Y],z=O[G+4+Y],K=O[G+V+Y],at=O[G+V+4+Y],rt=F*(1-ht)*(1-kt)+z*ht*(1-kt)+K*kt*(1-ht)+at*ht*kt,U[D++]=rt;return N},hermiteFastResize:function(p,S,C,x,P){for(var F=this.rcpScaleX,z=this.rcpScaleY,K=f(F/2),at=f(z/2),_t=p.imageData,dt=_t.data,ct=p.ctx.createImageData(x,P),ut=ct.data,ht=0;ht<P;ht++)for(var kt=0;kt<x;kt++){for(var Y=(kt+ht*x)*4,rt=0,D=0,G=0,j=0,B=0,V=0,R=0,O=(ht+.5)*z,N=c(ht*z);N<(ht+1)*z;N++)for(var U=a(O-(N+.5))/at,Z=(kt+.5)*F,$=U*U,st=c(kt*F);st<(kt+1)*F;st++){var gt=a(Z-(st+.5))/K,vt=n($+gt*gt);vt>1&&vt<-1||(rt=2*vt*vt*vt-3*vt*vt+1,rt>0&&(gt=4*(st+N*S),R+=rt*dt[gt+3],G+=rt,dt[gt+3]<255&&(rt=rt*dt[gt+3]/250),j+=rt*dt[gt],B+=rt*dt[gt+1],V+=rt*dt[gt+2],D+=rt))}ut[Y]=j/D,ut[Y+1]=B/D,ut[Y+2]=V/D,ut[Y+3]=R/G}return ct},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),s.Image.filters.Resize.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Contrast=c(h.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var a=n.imageData,e,f,o=a.data,f=o.length,r=Math.floor(this.contrast*255),_=259*(r+255)/(255*(259-r));for(e=0;e<f;e+=4)o[e]=_*(o[e]-128)+128,o[e+1]=_*(o[e+1]-128)+128,o[e+2]=_*(o[e+2]-128)+128}},getUniformLocations:function(n,a){return{uContrast:n.getUniformLocation(a,"uContrast")}},sendUniformData:function(n,a){n.uniform1f(a.uContrast,this.contrast)}}),s.Image.filters.Contrast.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Saturation=c(h.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var a=n.imageData,e=a.data,o=e.length,f=-this.saturation,r,_;for(r=0;r<o;r+=4)_=Math.max(e[r],e[r+1],e[r+2]),e[r]+=_!==e[r]?(_-e[r])*f:0,e[r+1]+=_!==e[r+1]?(_-e[r+1])*f:0,e[r+2]+=_!==e[r+2]?(_-e[r+2])*f:0}},getUniformLocations:function(n,a){return{uSaturation:n.getUniformLocation(a,"uSaturation")}},sendUniformData:function(n,a){n.uniform1f(a.uSaturation,-this.saturation)}}),s.Image.filters.Saturation.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Vibrance=c(h.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var a=n.imageData,e=a.data,o=e.length,f=-this.vibrance,r,_,p,S;for(r=0;r<o;r+=4)_=Math.max(e[r],e[r+1],e[r+2]),p=(e[r]+e[r+1]+e[r+2])/3,S=Math.abs(_-p)*2/255*f,e[r]+=_!==e[r]?(_-e[r])*S:0,e[r+1]+=_!==e[r+1]?(_-e[r+1])*S:0,e[r+2]+=_!==e[r+2]?(_-e[r+2])*S:0}},getUniformLocations:function(n,a){return{uVibrance:n.getUniformLocation(a,"uVibrance")}},sendUniformData:function(n,a){n.uniform1f(a.uVibrance,-this.vibrance)}}),s.Image.filters.Vibrance.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Blur=c(h.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var a=n.filterBackend.resources,e,o,f=n.imageData.width,r=n.imageData.height;a.blurLayer1||(a.blurLayer1=s.util.createCanvasElement(),a.blurLayer2=s.util.createCanvasElement()),e=a.blurLayer1,o=a.blurLayer2,(e.width!==f||e.height!==r)&&(o.width=e.width=f,o.height=e.height=r);var _=e.getContext("2d"),p=o.getContext("2d"),S=15,C,x,P,F,z=this.blur*.06*.5;for(_.putImageData(n.imageData,0,0),p.clearRect(0,0,f,r),F=-S;F<=S;F++)C=(Math.random()-.5)/4,x=F/S,P=z*x*f+C,p.globalAlpha=1-Math.abs(x),p.drawImage(e,P,C),_.drawImage(o,0,0),p.globalAlpha=1,p.clearRect(0,0,o.width,o.height);for(F=-S;F<=S;F++)C=(Math.random()-.5)/4,x=F/S,P=z*x*r+C,p.globalAlpha=1-Math.abs(x),p.drawImage(e,C,P),_.drawImage(o,0,0),p.globalAlpha=1,p.clearRect(0,0,o.width,o.height);n.ctx.drawImage(e,0,0);var K=n.ctx.getImageData(0,0,e.width,e.height);return _.globalAlpha=1,_.clearRect(0,0,e.width,e.height),K},getUniformLocations:function(n,a){return{delta:n.getUniformLocation(a,"uDelta")}},sendUniformData:function(n,a){var e=this.chooseRightDelta();n.uniform2fv(a.delta,e)},chooseRightDelta:function(){var n=1,a=[0,0],e;return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),e=n*this.blur*.12,this.horizontal?a[0]=e:a[1]=e,a}}),h.Blur.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Gamma=c(h.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],h.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var a=n.imageData,e=a.data,o=this.gamma,f=e.length,r=1/o[0],_=1/o[1],p=1/o[2],S;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),S=0,f=256;S<f;S++)this.rVals[S]=Math.pow(S/255,r)*255,this.gVals[S]=Math.pow(S/255,_)*255,this.bVals[S]=Math.pow(S/255,p)*255;for(S=0,f=e.length;S<f;S+=4)e[S]=this.rVals[e[S]],e[S+1]=this.gVals[e[S+1]],e[S+2]=this.bVals[e[S+2]]},getUniformLocations:function(n,a){return{uGamma:n.getUniformLocation(a,"uGamma")}},sendUniformData:function(n,a){n.uniform3fv(a.uGamma,this.gamma)}}),s.Image.filters.Gamma.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.Composed=c(h.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(a){a.applyTo(n)})},toObject:function(){return s.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),s.Image.filters.Composed.fromObject=function(n,a){var e=n.subFilters||[],o=e.map(function(r){return new s.Image.filters[r.type](r)}),f=new s.Image.filters.Composed({subFilters:o});return a&&a(f),f}}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.Image.filters,c=s.util.createClass;h.HueRotation=c(h.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,a=s.util.cos(n),e=s.util.sin(n),o=1/3,f=Math.sqrt(o)*e,r=1-a;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=a+r/3,this.matrix[1]=o*r-f,this.matrix[2]=o*r+f,this.matrix[5]=o*r+f,this.matrix[6]=a+o*r,this.matrix[7]=o*r-f,this.matrix[10]=o*r-f,this.matrix[11]=o*r+f,this.matrix[12]=a+o*r},isNeutralState:function(n){return this.calculateMatrix(),h.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),h.BaseFilter.prototype.applyTo.call(this,n)}}),s.Image.filters.HueRotation.fromObject=s.Image.filters.BaseFilter.fromObject}(m),function(g){var s=g.fabric||(g.fabric={}),h=s.util.object.clone;if(s.Text){s.warn("fabric.Text is already defined");return}var c="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");s.Text=s.util.createClass(s.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:s.Object.prototype.stateProperties.concat(c),cacheProperties:s.Object.prototype.cacheProperties.concat(c),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,a){this.styles=a?a.styles||{}:{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",a),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=s.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return s._measuringContext||(s._measuringContext=this.canvas&&this.canvas.contextCache||s.util.createCanvasElement().getContext("2d")),s._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,a,e,o,f,r,_,p=0,S=this._textLines.length;p<S;p++)if(!(this.textAlign!=="justify"&&(p===S-1||this.isEndOfWrapping(p)))&&(o=0,f=this._textLines[p],a=this.getLineWidth(p),a<this.width&&(_=this.textLines[p].match(this._reSpacesAndTabs)))){e=_.length,n=(this.width-a)/e;for(var C=0,x=f.length;C<=x;C++)r=this.__charBounds[p][C],this._reSpaceAndTab.test(f[C])?(r.width+=n,r.kernedWidth+=n,r.left+=o,o+=n):r.left+=o}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),a=this.fontSize;return n.width+=a*n.zoomX,n.height+=a*n.zoomY,n},_render:function(n){var a=this.path;a&&!a.isNotVisible()&&a._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,a,e){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom";break}n.font=this._getFontDeclaration(a,e)},calcTextWidth:function(){for(var n=this.getLineWidth(0),a=1,e=this._textLines.length;a<e;a++){var o=this.getLineWidth(a);o>n&&(n=o)}return n},_renderTextLine:function(n,a,e,o,f,r){this._renderChars(n,a,e,o,f,r)},_renderTextLinesBackground:function(n){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var a,e,o=n.fillStyle,f,r,_=this._getLeftOffset(),p=this._getTopOffset(),S=0,C=0,x,P,F=this.path,z,K=0,at=this._textLines.length;K<at;K++){if(a=this.getHeightOfLine(K),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",K)){p+=a;continue}f=this._textLines[K],e=this._getLineLeftOffset(K),C=0,S=0,r=this.getValueOfPropertyAt(K,0,"textBackgroundColor");for(var _t=0,dt=f.length;_t<dt;_t++)x=this.__charBounds[K][_t],P=this.getValueOfPropertyAt(K,_t,"textBackgroundColor"),F?(n.save(),n.translate(x.renderLeft,x.renderTop),n.rotate(x.angle),n.fillStyle=P,P&&n.fillRect(-x.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),x.width,a/this.lineHeight),n.restore()):P!==r?(z=_+e+S,this.direction==="rtl"&&(z=this.width-z-C),n.fillStyle=r,r&&n.fillRect(z,p,C,a/this.lineHeight),S=x.left,C=x.width,r=P):C+=x.kernedWidth;P&&!F&&(z=_+e+S,this.direction==="rtl"&&(z=this.width-z-C),n.fillStyle=P,n.fillRect(z,p,C,a/this.lineHeight)),p+=a}n.fillStyle=o,this._removeShadow(n)}},getFontCache:function(n){var a=n.fontFamily.toLowerCase();s.charWidthsCache[a]||(s.charWidthsCache[a]={});var e=s.charWidthsCache[a],o=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return e[o]||(e[o]={}),e[o]},_measureChar:function(n,a,e,o){var f=this.getFontCache(a),r=this._getFontDeclaration(a),_=this._getFontDeclaration(o),p=e+n,S=r===_,C,x,P,F=a.fontSize/this.CACHE_FONT_SIZE,z;if(e&&f[e]!==void 0&&(P=f[e]),f[n]!==void 0&&(z=C=f[n]),S&&f[p]!==void 0&&(x=f[p],z=x-P),C===void 0||P===void 0||x===void 0){var K=this.getMeasuringContext();this._setTextStyles(K,a,!0)}return C===void 0&&(z=C=K.measureText(n).width,f[n]=C),P===void 0&&S&&e&&(P=K.measureText(e).width,f[e]=P),S&&x===void 0&&(x=K.measureText(p).width,f[p]=x,z=x-P),{width:C*F,kernedWidth:z*F}},getHeightOfChar:function(n,a){return this.getValueOfPropertyAt(n,a,"fontSize")},measureLine:function(n){var a=this._measureLine(n);return this.charSpacing!==0&&(a.width-=this._getWidthOfCharSpacing()),a.width<0&&(a.width=0),a},_measureLine:function(n){var a=0,e,o,f=this._textLines[n],r,_,p=0,S=new Array(f.length),C=0,x,P,F=this.path,z=this.pathSide==="right";for(this.__charBounds[n]=S,e=0;e<f.length;e++)o=f[e],_=this._getGraphemeBox(o,n,e,r),S[e]=_,a+=_.kernedWidth,r=o;if(S[e]={left:_?_.left+_.width:0,width:0,kernedWidth:0,height:this.fontSize},F){switch(P=F.segmentsInfo[F.segmentsInfo.length-1].length,x=s.util.getPointOnPath(F.path,0,F.segmentsInfo),x.x+=F.pathOffset.x,x.y+=F.pathOffset.y,this.textAlign){case"left":C=z?P-a:0;break;case"center":C=(P-a)/2;break;case"right":C=z?0:P-a;break}for(C+=this.pathStartOffset*(z?-1:1),e=z?f.length-1:0;z?e>=0:e<f.length;z?e--:e++)_=S[e],C>P?C%=P:C<0&&(C+=P),this._setGraphemeOnPath(C,_,x),C+=_.kernedWidth}return{width:a,numOfSpaces:p}},_setGraphemeOnPath:function(n,a,e){var o=n+a.kernedWidth/2,f=this.path,r=s.util.getPointOnPath(f.path,o,f.segmentsInfo);a.renderLeft=r.x-e.x,a.renderTop=r.y-e.y,a.angle=r.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,a,e,o,f){var r=this.getCompleteStyleDeclaration(a,e),_=o?this.getCompleteStyleDeclaration(a,e-1):{},p=this._measureChar(n,r,o,_),S=p.kernedWidth,C=p.width,x;this.charSpacing!==0&&(x=this._getWidthOfCharSpacing(),C+=x,S+=x);var P={width:C,left:0,height:r.fontSize,kernedWidth:S,deltaY:r.deltaY};if(e>0&&!f){var F=this.__charBounds[a][e-1];P.left=F.left+F.width+p.kernedWidth-p.width}return P},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var a=this._textLines[n],e=this.getHeightOfChar(n,0),o=1,f=a.length;o<f;o++)e=Math.max(this.getHeightOfChar(n,o),e);return this.__lineHeights[n]=e*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,a=0,e=0,o=this._textLines.length;e<o;e++)n=this.getHeightOfLine(e),a+=e===o-1?n/this.lineHeight:n;return a},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,a){n.save();for(var e=0,o=this._getLeftOffset(),f=this._getTopOffset(),r=0,_=this._textLines.length;r<_;r++){var p=this.getHeightOfLine(r),S=p/this.lineHeight,C=this._getLineLeftOffset(r);this._renderTextLine(a,n,this._textLines[r],o+C,f+e+S,r),e+=p}n.restore()},_renderTextFill:function(n){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,a,e,o,f,r){var _=this.getHeightOfLine(r),p=this.textAlign.indexOf("justify")!==-1,S,C,x="",P,F=0,z,K=this.path,at=!p&&this.charSpacing===0&&this.isEmptyStyles(r)&&!K,_t=this.direction==="ltr",dt=this.direction==="ltr"?1:-1,ct,ut=a.canvas.getAttribute("dir");if(a.save(),ut!==this.direction&&(a.canvas.setAttribute("dir",_t?"ltr":"rtl"),a.direction=_t?"ltr":"rtl",a.textAlign=_t?"left":"right"),f-=_*this._fontSizeFraction/this.lineHeight,at){this._renderChar(n,a,r,0,e.join(""),o,f,_),a.restore();return}for(var ht=0,kt=e.length-1;ht<=kt;ht++)z=ht===kt||this.charSpacing||K,x+=e[ht],P=this.__charBounds[r][ht],F===0?(o+=dt*(P.kernedWidth-P.width),F+=P.width):F+=P.kernedWidth,p&&!z&&this._reSpaceAndTab.test(e[ht])&&(z=!0),z||(S=S||this.getCompleteStyleDeclaration(r,ht),C=this.getCompleteStyleDeclaration(r,ht+1),z=s.util.hasStyleChanged(S,C,!1)),z&&(K?(a.save(),a.translate(P.renderLeft,P.renderTop),a.rotate(P.angle),this._renderChar(n,a,r,ht,x,-F/2,0,_),a.restore()):(ct=o,this._renderChar(n,a,r,ht,x,ct,f,_)),x="",S=C,o+=dt*F,F=0);a.restore()},_applyPatternGradientTransformText:function(n){var a=s.util.createCanvasElement(),e,o=this.width+this.strokeWidth,f=this.height+this.strokeWidth;return a.width=o,a.height=f,e=a.getContext("2d"),e.beginPath(),e.moveTo(0,0),e.lineTo(o,0),e.lineTo(o,f),e.lineTo(0,f),e.closePath(),e.translate(o/2,f/2),e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n),e.fill(),e.createPattern(a,"no-repeat")},handleFiller:function(n,a,e){var o,f;return e.toLive?e.gradientUnits==="percentage"||e.gradientTransform||e.patternTransform?(o=-this.width/2,f=-this.height/2,n.translate(o,f),n[a]=this._applyPatternGradientTransformText(e),{offsetX:o,offsetY:f}):(n[a]=e.toLive(n,this),this._applyPatternGradientTransform(n,e)):(n[a]=e,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,a){return n.lineWidth=a.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",a.stroke)},_setFillStyles:function(n,a){return this.handleFiller(n,"fillStyle",a.fill)},_renderChar:function(n,a,e,o,f,r,_){var p=this._getStyleDeclaration(e,o),S=this.getCompleteStyleDeclaration(e,o),C=n==="fillText"&&S.fill,x=n==="strokeText"&&S.stroke&&S.strokeWidth,P,F;!x&&!C||(a.save(),C&&(P=this._setFillStyles(a,S)),x&&(F=this._setStrokeStyles(a,S)),a.font=this._getFontDeclaration(S),p&&p.textBackgroundColor&&this._removeShadow(a),p&&p.deltaY&&(_+=p.deltaY),C&&a.fillText(f,r-P.offsetX,_-P.offsetY),x&&a.strokeText(f,r-F.offsetX,_-F.offsetY),a.restore())},setSuperscript:function(n,a){return this._setScript(n,a,this.superscript)},setSubscript:function(n,a){return this._setScript(n,a,this.subscript)},_setScript:function(n,a,e){var o=this.get2DCursorLocation(n,!0),f=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),r=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),_={fontSize:f*e.size,deltaY:r+f*e.baseline};return this.setSelectionStyles(_,n,a),this},_getLineLeftOffset:function(n){var a=this.getLineWidth(n),e=this.width-a,o=this.textAlign,f=this.direction,_,r=0,_=this.isEndOfWrapping(n);return o==="justify"||o==="justify-center"&&!_||o==="justify-right"&&!_||o==="justify-left"&&!_?0:(o==="center"&&(r=e/2),o==="right"&&(r=e),o==="justify-center"&&(r=e/2),o==="justify-right"&&(r=e),f==="rtl"&&(r-=e),r)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var a=this.measureLine(n),e=a.width;return this.__lineWidths[n]=e,e},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,a,e){var o=this._getStyleDeclaration(n,a);return o&&typeof o[e]<"u"?o[e]:this[e]},_renderTextDecoration:function(n,a){if(!(!this[a]&&!this.styleHas(a))){for(var e,o,f,r,_,p,S,C,x=this._getLeftOffset(),P=this._getTopOffset(),F,z,K,at,_t,dt,ct,ut,ht=this.path,kt=this._getWidthOfCharSpacing(),Y=this.offsets[a],rt=0,D=this._textLines.length;rt<D;rt++){if(e=this.getHeightOfLine(rt),!this[a]&&!this.styleHas(a,rt)){P+=e;continue}S=this._textLines[rt],dt=e/this.lineHeight,r=this._getLineLeftOffset(rt),z=0,K=0,C=this.getValueOfPropertyAt(rt,0,a),ut=this.getValueOfPropertyAt(rt,0,"fill"),F=P+dt*(1-this._fontSizeFraction),o=this.getHeightOfChar(rt,0),_=this.getValueOfPropertyAt(rt,0,"deltaY");for(var G=0,j=S.length;G<j;G++)if(at=this.__charBounds[rt][G],_t=this.getValueOfPropertyAt(rt,G,a),ct=this.getValueOfPropertyAt(rt,G,"fill"),f=this.getHeightOfChar(rt,G),p=this.getValueOfPropertyAt(rt,G,"deltaY"),ht&&_t&&ct)n.save(),n.fillStyle=ut,n.translate(at.renderLeft,at.renderTop),n.rotate(at.angle),n.fillRect(-at.kernedWidth/2,Y*f+p,at.kernedWidth,this.fontSize/15),n.restore();else if((_t!==C||ct!==ut||f!==o||p!==_)&&K>0){var B=x+r+z;this.direction==="rtl"&&(B=this.width-B-K),C&&ut&&(n.fillStyle=ut,n.fillRect(B,F+Y*o+_,K,this.fontSize/15)),z=at.left,K=at.width,C=_t,ut=ct,o=f,_=p}else K+=at.kernedWidth;var B=x+r+z;this.direction==="rtl"&&(B=this.width-B-K),n.fillStyle=ct,_t&&ct&&n.fillRect(B,F+Y*o+_,K-kt,this.fontSize/15),P+=e}this._removeShadow(n)}},_getFontDeclaration:function(n,a){var e=n||this,o=this.fontFamily,f=s.Text.genericFonts.indexOf(o.toLowerCase())>-1,r=o===void 0||o.indexOf("'")>-1||o.indexOf(",")>-1||o.indexOf('"')>-1||f?e.fontFamily:'"'+e.fontFamily+'"';return[s.isLikelyNode?e.fontWeight:e.fontStyle,s.isLikelyNode?e.fontStyle:e.fontWeight,a?this.CACHE_FONT_SIZE+"px":e.fontSize+"px",r].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var a=n.split(this._reNewline),e=new Array(a.length),o=[`
`],f=[],r=0;r<a.length;r++)e[r]=s.util.string.graphemeSplit(a[r]),f=f.concat(e[r],o);return f.pop(),{_unwrappedLines:e,lines:a,graphemeText:f,graphemeLines:e}},toObject:function(n){var a=c.concat(n),e=this.callSuper("toObject",a);return e.styles=s.util.stylesToArray(this.styles,this.text),e.path&&(e.path=this.path.toObject()),e},set:function(n,a){this.callSuper("set",n,a);var e=!1,o=!1;if(typeof n=="object")for(var f in n)f==="path"&&this.setPathInfo(),e=e||this._dimensionAffectingProps.indexOf(f)!==-1,o=o||f==="path";else e=this._dimensionAffectingProps.indexOf(n)!==-1,o=n==="path";return o&&this.setPathInfo(),e&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),s.Text.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),s.Text.DEFAULT_SVG_FONT_SIZE=16,s.Text.fromElement=function(n,a,e){if(!n)return a(null);var o=s.parseAttributes(n,s.Text.ATTRIBUTE_NAMES),f=o.textAnchor||"left";if(e=s.util.object.extend(e?h(e):{},o),e.top=e.top||0,e.left=e.left||0,o.textDecoration){var r=o.textDecoration;r.indexOf("underline")!==-1&&(e.underline=!0),r.indexOf("overline")!==-1&&(e.overline=!0),r.indexOf("line-through")!==-1&&(e.linethrough=!0),delete e.textDecoration}"dx"in o&&(e.left+=o.dx),"dy"in o&&(e.top+=o.dy),"fontSize"in e||(e.fontSize=s.Text.DEFAULT_SVG_FONT_SIZE);var _="";"textContent"in n?_=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(_=n.firstChild.data),_=_.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var p=e.strokeWidth;e.strokeWidth=0;var S=new s.Text(_,e),C=S.getScaledHeight()/S.height,x=(S.height+S.strokeWidth)*S.lineHeight-S.height,P=x*C,F=S.getScaledHeight()+P,z=0;f==="center"&&(z=S.getScaledWidth()/2),f==="right"&&(z=S.getScaledWidth()),S.set({left:S.left-z,top:S.top-(F-S.fontSize*(.07+S._fontSizeFraction))/S.lineHeight,strokeWidth:typeof p<"u"?p:1}),a(S)},s.Text.fromObject=function(n,a){var e=h(n),o=n.path;return delete e.path,s.Object._fromObject("Text",e,function(f){f.styles=s.util.stylesFromArray(n.styles,n.text),o?s.Object._fromObject("Path",o,function(r){f.set("path",r),a(f)},"path"):a(f)},"text")},s.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],s.util.createAccessors&&s.util.createAccessors(s.Text)}(m),function(){u.util.object.extend(u.Text.prototype,{isEmptyStyles:function(g){if(!this.styles||typeof g<"u"&&!this.styles[g])return!0;var s=typeof g>"u"?this.styles:{line:this.styles[g]};for(var h in s)for(var c in s[h])for(var n in s[h][c])return!1;return!0},styleHas:function(g,s){if(!this.styles||!g||g===""||typeof s<"u"&&!this.styles[s])return!1;var h=typeof s>"u"?this.styles:{0:this.styles[s]};for(var c in h)for(var n in h[c])if(typeof h[c][n][g]<"u")return!0;return!1},cleanStyle:function(g){if(!this.styles||!g||g==="")return!1;var s=this.styles,h=0,c,n,a=!0,e=0,o;for(var f in s){c=0;for(var r in s[f]){var o=s[f][r],_=o.hasOwnProperty(g);h++,_?(n?o[g]!==n&&(a=!1):n=o[g],o[g]===this[g]&&delete o[g]):a=!1,Object.keys(o).length!==0?c++:delete s[f][r]}c===0&&delete s[f]}for(var p=0;p<this._textLines.length;p++)e+=this._textLines[p].length;a&&h===e&&(this[g]=n,this.removeStyle(g))},removeStyle:function(g){if(!(!this.styles||!g||g==="")){var s=this.styles,h,c,n;for(c in s){h=s[c];for(n in h)delete h[n][g],Object.keys(h[n]).length===0&&delete h[n];Object.keys(h).length===0&&delete s[c]}}},_extendStyles:function(g,s){var h=this.get2DCursorLocation(g);this._getLineStyle(h.lineIndex)||this._setLineStyle(h.lineIndex),this._getStyleDeclaration(h.lineIndex,h.charIndex)||this._setStyleDeclaration(h.lineIndex,h.charIndex,{}),u.util.object.extend(this._getStyleDeclaration(h.lineIndex,h.charIndex),s)},get2DCursorLocation:function(g,s){typeof g>"u"&&(g=this.selectionStart);for(var h=s?this._unwrappedTextLines:this._textLines,c=h.length,n=0;n<c;n++){if(g<=h[n].length)return{lineIndex:n,charIndex:g};g-=h[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:h[n-1].length<g?h[n-1].length:g}},getSelectionStyles:function(g,s,h){typeof g>"u"&&(g=this.selectionStart||0),typeof s>"u"&&(s=this.selectionEnd||g);for(var c=[],n=g;n<s;n++)c.push(this.getStyleAtPosition(n,h));return c},getStyleAtPosition:function(g,s){var h=this.get2DCursorLocation(g),c=s?this.getCompleteStyleDeclaration(h.lineIndex,h.charIndex):this._getStyleDeclaration(h.lineIndex,h.charIndex);return c||{}},setSelectionStyles:function(g,s,h){typeof s>"u"&&(s=this.selectionStart||0),typeof h>"u"&&(h=this.selectionEnd||s);for(var c=s;c<h;c++)this._extendStyles(c,g);return this._forceClearCache=!0,this},_getStyleDeclaration:function(g,s){var h=this.styles&&this.styles[g];return h?h[s]:null},getCompleteStyleDeclaration:function(g,s){for(var h=this._getStyleDeclaration(g,s)||{},c={},n,a=0;a<this._styleProperties.length;a++)n=this._styleProperties[a],c[n]=typeof h[n]>"u"?this[n]:h[n];return c},_setStyleDeclaration:function(g,s,h){this.styles[g][s]=h},_deleteStyleDeclaration:function(g,s){delete this.styles[g][s]},_getLineStyle:function(g){return!!this.styles[g]},_setLineStyle:function(g){this.styles[g]={}},_deleteLineStyle:function(g){delete this.styles[g]}})}(),function(){function g(s){s.textDecoration&&(s.textDecoration.indexOf("underline")>-1&&(s.underline=!0),s.textDecoration.indexOf("line-through")>-1&&(s.linethrough=!0),s.textDecoration.indexOf("overline")>-1&&(s.overline=!0),delete s.textDecoration)}u.IText=u.util.createClass(u.Text,u.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(s,h){this.callSuper("initialize",s,h),this.initBehavior()},setSelectionStart:function(s){s=Math.max(s,0),this._updateAndFire("selectionStart",s)},setSelectionEnd:function(s){s=Math.min(s,this.text.length),this._updateAndFire("selectionEnd",s)},_updateAndFire:function(s,h){this[s]!==h&&(this._fireSelectionChanged(),this[s]=h),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(s){this.clearContextTop(),this.callSuper("render",s),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(s){this.callSuper("_render",s)},clearContextTop:function(s){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var h=this.canvas.contextTop,c=this.canvas.viewportTransform;h.save(),h.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this.transform(h),this._clearTextArea(h),s||h.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var s=this._getCursorBoundaries(),h=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(s,h):this.renderSelection(s,h),h.restore()}},_clearTextArea:function(s){var h=this.width+4,c=this.height+4;s.clearRect(-h/2,-c/2,h,c)},_getCursorBoundaries:function(s){typeof s>"u"&&(s=this.selectionStart);var h=this._getLeftOffset(),c=this._getTopOffset(),n=this._getCursorBoundariesOffsets(s);return{left:h,top:c,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(s){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var h,c,n,a=0,e=0,o,f=this.get2DCursorLocation(s);n=f.charIndex,c=f.lineIndex;for(var r=0;r<c;r++)a+=this.getHeightOfLine(r);h=this._getLineLeftOffset(c);var _=this.__charBounds[c][n];return _&&(e=_.left),this.charSpacing!==0&&n===this._textLines[c].length&&(e-=this._getWidthOfCharSpacing()),o={top:a,left:h+(e>0?e:0)},this.direction==="rtl"&&(o.left*=-1),this.cursorOffsetCache=o,this.cursorOffsetCache},renderCursor:function(s,h){var c=this.get2DCursorLocation(),n=c.lineIndex,a=c.charIndex>0?c.charIndex-1:0,e=this.getValueOfPropertyAt(n,a,"fontSize"),o=this.scaleX*this.canvas.getZoom(),f=this.cursorWidth/o,r=s.topOffset,_=this.getValueOfPropertyAt(n,a,"deltaY");r+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-e*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(s,h),h.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,a,"fill"),h.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,h.fillRect(s.left+s.leftOffset-f/2,r+s.top+_,f,e)},renderSelection:function(s,h){for(var c=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,a=this.textAlign.indexOf("justify")!==-1,e=this.get2DCursorLocation(c),o=this.get2DCursorLocation(n),f=e.lineIndex,r=o.lineIndex,_=e.charIndex<0?0:e.charIndex,p=o.charIndex<0?0:o.charIndex,S=f;S<=r;S++){var C=this._getLineLeftOffset(S)||0,x=this.getHeightOfLine(S),P=0,F=0,z=0;if(S===f&&(F=this.__charBounds[f][_].left),S>=f&&S<r)z=a&&!this.isEndOfWrapping(S)?this.width:this.getLineWidth(S)||5;else if(S===r)if(p===0)z=this.__charBounds[r][p].left;else{var K=this._getWidthOfCharSpacing();z=this.__charBounds[r][p-1].left+this.__charBounds[r][p-1].width-K}P=x,(this.lineHeight<1||S===r&&this.lineHeight>1)&&(x/=this.lineHeight);var at=s.left+C+F,_t=z-F,dt=x,ct=0;this.inCompositionMode?(h.fillStyle=this.compositionColor||"black",dt=1,ct=x):h.fillStyle=this.selectionColor,this.direction==="rtl"&&(at=this.width-at-_t),h.fillRect(at,s.top+s.topOffset+ct,_t,dt),s.topOffset+=P}},getCurrentCharFontSize:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fontSize")},getCurrentCharColor:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fill")},_getCurrentCharIndex:function(){var s=this.get2DCursorLocation(this.selectionStart,!0),h=s.charIndex>0?s.charIndex-1:0;return{l:s.lineIndex,c:h}}}),u.IText.fromObject=function(s,h){var c=u.util.stylesFromArray(s.styles,s.text),n=Object.assign({},s,{styles:c});if(g(n),n.styles)for(var a in n.styles)for(var e in n.styles[a])g(n.styles[a][e]);u.Object._fromObject("IText",n,h,"text")}}(),function(){var g=u.util.object.clone;u.util.object.extend(u.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var s=this;this.on("added",function(){var h=s.canvas;h&&(h._hasITextHandlers||(h._hasITextHandlers=!0,s._initCanvasHandlers(h)),h._iTextInstances=h._iTextInstances||[],h._iTextInstances.push(s))})},initRemovedHandler:function(){var s=this;this.on("removed",function(){var h=s.canvas;h&&(h._iTextInstances=h._iTextInstances||[],u.util.removeFromArray(h._iTextInstances,s),h._iTextInstances.length===0&&(h._hasITextHandlers=!1,s._removeCanvasHandlers(h)))})},_initCanvasHandlers:function(s){s._mouseUpITextHandler=function(){s._iTextInstances&&s._iTextInstances.forEach(function(h){h.__isMousedown=!1})},s.on("mouse:up",s._mouseUpITextHandler)},_removeCanvasHandlers:function(s){s.off("mouse:up",s._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(s,h,c,n){var a;return a={isAborted:!1,abort:function(){this.isAborted=!0}},s.animate("_currentCursorOpacity",h,{duration:c,onComplete:function(){a.isAborted||s[n]()},onChange:function(){s.canvas&&s.selectionStart===s.selectionEnd&&s.renderCursorOrSelection()},abort:function(){return a.isAborted}}),a},_onTickComplete:function(){var s=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){s._currentTickCompleteState=s._animateCursor(s,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(s){var h=this,c=s?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){h._tick()},c)},abortCursorAnimation:function(){var s=this._currentTickState||this._currentTickCompleteState,h=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,s&&h&&h.clearContext(h.contextTop||h.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(s){var h=0,c=s-1;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)h++,c--;for(;/\S/.test(this._text[c])&&c>-1;)h++,c--;return s-h},findWordBoundaryRight:function(s){var h=0,c=s;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)h++,c++;for(;/\S/.test(this._text[c])&&c<this._text.length;)h++,c++;return s+h},findLineBoundaryLeft:function(s){for(var h=0,c=s-1;!/\n/.test(this._text[c])&&c>-1;)h++,c--;return s-h},findLineBoundaryRight:function(s){for(var h=0,c=s;!/\n/.test(this._text[c])&&c<this._text.length;)h++,c++;return s+h},searchWordBoundary:function(s,h){for(var c=this._text,n=this._reSpace.test(c[s])?s-1:s,a=c[n],e=u.reNonWord;!e.test(a)&&n>0&&n<c.length;)n+=h,a=c[n];return e.test(a)&&(n+=h===1?0:1),n},selectWord:function(s){s=s||this.selectionStart;var h=this.searchWordBoundary(s,-1),c=this.searchWordBoundary(s,1);this.selectionStart=h,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(s){s=s||this.selectionStart;var h=this.findLineBoundaryLeft(s),c=this.findLineBoundaryRight(s);return this.selectionStart=h,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(s){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(s),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(s){s._iTextInstances&&s._iTextInstances.forEach(function(h){h.selected=!1,h.isEditing&&h.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(s){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var h=this.getSelectionStartFromPointer(s.e),c=this.selectionStart,n=this.selectionEnd;(h!==this.__selectionStartOnMouseDown||c===n)&&(c===h||n===h)||(h>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=h):(this.selectionStart=h,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==c||this.selectionEnd!==n)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(s,h,c){var n=c.slice(0,s),a=u.util.string.graphemeSplit(n).length;if(s===h)return{selectionStart:a,selectionEnd:a};var e=c.slice(s,h),o=u.util.string.graphemeSplit(e).length;return{selectionStart:a,selectionEnd:a+o}},fromGraphemeToStringSelection:function(s,h,c){var n=c.slice(0,s),a=n.join("").length;if(s===h)return{selectionStart:a,selectionEnd:a};var e=c.slice(s,h),o=e.join("").length;return{selectionStart:a,selectionEnd:a+o}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var s=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=s.selectionStart,this.hiddenTextarea.selectionEnd=s.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var s=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=s.selectionEnd,this.inCompositionMode||(this.selectionStart=s.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var s=this._calcTextareaPosition();this.hiddenTextarea.style.left=s.left,this.hiddenTextarea.style.top=s.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var s=this.inCompositionMode?this.compositionStart:this.selectionStart,h=this._getCursorBoundaries(s),c=this.get2DCursorLocation(s),n=c.lineIndex,a=c.charIndex,e=this.getValueOfPropertyAt(n,a,"fontSize")*this.lineHeight,o=h.leftOffset,f=this.calcTransformMatrix(),r={x:h.left+o,y:h.top+h.topOffset+e},_=this.canvas.getRetinaScaling(),p=this.canvas.upperCanvasEl,S=p.width/_,C=p.height/_,x=S-e,P=C-e,F=p.clientWidth/S,z=p.clientHeight/C;return r=u.util.transformPoint(r,f),r=u.util.transformPoint(r,this.canvas.viewportTransform),r.x*=F,r.y*=z,r.x<0&&(r.x=0),r.x>x&&(r.x=x),r.y<0&&(r.y=0),r.y>P&&(r.y=P),r.x+=this.canvas._offset.left,r.y+=this.canvas._offset.top,{left:r.x+"px",top:r.y+"px",fontSize:e+"px",charHeight:e}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var s=this._textBeforeEdit!==this.text,h=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,h&&(h.blur&&h.blur(),h.parentNode&&h.parentNode.removeChild(h)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),s&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),s&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var s in this.styles)this._textLines[s]||delete this.styles[s]},removeStyleFromTo:function(s,h){var c=this.get2DCursorLocation(s,!0),n=this.get2DCursorLocation(h,!0),a=c.lineIndex,e=c.charIndex,o=n.lineIndex,f=n.charIndex,r,_;if(a!==o){if(this.styles[a])for(r=e;r<this._unwrappedTextLines[a].length;r++)delete this.styles[a][r];if(this.styles[o])for(r=f;r<this._unwrappedTextLines[o].length;r++)_=this.styles[o][r],_&&(this.styles[a]||(this.styles[a]={}),this.styles[a][e+r-f]=_);for(r=a+1;r<=o;r++)delete this.styles[r];this.shiftLineStyles(o,a-o)}else if(this.styles[a]){_=this.styles[a];var p=f-e,S,C;for(r=e;r<f;r++)delete _[r];for(C in this.styles[a])S=parseInt(C,10),S>=f&&(_[S-p]=_[C],delete _[C])}},shiftLineStyles:function(s,h){var c=g(this.styles);for(var n in this.styles){var a=parseInt(n,10);a>s&&(this.styles[a+h]=c[a],c[a-h]||delete this.styles[a])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(s,h,c,n){var a,e={},o=!1,f=this._unwrappedTextLines[s].length===h;c||(c=1),this.shiftLineStyles(s,c),this.styles[s]&&(a=this.styles[s][h===0?h:h-1]);for(var r in this.styles[s]){var _=parseInt(r,10);_>=h&&(o=!0,e[_-h]=this.styles[s][r],f&&h===0||delete this.styles[s][r])}var p=!1;for(o&&!f&&(this.styles[s+c]=e,p=!0),p&&c--;c>0;)n&&n[c-1]?this.styles[s+c]={0:g(n[c-1])}:a?this.styles[s+c]={0:g(a)}:delete this.styles[s+c],c--;this._forceClearCache=!0},insertCharStyleObject:function(s,h,c,n){this.styles||(this.styles={});var a=this.styles[s],e=a?g(a):{};c||(c=1);for(var o in e){var f=parseInt(o,10);f>=h&&(a[f+c]=e[f],e[f-c]||delete a[f])}if(this._forceClearCache=!0,n){for(;c--;)Object.keys(n[c]).length&&(this.styles[s]||(this.styles[s]={}),this.styles[s][h+c]=g(n[c]));return}if(a)for(var r=a[h?h-1:1];r&&c--;)this.styles[s][h+c]=g(r)},insertNewStyleBlock:function(s,h,c){for(var n=this.get2DCursorLocation(h,!0),a=[0],e=0,o=0;o<s.length;o++)s[o]===`
`?(e++,a[e]=0):a[e]++;a[0]>0&&(this.insertCharStyleObject(n.lineIndex,n.charIndex,a[0],c),c=c&&c.slice(a[0]+1)),e&&this.insertNewlineStyleObject(n.lineIndex,n.charIndex+a[0],e);for(var o=1;o<e;o++)a[o]>0?this.insertCharStyleObject(n.lineIndex+o,0,a[o],c):c&&this.styles[n.lineIndex+o]&&c[0]&&(this.styles[n.lineIndex+o][0]=c[0]),c=c&&c.slice(a[o]+1);a[o]>0&&this.insertCharStyleObject(n.lineIndex+o,0,a[o],c)},setSelectionStartEndWithShift:function(s,h,c){c<=s?(h===s?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=s),this.selectionStart=c):c>s&&c<h?this._selectionDirection==="right"?this.selectionEnd=c:this.selectionStart=c:(h===s?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=h),this.selectionEnd=c)},setSelectionInBoundaries:function(){var s=this.text.length;this.selectionStart>s?this.selectionStart=s:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>s?this.selectionEnd=s:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),u.util.object.extend(u.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(g){if(this.canvas){this.__newClickTime=+new Date;var s=g.pointer;this.isTripleClick(s)&&(this.fire("tripleclick",g),this._stopEvent(g.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=s,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(g){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===g.x&&this.__lastPointer.y===g.y},_stopEvent:function(g){g.preventDefault&&g.preventDefault(),g.stopPropagation&&g.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(g){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(g.e))},tripleClickHandler:function(g){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(g.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(g){!this.canvas||!this.editable||g.e.button&&g.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(g.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(g){!this.canvas||!this.editable||g.e.button&&g.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(g){if(this.__isMousedown=!1,!(!this.editable||this.group||g.transform&&g.transform.actionPerformed||g.e.button&&g.e.button!==1)){if(this.canvas){var s=this.canvas._activeObject;if(s&&s!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(g.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(g){var s=this.getSelectionStartFromPointer(g),h=this.selectionStart,c=this.selectionEnd;g.shiftKey?this.setSelectionStartEndWithShift(h,c,s):(this.selectionStart=s,this.selectionEnd=s),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(g){for(var s=this.getLocalPointer(g),h=0,c=0,n=0,a=0,e=0,o,f,r=0,_=this._textLines.length;r<_&&n<=s.y;r++)n+=this.getHeightOfLine(r)*this.scaleY,e=r,r>0&&(a+=this._textLines[r-1].length+this.missingNewlineOffset(r-1));o=this._getLineLeftOffset(e),c=o*this.scaleX,f=this._textLines[e],this.direction==="rtl"&&(s.x=this.width*this.scaleX-s.x+c);for(var p=0,S=f.length;p<S&&(h=c,c+=this.__charBounds[e][p].kernedWidth*this.scaleX,c<=s.x);p++)a++;return this._getNewSelectionStartFromOffset(s,h,c,a,S)},_getNewSelectionStartFromOffset:function(g,s,h,c,n){var a=g.x-s,e=h-g.x,o=e>a||e<0?0:1,f=c+o;return this.flipX&&(f=n-f),f>this._text.length&&(f=this._text.length),f}}),u.util.object.extend(u.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=u.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var g=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+g.top+"; left: "+g.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+g.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):u.document.body.appendChild(this.hiddenTextarea),u.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),u.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),u.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),u.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),u.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),u.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),u.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),u.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),u.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(u.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(g){if(this.isEditing){var s=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(g.keyCode in s)this[s[g.keyCode]](g);else if(g.keyCode in this.ctrlKeysMapDown&&(g.ctrlKey||g.metaKey))this[this.ctrlKeysMapDown[g.keyCode]](g);else return;g.stopImmediatePropagation(),g.preventDefault(),g.keyCode>=33&&g.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(g){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(g.keyCode in this.ctrlKeysMapUp&&(g.ctrlKey||g.metaKey))this[this.ctrlKeysMapUp[g.keyCode]](g);else return;g.stopImmediatePropagation(),g.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(g){var s=this.fromPaste;if(this.fromPaste=!1,g&&g.stopPropagation(),!!this.isEditing){var h=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,c=this._text.length,n=h.length,a,e,o=n-c,f=this.selectionStart,r=this.selectionEnd,_=f!==r,p,S,C;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var x=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),P=f>x.selectionStart;_?(a=this._text.slice(f,r),o+=r-f):n<c&&(P?a=this._text.slice(r+o,r):a=this._text.slice(f,f-o)),e=h.slice(x.selectionEnd-o,x.selectionEnd),a&&a.length&&(e.length&&(p=this.getSelectionStyles(f,f+1,!1),p=e.map(function(){return p[0]})),_?(S=f,C=r):P?(S=r-a.length,C=r):(S=r,C=r+a.length),this.removeStyleFromTo(S,C)),e.length&&(s&&e.join("")===u.copiedText&&!u.disableStyleCopyPaste&&(p=u.copiedTextStyle),this.insertNewStyleBlock(e,f,p)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(g){this.compositionStart=g.target.selectionStart,this.compositionEnd=g.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(u.copiedText=this.getSelectedText(),u.disableStyleCopyPaste?u.copiedTextStyle=null:u.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(g){return g&&g.clipboardData||u.window.clipboardData},_getWidthBeforeCursor:function(g,s){var h=this._getLineLeftOffset(g),c;return s>0&&(c=this.__charBounds[g][s-1],h+=c.left+c.width),h},getDownCursorOffset:function(g,s){var h=this._getSelectionForOffset(g,s),c=this.get2DCursorLocation(h),n=c.lineIndex;if(n===this._textLines.length-1||g.metaKey||g.keyCode===34)return this._text.length-h;var a=c.charIndex,e=this._getWidthBeforeCursor(n,a),o=this._getIndexOnLine(n+1,e),f=this._textLines[n].slice(a);return f.length+o+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(g,s){return g.shiftKey&&this.selectionStart!==this.selectionEnd&&s?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(g,s){var h=this._getSelectionForOffset(g,s),c=this.get2DCursorLocation(h),n=c.lineIndex;if(n===0||g.metaKey||g.keyCode===33)return-h;var a=c.charIndex,e=this._getWidthBeforeCursor(n,a),o=this._getIndexOnLine(n-1,e),f=this._textLines[n].slice(0,a),r=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+o-f.length+(1-r)},_getIndexOnLine:function(g,s){for(var h=this._textLines[g],c=this._getLineLeftOffset(g),n=c,a=0,e,o,f=0,r=h.length;f<r;f++)if(e=this.__charBounds[g][f].width,n+=e,n>s){o=!0;var _=n-e,p=n,S=Math.abs(_-s),C=Math.abs(p-s);a=C<S?f:f-1;break}return o||(a=h.length-1),a},moveCursorDown:function(g){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",g)},moveCursorUp:function(g){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",g)},_moveCursorUpOrDown:function(g,s){var h="get"+g+"CursorOffset",c=this[h](s,this._selectionDirection==="right");s.shiftKey?this.moveCursorWithShift(c):this.moveCursorWithoutShift(c),c!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(g){var s=this._selectionDirection==="left"?this.selectionStart+g:this.selectionEnd+g;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,s),g!==0},moveCursorWithoutShift:function(g){return g<0?(this.selectionStart+=g,this.selectionEnd=this.selectionStart):(this.selectionEnd+=g,this.selectionStart=this.selectionEnd),g!==0},moveCursorLeft:function(g){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",g)},_move:function(g,s,h){var c;if(g.altKey)c=this["findWordBoundary"+h](this[s]);else if(g.metaKey||g.keyCode===35||g.keyCode===36)c=this["findLineBoundary"+h](this[s]);else return this[s]+=h==="Left"?-1:1,!0;if(typeof c<"u"&&this[s]!==c)return this[s]=c,!0},_moveLeft:function(g,s){return this._move(g,s,"Left")},_moveRight:function(g,s){return this._move(g,s,"Right")},moveCursorLeftWithoutShift:function(g){var s=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(s=this._moveLeft(g,"selectionStart")),this.selectionEnd=this.selectionStart,s},moveCursorLeftWithShift:function(g){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(g,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(g,"selectionStart")},moveCursorRight:function(g){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",g)},_moveCursorLeftOrRight:function(g,s){var h="moveCursor"+g+"With";this._currentCursorOpacity=1,s.shiftKey?h+="Shift":h+="outShift",this[h](s)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(g){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(g,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(g,"selectionEnd")},moveCursorRightWithoutShift:function(g){var s=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(s=this._moveRight(g,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,s},removeChars:function(g,s){typeof s>"u"&&(s=g+1),this.removeStyleFromTo(g,s),this._text.splice(g,s-g),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(g,s,h,c){typeof c>"u"&&(c=h),c>h&&this.removeStyleFromTo(h,c);var n=u.util.string.graphemeSplit(g);this.insertNewStyleBlock(n,h,s),this._text=[].concat(this._text.slice(0,h),n,this._text.slice(c)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var g=u.util.toFixed,s=/  +/g;u.util.object.extend(u.Text.prototype,{_toSVG:function(){var h=this._getSVGLeftTopOffsets(),c=this._getSVGTextAndBg(h.textTop,h.textLeft);return this._wrapSVGTextAndBg(c)},toSVG:function(h){return this._createBaseSVGMarkup(this._toSVG(),{reviver:h,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(h){var c=!0,n=this.getSvgTextDecoration(this);return[h.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",n?'text-decoration="'+n+'" ':"",'style="',this.getSvgStyles(c),'"',this.addPaintOrder()," >",h.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(h,c){var n=[],a=[],e=h,o;this._setSVGBg(a);for(var f=0,r=this._textLines.length;f<r;f++)o=this._getLineLeftOffset(f),(this.textBackgroundColor||this.styleHas("textBackgroundColor",f))&&this._setSVGTextLineBg(a,f,c+o,e),this._setSVGTextLineText(n,f,c+o,e),e+=this.getHeightOfLine(f);return{textSpans:n,textBgRects:a}},_createTextCharSpan:function(h,c,n,a){var e=h!==h.trim()||h.match(s),o=this.getSvgSpanStyles(c,e),f=o?'style="'+o+'"':"",r=c.deltaY,_="",p=u.Object.NUM_FRACTION_DIGITS;return r&&(_=' dy="'+g(r,p)+'" '),['<tspan x="',g(n,p),'" y="',g(a,p),'" ',_,f,">",u.util.string.escapeXml(h),"</tspan>"].join("")},_setSVGTextLineText:function(h,c,n,a){var e=this.getHeightOfLine(c),o=this.textAlign.indexOf("justify")!==-1,f,r,_="",p,S,C=0,x=this._textLines[c],P;a+=e*(1-this._fontSizeFraction)/this.lineHeight;for(var F=0,z=x.length-1;F<=z;F++)P=F===z||this.charSpacing,_+=x[F],p=this.__charBounds[c][F],C===0?(n+=p.kernedWidth-p.width,C+=p.width):C+=p.kernedWidth,o&&!P&&this._reSpaceAndTab.test(x[F])&&(P=!0),P||(f=f||this.getCompleteStyleDeclaration(c,F),r=this.getCompleteStyleDeclaration(c,F+1),P=u.util.hasStyleChanged(f,r,!0)),P&&(S=this._getStyleDeclaration(c,F)||{},h.push(this._createTextCharSpan(_,S,n,a)),_="",f=r,n+=C,C=0)},_pushTextBgRect:function(h,c,n,a,e,o){var f=u.Object.NUM_FRACTION_DIGITS;h.push("		<rect ",this._getFillAttributes(c),' x="',g(n,f),'" y="',g(a,f),'" width="',g(e,f),'" height="',g(o,f),`"></rect>
`)},_setSVGTextLineBg:function(h,c,n,a){for(var e=this._textLines[c],o=this.getHeightOfLine(c)/this.lineHeight,f=0,r=0,_,p,S=this.getValueOfPropertyAt(c,0,"textBackgroundColor"),C=0,x=e.length;C<x;C++)_=this.__charBounds[c][C],p=this.getValueOfPropertyAt(c,C,"textBackgroundColor"),p!==S?(S&&this._pushTextBgRect(h,S,n+r,a,f,o),r=_.left,f=_.width,S=p):f+=_.kernedWidth;p&&this._pushTextBgRect(h,p,n+r,a,f,o)},_getFillAttributes:function(h){var c=h&&typeof h=="string"?new u.Color(h):"";return!c||!c.getSource()||c.getAlpha()===1?'fill="'+h+'"':'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(h){for(var c=0,n=0,a=0;a<h;a++)c+=this.getHeightOfLine(a);return n=this.getHeightOfLine(a),{lineTop:c,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(h){var c=u.Object.prototype.getSvgStyles.call(this,h);return c+" white-space: pre;"}})}(),function(g){var s=g.fabric||(g.fabric={});s.Textbox=s.util.createClass(s.IText,s.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:s.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(h){for(var c=0,n=0,a=0,e={},o=0;o<h.graphemeLines.length;o++)h.graphemeText[a]===`
`&&o>0?(n=0,a++,c++):!this.splitByGrapheme&&this._reSpaceAndTab.test(h.graphemeText[a])&&o>0&&(n++,a++),e[o]={line:c,offset:n},a+=h.graphemeLines[o].length,n+=h.graphemeLines[o].length;return e},styleHas:function(h,c){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[c];n&&(c=n.line)}return s.Text.prototype.styleHas.call(this,h,c)},isEmptyStyles:function(h){if(!this.styles)return!0;var c=0,n=h+1,a,e,o=!1,f=this._styleMap[h],r=this._styleMap[h+1];f&&(h=f.line,c=f.offset),r&&(n=r.line,o=n===h,a=r.offset),e=typeof h>"u"?this.styles:{line:this.styles[h]};for(var _ in e)for(var p in e[_])if(p>=c&&(!o||p<a))for(var S in e[_][p])return!1;return!0},_getStyleDeclaration:function(h,c){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[h];if(!n)return null;h=n.line,c=n.offset+c}return this.callSuper("_getStyleDeclaration",h,c)},_setStyleDeclaration:function(h,c,n){var a=this._styleMap[h];h=a.line,c=a.offset+c,this.styles[h][c]=n},_deleteStyleDeclaration:function(h,c){var n=this._styleMap[h];h=n.line,c=n.offset+c,delete this.styles[h][c]},_getLineStyle:function(h){var c=this._styleMap[h];return!!this.styles[c.line]},_setLineStyle:function(h){var c=this._styleMap[h];this.styles[c.line]={}},_wrapText:function(h,c){var n=[],a;for(this.isWrapping=!0,a=0;a<h.length;a++)n=n.concat(this._wrapLine(h[a],a,c));return this.isWrapping=!1,n},_measureWord:function(h,c,n){var a=0,e,o=!0;n=n||0;for(var f=0,r=h.length;f<r;f++){var _=this._getGraphemeBox(h[f],c,f+n,e,o);a+=_.kernedWidth,e=h[f]}return a},_wrapLine:function(h,c,n,at){var e=0,o=this.splitByGrapheme,f=[],r=[],_=o?s.util.string.graphemeSplit(h):h.split(this._wordJoiners),p="",S=0,C=o?"":" ",x=0,P=0,F=0,z=!0,K=this._getWidthOfCharSpacing(),at=at||0;_.length===0&&_.push([]),n-=at;for(var _t=0;_t<_.length;_t++)p=o?_[_t]:s.util.string.graphemeSplit(_[_t]),x=this._measureWord(p,c,S),S+=p.length,e+=P+x-K,e>n&&!z?(f.push(r),r=[],e=x,z=!0):e+=K,!z&&!o&&r.push(C),r=r.concat(p),P=o?0:this._measureWord([C],c,S),S++,z=!1,x>F&&(F=x);return _t&&f.push(r),F+at>this.dynamicMinWidth&&(this.dynamicMinWidth=F-K+at),f},isEndOfWrapping:function(h){return!this._styleMap[h+1]||this._styleMap[h+1].line!==this._styleMap[h].line},missingNewlineOffset:function(h){return this.splitByGrapheme?this.isEndOfWrapping(h)?1:0:1},_splitTextIntoLines:function(h){for(var c=s.Text.prototype._splitTextIntoLines.call(this,h),n=this._wrapText(c.lines,this.width),a=new Array(n.length),e=0;e<n.length;e++)a[e]=n[e].join("");return c.lines=a,c.graphemeLines=n,c},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var h={};for(var c in this._styleMap)this._textLines[c]&&(h[this._styleMap[c].line]=1);for(var c in this.styles)h[c]||delete this.styles[c]},toObject:function(h){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(h))}}),s.Textbox.fromObject=function(h,c){var n=s.util.stylesFromArray(h.styles,h.text),a=Object.assign({},h,{styles:n});return s.Object._fromObject("Textbox",a,c,"text")}}(m),function(){var g=u.controlsUtils,s=g.scaleSkewCursorStyleHandler,h=g.scaleCursorStyleHandler,c=g.scalingEqually,n=g.scalingYOrSkewingX,a=g.scalingXOrSkewingY,e=g.scaleOrSkewActionName,o=u.Object.prototype.controls;if(o.ml=new u.Control({x:-.5,y:0,cursorStyleHandler:s,actionHandler:a,getActionName:e}),o.mr=new u.Control({x:.5,y:0,cursorStyleHandler:s,actionHandler:a,getActionName:e}),o.mb=new u.Control({x:0,y:.5,cursorStyleHandler:s,actionHandler:n,getActionName:e}),o.mt=new u.Control({x:0,y:-.5,cursorStyleHandler:s,actionHandler:n,getActionName:e}),o.tl=new u.Control({x:-.5,y:-.5,cursorStyleHandler:h,actionHandler:c}),o.tr=new u.Control({x:.5,y:-.5,cursorStyleHandler:h,actionHandler:c}),o.bl=new u.Control({x:-.5,y:.5,cursorStyleHandler:h,actionHandler:c}),o.br=new u.Control({x:.5,y:.5,cursorStyleHandler:h,actionHandler:c}),o.mtr=new u.Control({x:0,y:-.5,actionHandler:g.rotationWithSnapping,cursorStyleHandler:g.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),u.Textbox){var f=u.Textbox.prototype.controls={};f.mtr=o.mtr,f.tr=o.tr,f.br=o.br,f.tl=o.tl,f.bl=o.bl,f.mt=o.mt,f.mb=o.mb,f.mr=new u.Control({x:.5,y:0,actionHandler:g.changeWidth,cursorStyleHandler:s,actionName:"resizing"}),f.ml=new u.Control({x:-.5,y:0,actionHandler:g.changeWidth,cursorStyleHandler:s,actionName:"resizing"})}}()})(De);const ml=ui('<div class="py-5"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...'),dl=ui('<div class="alert alert-warning" role="alert">Tải ứng dụng thất bại, vui lòng thử lại sau!<br>Mã lỗi: '),pl=ui('<div><div class="editor d-flex justify-items-center w-full"><canvas id="canvas"></canvas></div><div class="form my-2 d-flex justify-content-between"><span><label class="btn btn-primary p-2" for="image">Chọn ảnh</label><input accept="image/*" class="d-none" id="image" type="file"></span><span><label class="btn btn-primary p-2" for="signature">Chọn chữ ký</label><input accept="image/*" class="d-none" id="signature" type="file"></span><button class="btn btn-primary p-2 loading">Tải ảnh');function vl(m){const u=new FileReader;return new Promise((v,k)=>{u.addEventListener("load",()=>{typeof u.result=="string"&&v(u.result)}),u.addEventListener("error",()=>{k(u.error)}),u.readAsDataURL(m)})}const yl=new URL("/assets/magick-a1f64442.wasm",self.location).href;function Sl(){const[m,u]=ar(!0),[v,k]=ar("");let I,t=new De.fabric.Canvas("canvas"),W=new De.fabric.Image("p"),g=new De.fabric.Image("p");cl(yl).then(()=>{console.log("vertion",Gn.imageMagickVersion),u(!1)}).catch(f=>{console.error(f),k(f)});const s=(f,r,_,p)=>Math.min(_/f,p/r),h=(f,r)=>{t&&t.dispose();const _=document.documentElement.clientWidth*.95,p=document.documentElement.clientHeight*.9,S=s(f,r,_,p);I&&(I.width=f*S,I.height=r*S),t=new De.fabric.Canvas("canvas",{selection:!1}),t.setWidth(f*S),t.setHeight(r*S)},c=async f=>{var F;const r=f.target,_=(F=r==null?void 0:r.files)==null?void 0:F[0];if(!_)return;u(!0);const p=await _.arrayBuffer(),S=new Uint8Array(p),C=te.create(S,new oe);h(C.width,C.height);const x=document.createElement("canvas");C.writeToCanvas(x);const P=new De.fabric.Image(x);if(h(C.width,C.height),C.width&&C.height&&t.width&&t.height){const z=s(C.width,C.height,t.width,t.height);P.set("top",0),P.set("left",0),P.set("scaleX",z),P.set("scaleY",z),P.set("selectable",!1),P.set("moveCursor","none"),P.set("hoverCursor","auto"),g&&t.remove(g),g=P,t.add(P).sendToBack(P).requestRenderAll()}u(!1)},n=f=>{var p;const r=f.target,_=(p=r==null?void 0:r.files)==null?void 0:p[0];_&&vl(_).then(S=>{De.fabric.Image.fromURL(S,C=>{const x=s(C.width,C.height,t.width,t.height)*.45;C.set("top",0),C.set("left",0),C.set("scaleX",x),C.set("scaleY",x),W&&t.remove(W),W=C,t.add(C).bringToFront(C).requestRenderAll()})})},a=(f,r)=>{const _=document.createElement("a");_.download=r,_.href=f,document.body.appendChild(_),_.click(),document.body.removeChild(_)},e=()=>{t.discardActiveObject(),t.requestRenderAll();const f=t.toDataURL({format:"jpeg",quality:1,multiplier:g.width/t.width});a(f,"chuky.jpeg")},o=Pn(()=>!v()&&!m());return[ai(sr,{get when(){return Pn(()=>!v())()&&m()},get children(){return ml()}}),ai(sr,{get when(){return v()},get children(){const f=dl();return f.firstChild.nextSibling.nextSibling,vr(f,v,null),f}}),(()=>{const f=pl(),r=f.firstChild,_=r.firstChild,p=r.nextSibling,S=p.firstChild,C=S.firstChild,x=C.nextSibling,P=S.nextSibling,F=P.firstChild,z=F.nextSibling,K=P.nextSibling,at=I;return typeof at=="function"?Ko(at,_):I=_,_.style.setProperty("width","100%"),x.addEventListener("change",_t=>c(_t)),z.addEventListener("change",_t=>n(_t)),K.$$click=e,In(()=>(o()?"block":"none")!=null?f.style.setProperty("display",o()?"block":"none"):f.style.removeProperty("display")),f})()]}qo(["click"]);const Cl=document.getElementById("root");$o(()=>ai(Sl,{}),Cl);
